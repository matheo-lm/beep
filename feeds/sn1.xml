<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>SentinelLabs - We are hunters, reversers, exploit developers, and tinkerers shedding light on the world of malware, exploits, APTs, and cybercrime across all platforms.</title>
	<atom:link href="https://www.sentinelone.com/labs/feed/" rel="self" type="application/rss+xml" />
	<link>https://www.sentinelone.com/labs/</link>
	<description>Next Generation Endpoint Security</description>
	<lastBuildDate>Tue, 10 Dec 2024 14:50:39 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	
	<item>
		<title>Operation Digital Eye &#124; Chinese APT Compromises Critical Digital Infrastructure via Visual Studio Code Tunnels</title>
		<link>https://www.sentinelone.com/labs/operation-digital-eye-chinese-apt-compromises-critical-digital-infrastructure-via-visual-studio-code-tunnels/</link>
		
		<dc:creator><![CDATA[Aleksandar Milenkoski &amp; Luigi Martire (Tinexta Cyber)]]></dc:creator>
		<pubDate>Tue, 10 Dec 2024 10:55:33 +0000</pubDate>
				<category><![CDATA[China]]></category>
		<guid isPermaLink="false">https://www.sentinelone.com/?post_type=labs&#038;p=109526</guid>

					<description><![CDATA[Threat actors abused Visual Studio Code and Microsoft Azure infrastructure to target large business-to-business IT service providers in Southern Europe.]]></description>
										<content:encoded><![CDATA[<h2>Executive Summary</h2>
<ul>
<li aria-level="1">From late June to mid-July 2024, a suspected China-nexus threat actor targeted large business-to-business IT service providers in Southern Europe, an activity cluster that we dubbed ‘Operation Digital Eye’.</li>
<li aria-level="1">The intrusions could have enabled the adversaries to establish strategic footholds and compromise downstream entities. SentinelLabs and Tinexta Cyber detected and interrupted the activities in their initial phases.</li>
<li aria-level="1">The threat actors used a lateral movement capability indicative of the presence of a shared vendor or digital quartermaster maintaining and provisioning tooling within the Chinese APT ecosystem.</li>
<li aria-level="1">The threat actors abused Visual Studio Code and Microsoft Azure infrastructure for C2 purposes, attempting to evade detection by making malicious activities appear legitimate.</li>
<li aria-level="1">Our visibility suggests that the abuse of Visual Studio Code for C2 purposes had been relatively rare in the wild prior to this campaign. Operation Digital Eye marks the first instance of a suspected Chinese APT group using this technique that we have directly observed.</li>
</ul>
<h2>Overview</h2>
<p>Tinexta Cyber and SentinelLabs have been tracking threat activities targeting business-to-business IT service providers in Southern Europe. Based on the malware, infrastructure, techniques used, victimology, and the timing of the activities, we assess that it is highly likely these attacks were conducted by a China-nexus threat actor with cyberespionage motivations.</p>
<p>The relationships between European countries and China are complex, characterized by cooperation, competition, and underlying tensions in areas such as trade, investment, and technology. Suspected China-linked cyberespionage groups <a href="https://cert.europa.eu/static/files/TLP-CLEAR-JointPublication-23-01.pdf" target="_blank" rel="noopener noreferrer">frequently</a> <a href="https://cert.europa.eu/publications/threat-intelligence/cb24-08/" target="_blank" rel="noopener noreferrer">target</a> public and private organizations across Europe to gather strategic intelligence, gain competitive advantages, and advance geopolitical, economic, and technological interests.</p>
<p>The attack campaign, which we have dubbed Operation Digital Eye, took place from late June to mid-July 2024, lasting approximately three weeks. The targeted organizations provide solutions for managing data, infrastructure, and cybersecurity for clients across various industries, making them prime targets for cyberespionage actors.</p>
<p>A sustained presence within these organizations would provide the Operation Digital Eye actors with a strategic foothold, creating opportunities for intrusions across the digital supply chain and enabling them to exert control over critical IT processes within the downstream compromised entities. The attacks were detected and disrupted during their initial phases.</p>
<p>The exact group behind Operation Digital Eye remains unclear due to the extensive <a href="https://www.sentinelone.com/labs/chinese-entanglement-dll-hijacking-in-the-asian-gambling-sector/" target="_blank" rel="noopener noreferrer">sharing</a> of malware, operational playbooks, and infrastructure management processes within the Chinese threat landscape. The threat actors used a pass-the-hash capability, likely originating from the same source as closed-source custom Mimikatz modifications observed exclusively in suspected Chinese cyberespionage activities, such as <a href="https://www.cybereason.com/blog/research/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers" target="_blank" rel="noopener noreferrer">Operation Soft Cell</a> and <a href="https://www.sentinelone.com/labs/operation-tainted-love-chinese-apts-target-telcos-in-new-attacks/" target="_blank" rel="noopener noreferrer">Operation Tainted Love</a>. The malware and tooling used in these campaigns have been <a href="https://github.com/yt0ng/cracking_softcell/blob/main/Cracking_SOFTCLL_TLP_WHITE.pdf" target="_blank" rel="noopener noreferrer">linked </a>to several distinct Chinese APT groups. We collectively refer to these custom Mimikatz modifications as mimCN.</p>
<p>The long-term evolution and versioning of mimCN samples, along with notable features such as instructions left for a separate team of operators, suggest the involvement of a shared vendor or digital quartermaster responsible for the active maintenance and provisioning of tooling. This function within the Chinese APT ecosystem, corroborated by the <a href="https://www.sentinelone.com/labs/unmasking-i-soon-the-leak-that-revealed-chinas-cyber-operations/" target="_blank" rel="noopener noreferrer">I-Soon leak</a>, likely plays a key role in facilitating China-nexus cyberespionage operations.</p>
<p>The abuse of <a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">Visual Studio Code</a> <a href="https://code.visualstudio.com/docs/remote/tunnels" target="_blank" rel="noopener noreferrer">Remote Tunnels</a> for C2 purposes is central to this campaign. Originally designed to enable remote development, this technology provides full endpoint access, including command execution and filesystem manipulation. Additionally, Visual Studio Code tunneling involves executables signed by Microsoft and Microsoft Azure network infrastructure, both of which are often not closely monitored and are typically allowed by application controls and firewall rules. As a result, this technique may be challenging to detect and could evade security defenses. Combined with the full endpoint access it provides, this makes Visual Studio Code tunneling an attractive and powerful capability for threat actors to exploit.</p>
<p>Tinexta Cyber and SentinelLabs have notified Microsoft about the abuse of Visual Studio Code and Azure infrastructure in connection with Operation Digital Eye.</p>
<h2>Infection Vector and Attack Progression</h2>
<p>The attackers used SQL (Structured Query Language) injection as an initial access vector to infiltrate Internet-facing web and database servers. <code>User-Agent</code> request headers in the web traffic logs we retrieved indicate that the attackers used the <a href="https://sqlmap.org/" target="_blank" rel="noopener noreferrer">sqlmap</a> tool to automate the detection and exploitation of SQL injection vulnerabilities.</p>
<p>To establish an initial foothold and maintain persistent access, the threat actors deployed a PHP-based webshell. Relatively simple in design and implementation, the webshell uses the <a href="https://www.php.net/manual/en/function.assert.php" target="_blank" rel="noopener noreferrer">assert</a> function to execute attacker-provided PHP code. Its implementation does not resemble any other webshells we are familiar with. We track this webshell under the name PHPsert.</p>
<p>To disguise the files implementing PHPsert and attempt to evade detection based on filesystem activity, the attackers used custom names tailored to the infiltrated environments, making the filenames appear legitimate. This included using the local language and terms that aligned with the technological context of the targeted organizations.</p>
<p>After establishing an initial foothold, the threat actors conducted reconnaissance using a variety of third-party tools and built-in Windows utilities, such as <a href="https://joeware.net/freetools/tools/getuserinfo/index.htm" target="_blank" rel="noopener noreferrer">GetUserInfo</a> and <code>ping</code>. They also deployed the <code>local.exe</code> tool, which is part of the Microsoft Windows NT Resource Kit and allows for viewing user group memberships.</p>
<p>To steal credentials, the attackers used the <code>CreateDump</code> tool to <a href="https://lolbas-project.github.io/lolbas/OtherMSBinaries/Createdump/" target="_blank" rel="noopener noreferrer">extract</a> memory allocated to the Local Security Authority Subsystem Service (LSASS) process and exfiltrate credentials. <code>CreateDump</code> is part of the Microsoft .NET Framework distribution. The threat actors also retrieved credentials from the Security Account Manager (SAM) database, which they extracted from the Windows Registry using the <code>reg save</code> <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/reg-save" target="_blank" rel="noopener noreferrer">command</a>.</p>
<p>The threat actors frequently named the files they deployed using the pattern <code>do.*</code>. Examples include <code>do.log</code> (output from <code>ping</code> commands), <code>do.exe</code> (the <code>CreateDump</code> tool), and <code>do.bat</code> (a script that executes and deletes the <code>CreateDump</code> executable).</p>
<p>From the initially compromised endpoints, the attackers moved laterally across the internal network, primarily using RDP (Remote Desktop Protocol) connections and pass-the-hash techniques. For the pass-the-hash attacks, they used a custom modified version of Mimikatz, implemented in an executable named <code>bK2o.exe</code>.</p>
<p>In addition to the PHPsert webshell, the threat actors used two methods for remote command execution: SSH access, enabled by deploying <code>authorized_keys</code> files containing public keys for authentication, and Visual Studio Code Remote Tunnels.</p>
<p>Visual Studio Code Remote Tunnels, based on Microsoft’s <a href="https://learn.microsoft.com/en-us/azure/developer/dev-tunnels/overview" target="_blank" rel="noopener noreferrer">dev tunnel</a> technology, enable developers to access and work on remote systems. This access includes the command terminal and file system, allowing activities such as command execution and file editing. The Operation Digital Eye actors abused this functionality to maintain persistent backdoor access to compromised systems.</p>
<p>In an attempt to evade detection based on filesystem activity, the threat actors used <code>%SystemRoot%\Temp</code> and <code>%ProgramData%\Visual Studio Code</code> as their primary working directories for storing tools and data. <code>%SystemRoot%\Temp</code> is a directory where Windows stores temporary files and is often monitored with less scrutiny. <code>%ProgramData%\Visual Studio Code</code> was intended to appear as a legitimate directory associated with Visual Studio Code.</p>
<p>The intrusions were detected and interrupted before the attackers could proceed to further phases, such as exfiltrating data.</p>
<h2>Abuse of Visual Studio Code</h2>
<p>The threat actors deployed a portable Visual Studio Code executable named <code>code.exe</code>, which is digitally signed by Microsoft, and used the <a href="https://github.com/winsw/winsw" target="_blank" rel="noopener noreferrer">winsw</a> tool to run it as a Windows service. The <code>winsw</code> configuration file we retrieved indicates that the attackers created a service named <code>Visual Studio Code Service</code>, which executes <code>code.exe</code> with the <code>tunnel</code> command-line parameter at every system startup.</p>
<p>The configuration file reveals a pragmatic approach by the threat actors, who likely modified a <a href="https://github.com/winsw/winsw/blob/v3/samples/complete.xml" target="_blank" rel="noopener noreferrer">publicly available</a> <code>winsw</code> configuration. This is suggested by the use of the <code>myapp</code> service identifier and the <code>%BASE%\logs</code> directory for storing <code>winsw</code> log files, both of which appear in the public configuration file as well as in the one we retrieved.</p>
<figure id="attachment_109546" aria-describedby="caption-attachment-109546" style="width: 852px" class="wp-caption aligncenter"><img fetchpriority="high" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye13.jpg" alt="winsw configuration file" width="852" height="396" class="size-full wp-image-109546" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye13.jpg 852w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye13-300x139.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye13-768x357.jpg 768w" sizes="(max-width: 852px) 100vw, 852px" /><figcaption id="caption-attachment-109546" class="wp-caption-text">winsw configuration file</figcaption></figure>
<p>The <code>tunnel</code> parameter instructs Visual Studio Code to create a dev tunnel and act as a server to which remote users can connect. After <a href="https://learn.microsoft.com/en-us/azure/developer/dev-tunnels/security" target="_blank" rel="noopener noreferrer">authenticating</a> to the tunnel with a Microsoft or GitHub account, remote users can access the endpoint running the Visual Studio Code server, either through the Visual Studio Code desktop application or the browser-based version, <a href="https://vscode.dev/" target="_blank" rel="noopener noreferrer">vscode.dev</a>.</p>
<p>After creating the dev tunnels, the threat actors authenticated using GitHub accounts and accessed the compromised endpoints through the browser-based version of Visual Studio Code. We have no knowledge of whether the threat actors used self-registered or compromised GitHub accounts to authenticate to the tunnels.</p>
<h2>Network Infrastructure</h2>
<p>The Operation Digital Eye actors used infrastructure located exclusively within Europe, sourced from the provider M247 and the Cloud platform Microsoft Azure. This was likely part of a deliberate strategy. Since the targeted organizations are based and operate within Europe, the attackers may have aimed to minimize suspicion by aligning their infrastructure&#8217;s location with that of their targets. Additionally, Cloud infrastructure commonly used in legitimate IT workflows, such as Microsoft Azure, is often not closely monitored and is frequently allowed through firewall restrictions. By leveraging public Cloud infrastructure for malicious purposes, the attackers made the traffic appear legitimate, which can be challenging to detect and may evade security defenses.</p>
<p>In the initial phases of the attacks, the threat actors used the server with IP address <code>146.70.161[.]78</code> to establish initial access by detecting and exploiting SQL injection vulnerabilities, and the server with IP address <code>185.76.78[.]117</code> to operate the PHPsert webshell. Both IP addresses are allocated to the infrastructure provider M247 and are located in Poland and Italy, respectively.</p>
<p>In the later phases of the attacks, the threat actors used the server with IP address <code>4.232.170[.]137</code> for C2 purposes when remotely accessing compromised endpoints via the SSH protocol. This server is part of Microsoft&#8217;s Azure infrastructure in the <code>Italy North</code> <a href="https://learn.microsoft.com/en-us/azure/virtual-machines/regions" target="_blank" rel="noopener noreferrer">datacenter region</a> (<a href="https://www.microsoft.com/en-us/download/details.aspx?id=56519" target="_blank" rel="noopener noreferrer">Azure IP range</a>: <code>4.232.128[.]0/18</code>, <a href="https://learn.microsoft.com/en-us/azure/virtual-network/service-tags-overview" target="_blank" rel="noopener noreferrer">service tag</a>: <code>AzureCloud.italynorth</code>). We currently have no information on whether the threat actors used self-registered or compromised Azure credentials to access and manage the Azure resources and services.</p>
<p>The abuse of Visual Studio Code tunneling for C2 purposes also relies on Microsoft Azure infrastructure. Creating and hosting a dev tunnel requires connecting to a Microsoft Azure server with a domain of <code>*.[clusterID].devtunnels.ms</code>, where <code>[clusterID]</code> corresponds to the Azure region of the endpoint running the Visual Studio Code server, <a href="https://global.rel.tunnels.api.visualstudio.com/api/v1/clusters" target="_blank" rel="noopener noreferrer">such as</a> <code>euw</code> for <code>West Europe</code>. In Operation Digital Eye, the creation of dev tunnels involved establishing connections to the server with the domain <code>[REDACTED].euw.devtunnels[.]ms</code>, which resolved to the IP address <code>20.103.221[.]187</code>. This server is part of Microsoft&#8217;s Azure infrastructure in the <code>West Europe</code> datacenter region (Azure IP range: <code>20.103.0[.]0/16</code>, service tag: <code>AzureCloud.westeurope</code>).</p>
<h2>The PHPsert Webshell</h2>
<p>PHPsert executes attacker-provided PHP code using the <a href="https://www.php.net/manual/en/function.assert.php" target="_blank" rel="noopener noreferrer">assert</a> function, which, in PHP versions prior to 8.0.0, interprets and runs parameter strings as PHP code. To hinder static analysis and evade detection, the webshell uses various code obfuscation techniques, including XOR encoding, hexadecimal character representation, string concatenation, and randomized variable names.</p>
<figure id="attachment_109540" aria-describedby="caption-attachment-109540" style="width: 664px" class="wp-caption aligncenter"><img decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye3.jpg" alt="PHPsert implementation" width="664" height="434" class="size-full wp-image-109540" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye3.jpg 664w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye3-300x196.jpg 300w" sizes="(max-width: 664px) 100vw, 664px" /><figcaption id="caption-attachment-109540" class="wp-caption-text">PHPsert implementation</figcaption></figure>
<p>The PHPsert webshell operates as follows:</p>
<ul>
<li aria-level="1">PHPsert instantiates a class with a single regular method, which XOR-decodes and concatenates hexadecimal characters to generate the string <code>assert</code>. The class&#8217;s destructor (the magic method <code>__destruct</code>) uses this string to invoke the <code>assert</code> function, passing attacker-provided PHP code as a parameter.</li>
<li aria-level="1">The webshell retrieves the attacker-provided PHP code from an HTTP POST request parameter, for example, <code>momomomo</code>. If the <code>id</code> parameter is present in the request URL, PHPsert decodes the Base64-encoded value of the POST parameter. If the <code>id</code> parameter is absent, the webshell uses the raw value of the parameter.</li>
<li aria-level="1">Finally, when PHPsert finishes executing, the class&#8217;s destructor is invoked, which in turn calls the <code>assert</code> function to execute the attacker-provided PHP code.</li>
</ul>
<p>We identified multiple PHPsert variants, which have been submitted to malware sharing platforms since May 2023, from various locations including Japan, Singapore, Peru, Taiwan, Iran, Korea, and the Philippines. These variants show only minor differences in their implementation, such as varying variable names and POST request parameters like <code>mr6</code>, <code>brute</code>, and <code>qq</code>. Our analysis suggests that PHPsert is deployed not only as a standalone PHP file but is also integrated into various types of web content, including web text editors and content management systems.</p>
<p>One of the PHPsert variants contains commented-out code snippets and comments in simplified Chinese that describe nearby code. These comments and snippets are not present in the PHPsert versions observed in Operation Digital Eye, nor in any of the webshell’s other variants. Below are the code comments, all of which are machine-translated from simplified Chinese:</p>
<ul>
<li aria-level="1"><code>结果是"assert"</code>, which translates to <code>The result is "assert"</code>.</li>
<li aria-level="1"><code>验证 $this->rg 是否安全</code>, which translates to <code>Verify that $this->rg is safe</code>.</li>
<li aria-level="1"><code>验证和清理用户输入</code>, which translates to <code>Validating and sanitizing user input</code>.</li>
</ul>
<p><img decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye14.jpg" alt="" width="382" height="196" class="aligncenter size-full wp-image-109545" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye14.jpg 382w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye14-300x154.jpg 300w" sizes="(max-width: 382px) 100vw, 382px" /><br />
<img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye2.jpg" alt="" width="580" height="119" class="aligncenter size-full wp-image-109541" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye2.jpg 580w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye2-300x62.jpg 300w" sizes="(max-width: 580px) 100vw, 580px" /><br />
<figure id="attachment_109548" aria-describedby="caption-attachment-109548" style="width: 671px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye11.jpg" alt="PHPsert code snippets with comments in Chinese" width="671" height="45" class="size-full wp-image-109548" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye11.jpg 671w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye11-300x20.jpg 300w" sizes="(max-width: 671px) 100vw, 671px" /><figcaption id="caption-attachment-109548" class="wp-caption-text">PHPsert code snippets with comments in Chinese</figcaption></figure></p>
<p>The presence of these comments, along with the indicators of removed code across PHPsert variants, suggests the potential involvement of Chinese-speaking developers who may have been simplifying the webshell&#8217;s execution logic.</p>
<h2>Pass-the-Hash Capability</h2>
<p>The <code>bK2o.exe</code> executable (a custom modified version of Mimikatz used in Operation Digital Eye for pass-the-hash attacks) enables the execution of processes within a user&#8217;s security context by leveraging a compromised NTLM password hash, bypassing the need for the user’s actual password. To achieve this, <code>bK2o.exe</code> overwrites memory of the LSASS process. The tool supports the following command-line parameters:</p>
<ul>
<li aria-level="1"><code>/c</code>: The process to execute; defaults to <code>cmd.exe</code> if not provided.</li>
<li aria-level="1"><code>/u</code>: The user’s username.</li>
<li aria-level="1"><code>/d</code>: The user’s domain.</li>
<li aria-level="1"><code>/h</code>: The NTLM password hash.</li>
</ul>
<p><code>bK2o.exe</code> implements a pass-the-hash technique by overwriting LSASS memory in a manner similar to Mimikatz, with its implementation partially overlapping with Mimikatz functions such as <code>kuhl_m_sekurlsa_pth_luid</code> and <code>kuhl_m_sekurlsa_msv_enum_cred_callback_pth</code>. In summary, <code>bK2o.exe</code> performs the following:</p>
<ul>
<li aria-level="1"><a href="https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createprocesswithlogonw" target="_blank" rel="noopener noreferrer">Creates</a> a suspended process in a new logon session, specifying the attacker-provided process, username, domain, and an empty password.</li>
<li aria-level="1">Based on the session’s locally unique identifier (LUID), locates and extracts from the LSASS process memory an encrypted credential data blob containing the user’s NTLM hash and the encryption keys required to decrypt the blob.</li>
<li aria-level="1">Decrypts the data blob, overwrites the user’s NTLM hash with the attacker-provided hash, and re-encrypts the data blob.</li>
<li aria-level="1">Resumes the suspended process.</li>
</ul>
<figure id="attachment_109535" aria-describedby="caption-attachment-109535" style="width: 749px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye8.jpg" alt="bK2o.exe creates a new process and retrieves the logon session’s LUID" width="749" height="527" class="size-full wp-image-109535" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye8.jpg 749w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye8-300x211.jpg 300w" sizes="(max-width: 749px) 100vw, 749px" /><figcaption id="caption-attachment-109535" class="wp-caption-text">bK2o.exe creates a new process and retrieves the logon session’s LUID</figcaption></figure>
<p>To navigate LSASS memory, <code>bK2o.exe</code> uses code signatures, represented as byte sequences in hexadecimal format. These sequences correspond to known LSASS instructions, which serve as navigation points within the memory.</p>
<p>To hinder static analysis and evade detection, <code>bK2o.exe</code> obfuscates code signatures and strings by constructing them dynamically on the stack at runtime, instead of storing them as static data.</p>
<figure id="attachment_109542" aria-describedby="caption-attachment-109542" style="width: 382px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye17.jpg" alt="bK2o.exe constructs the string lsasrv.dll on the stack" width="382" height="181" class="size-full wp-image-109542" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye17.jpg 382w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye17-300x142.jpg 300w" sizes="(max-width: 382px) 100vw, 382px" /><figcaption id="caption-attachment-109542" class="wp-caption-text">bK2o.exe constructs the string lsasrv.dll on the stack</figcaption></figure>
<figure id="attachment_109538" aria-describedby="caption-attachment-109538" style="width: 314px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye5.jpg" alt="bK2o.exe constructs the code signature 33 ff 41 89 37 4c 8b f3 [...] on the stack" width="314" height="121" class="size-full wp-image-109538" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye5.jpg 314w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye5-300x116.jpg 300w" sizes="(max-width: 314px) 100vw, 314px" /><figcaption id="caption-attachment-109538" class="wp-caption-text">bK2o.exe constructs the code signature 33 ff 41 89 37 4c 8b f3 [&#8230;] on the stack</figcaption></figure>
<h2>From Operation Digital Eye to Tainted Love and Soft Cell</h2>
<p>We identified two additional samples uploaded to malware sharing platforms that construct code signatures on the stack, which we refer to as <code><code>wsx1.exe</code></code> and <code>wsx1.exe</code>. Like <code>bK2o.exe</code>, both <code>wsx.exe</code> and <code>wsx1.exe</code> are custom modified versions of Mimikatz and implement pass-the-hash functionality.</p>
<p>Substantial code segments in <code>wsx.exe</code> and <code>wsx1.exe</code>, which implement the construction of code signatures on the stack, overlap with those in <code>bK2o.exe</code>, including identical <code>mov</code> instruction operand sizes and values. This suggests that <code>wsx.exe</code>, <code>wsx1.exe</code>, and <code>bK2o.exe</code> are highly likely derived from the same source.</p>
<p><figure id="attachment_109549" aria-describedby="caption-attachment-109549" style="width: 442px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye10.jpg" alt="Code segment in bK2o.exe" width="442" height="542" class="size-full wp-image-109549" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye10.jpg 442w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye10-245x300.jpg 245w" sizes="(max-width: 442px) 100vw, 442px" /><figcaption id="caption-attachment-109549" class="wp-caption-text">Code segment in bK2o.exe</figcaption></figure><br />
<figure id="attachment_109550" aria-describedby="caption-attachment-109550" style="width: 473px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye1.jpg" alt="Code segment in wsx1.exe" width="473" height="562" class="size-full wp-image-109550" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye1.jpg 473w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye1-252x300.jpg 252w" sizes="(max-width: 473px) 100vw, 473px" /><figcaption id="caption-attachment-109550" class="wp-caption-text">Code segment in wsx1.exe</figcaption></figure></p>
<p>In turn, we observed overlaps between <code>wsx.exe</code>, <code>wsx1.exe</code>, and mim221 components. mim221 is a versioned and well-maintained credential theft tool, also a custom modified version of Mimikatz, which SentinelLabs observed in <a href="https://www.sentinelone.com/labs/operation-tainted-love-chinese-apts-target-telcos-in-new-attacks/" target="_blank" rel="noopener noreferrer">Operation Tainted Love</a> — a campaign targeting telecommunication providers in the Middle East in 2023.</p>
<p>We attributed Operation Tainted Love to a suspected Chinese cyberespionage group within the nexus of Granite Typhoon (formerly known as Gallium) and APT41, while acknowledging the possibility of tool sharing among Chinese state-sponsored threat actors and the potential involvement of a shared vendor or digital quartermaster. We assess that mim221 represents an evolution of tooling <a href="https://www.cybereason.com/blog/research/deadringer-exposing-chinese-threat-actors-targeting-major-telcos" target="_blank" rel="noopener noreferrer">associated</a> with <a href="https://www.cybereason.com/blog/research/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers" target="_blank" rel="noopener noreferrer">Operation Soft Cell</a>, such as <a href="https://www.virustotal.com/gui/file/65ea5f7750f44d98f1077397b906b2611781579a2ae6def44a4de5b41265a9b9/details" target="_blank" rel="noopener noreferrer">simplify_32.exe</a>. Operation Soft Cell, which targeted telecommunication providers in 2017 and 2018, has been <a href="https://www.bleepingcomputer.com/news/security/microsoft-warns-of-gallium-threat-group-attacking-global-telcos/" target="_blank" rel="noopener noreferrer">linked</a> to Granite Typhoon, and possible <a href="https://github.com/yt0ng/cracking_softcell/blob/main/Cracking_SOFTCLL_TLP_WHITE.pdf" target="_blank" rel="noopener noreferrer">connections</a> between the Soft Cell actors and APT41 have also been suggested.</p>
<p>mim221 has a multi-component architecture, with a single executable staging three components — <code>pc.dll</code>, <code>AddSecurityPackage64.dll</code>, and <code>getHashFlsa64.dll</code> — using techniques such as decryption, injection, and reflective image loading. These components share several overlaps with <code>bK2o.exe</code>, <code>wsx.exe</code>, and <code>wsx1.exe</code>.</p>
<p>To hinder static analysis, some mim221 components also obfuscate strings by constructing them on the stack at runtime. Additionally, the mim221 components <code>AddSecurityPackage64.dll</code> and <code>getHashFlsa64.dll</code> implement error logging similar to that of <code>wsx.exe</code> and <code>wsx1.exe</code>, including identical custom error messages, a consistent output format, and the same English-language errors.</p>
<p><figure id="attachment_109534" aria-describedby="caption-attachment-109534" style="width: 311px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye9.jpg" alt="Error messages in mim221" width="311" height="110" class="size-full wp-image-109534" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye9.jpg 311w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye9-300x106.jpg 300w" sizes="(max-width: 311px) 100vw, 311px" /><figcaption id="caption-attachment-109534" class="wp-caption-text">Error messages in mim221</figcaption></figure><br />
<figure id="attachment_109544" aria-describedby="caption-attachment-109544" style="width: 331px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye15.jpg" alt="Error messages in wsx.exe and wsx1.exe" width="331" height="109" class="size-full wp-image-109544" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye15.jpg 331w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye15-300x99.jpg 300w" sizes="(max-width: 331px) 100vw, 331px" /><figcaption id="caption-attachment-109544" class="wp-caption-text">Error messages in wsx.exe and wsx1.exe</figcaption></figure></p>
<p>In addition, RTTI (Run-Time Type Information) information stored in <code>wsx.exe</code>, <code>wsx1.exe</code>, and the mim221 component <code>getHashFlsa64.dll</code> reveals that classes with the same names are declared across these executables. We have not observed these class names in open-source or publicly available tooling.</p>
<figure id="attachment_109537" aria-describedby="caption-attachment-109537" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye6.jpg" alt="Class names (those present in more than one executable are highlighted in bold)" width="1999" height="1621" class="size-full wp-image-109537" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye6.jpg 1999w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye6-300x243.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye6-1024x830.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye6-768x623.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye6-1536x1246.jpg 1536w" sizes="(max-width: 1999px) 100vw, 1999px" /><figcaption id="caption-attachment-109537" class="wp-caption-text">Class names (those present in more than one executable are highlighted in bold)</figcaption></figure>
<h2>mimCN | A Collection of China-Nexus APT Tools</h2>
<p>Due to the previously discussed overlaps between <code>bK2o.exe</code> (used in Operation Digital Eye), <code>wsx.exe</code>, <code>wsx1.exe</code>, mim221 components (used in Operation Tainted Love), and <code>simplify_32.exe</code> (used in Operation Soft Cell), we collectively refer to this collection of tools as mimCN.</p>
<figure id="attachment_109543" aria-describedby="caption-attachment-109543" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye16.jpg" alt="The mimCN samples bK2o.exe, wsx.exe, wsx1.exe, and mim221" width="1999" height="895" class="size-full wp-image-109543" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye16.jpg 1999w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye16-300x134.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye16-1024x458.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye16-768x344.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye16-1536x688.jpg 1536w" sizes="(max-width: 1999px) 100vw, 1999px" /><figcaption id="caption-attachment-109543" class="wp-caption-text">The mimCN samples bK2o.exe, wsx.exe, wsx1.exe, and mim221</figcaption></figure>
<p>We include in the mimCN tool collection not only the previously mentioned tools but also any other custom modifications of Mimikatz that have overlaps with other mimCN executables, suggesting they may originate from the same source. Such overlaps include shared code-signing certificates and the use of unique custom error messages or obfuscation techniques.</p>
<p>To date, we have observed mimCN tools exclusively in the context of suspected Chinese APT activities. Although the compilation timestamps of the mimCN samples observed in these intrusions could have been manipulated, the proximity of the timestamps to when the activities occurred suggests that they are likely authentic.</p>
<div style="font-size:0.8em">
<div style="overflow-x:auto;">
<table style="border-collapse: collapse; width: 100%; height: 120px;">
<tbody>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;"><strong>Operation</strong></td>
<td style="width: 40.0%; height: 24px;"><strong>mimCN sample</strong></td>
<td style="width: 40.0%; height: 24px;"><strong>Compilation timestamp (UTC)</strong></td>
</tr>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">Digital Eye</td>
<td style="width: 40.0%; height: 24px;">bK2o.exe</td>
<td style="width: 40.0%; height: 24px;">Thu May 30 08:47:56 2024</td>
</tr>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">Tainted Love</td>
<td style="width: 40.0%; height: 24px;">mim221 (pc.exe)</td>
<td style="width: 40.0%; height: 24px;">Thu Jun 09 08:02:12 2022</td>
</tr>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">Tainted Love</td>
<td style="width: 40.0%; height: 24px;">mim221 (AddSecurityPackage64.dll)</td>
<td style="width: 40.0%; height: 24px;">Thu Jun 09 08:01:46 2022</td>
</tr>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">Tainted Love</td>
<td style="width: 40.0%; height: 24px;">mim221 (pc.dll)</td>
<td style="width: 40.0%; height: 24px;">Tue Jun 07 16:55:05 2022</td>
</tr>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">Tainted Love</td>
<td style="width: 40.0%; height: 24px;">mim221 (getHashFlsa64.dll)</td>
<td style="width: 40.0%; height: 24px;">Fri May 27 20:56:26 2022</td>
</tr>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">Soft Cell</td>
<td style="width: 40.0%; height: 24px;">simplify_32.exe</td>
<td style="width: 40.0%; height: 24px;">Tue Nov 20 03:54:21 2018</td>
</tr>
</tbody>
</table>
</div>
</div>
<figure id="attachment_109547" aria-describedby="caption-attachment-109547" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye12.jpg" alt="Use of mimCN samples" width="1999" height="668" class="size-full wp-image-109547" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye12.jpg 1999w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye12-300x100.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye12-1024x342.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye12-768x257.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye12-1536x513.jpg 1536w" sizes="(max-width: 1999px) 100vw, 1999px" /><figcaption id="caption-attachment-109547" class="wp-caption-text">Use of mimCN samples</figcaption></figure>
<p>Further, unique usage instructions found in some mimCN samples, such as <code>[ERROR]Please input command. eg, /cmd:xxx</code>  and <code>[ERROR]Please input ip. eg, /ip:xx.XXX.xx.x or /ip:xxx.com</code>, suggest the involvement of a dedicated development team that is leaving instructions for a separate group of operators. Combined with the presence of overlapping mimCN samples across various intrusions attributed to China-nexus APT groups and distributed over years, this suggests that mimCN is likely the product of an entity responsible for maintaining and provisioning tools to multiple clusters within the Chinese APT ecosystem.</p>
<h2>Attribution Analysis</h2>
<p>We assess that Operation Digital Eye was highly likely conducted by a China-nexus cluster with cyberespionage motivations. The specific group responsible remains unclear due to the extensive sharing of malware, operational playbooks, and infrastructure management processes among Chinese APT clusters. Our assessment is based on a collective consideration of multiple indicators, including the malware, infrastructure, and techniques used, victimology, and the timing of the activities.</p>
<h3>Malware</h3>
<p>A variant of the PHPsert webshell contains code comments in simplified Chinese. This suggests the potential involvement of Chinese-speaking developers. Further, the custom Mimikatz modification <code>bK2o.exe</code> used in Operation Digital Eye is part of the mimCN collection and shares implementation overlaps with other custom Mimikatz modifications, suggesting a common origin. These tools have been observed exclusively in the context of suspected Chinese APT activities, such as <a href="https://www.cybereason.com/blog/research/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers" target="_blank" rel="noopener noreferrer">Operation Soft Cell</a> and <a href="https://www.sentinelone.com/labs/operation-tainted-love-chinese-apts-target-telcos-in-new-attacks/" target="_blank" rel="noopener noreferrer">Operation Tainted Love</a>. Malware and tooling used in these operations have been associated with the suspected Chinese APT groups Granite Typhoon and APT41, and <a href="https://github.com/yt0ng/cracking_softcell/blob/main/Cracking_SOFTCLL_TLP_WHITE.pdf" target="_blank" rel="noopener noreferrer">possible connections</a> to other China-nexus groups, such as APT10 and Lucky Mouse have also been suggested.</p>
<p>The mimCN tool collection suggests the presence of a shared vendor or digital quartermaster responsible for the sustained development and provisioning of tools to groups within the Chinese APT ecosystem. This function is <a href="https://go.recordedfuture.com/hubfs/reports/cta-2023-1107.pdf" target="_blank" rel="noopener noreferrer">suspected</a> to play a significant role in the Chinese threat landscape. The <a href="https://www.sentinelone.com/labs/unmasking-i-soon-the-leak-that-revealed-chinas-cyber-operations/" target="_blank" rel="noopener noreferrer">I-Soon leak</a>, which offers rare insight into China’s cyberespionage activities, provides supporting evidence for the existence of digital quartermasters within this landscape.</p>
<h3>Infrastructure</h3>
<p>While not exclusive to Chinese APT groups, the use of M247 infrastructure, as seen in Operation Digital Eye, has been common among them in recent years. One example is the <a href="https://www.sentinelone.com/labs/sandman-apt-china-based-adversaries-embrace-lua/" target="_blank" rel="noopener noreferrer">M247 infrastructure attributed</a> to the suspected Chinese cluster STORM-0866 (also known as Red Dev 40), with which the <a href="https://www.sentinelone.com/labs/sandman-apt-a-mystery-group-targeting-telcos-with-a-luajit-toolkit/" target="_blank" rel="noopener noreferrer">Sandman APT group</a> is associated.</p>
<p>Additionally, the use of Cloud services and resources located in geographic proximity to the targeted organizations in Operation Digital Eye suggests a carefully planned and targeted infrastructure management approach. In this context, we suspect the potential involvement of third-party entities tasked with administering and provisioning infrastructure, a practice that has become <a href="https://cloud.google.com/blog/topics/threat-intelligence/china-nexus-espionage-orb-networks/" target="_blank" rel="noopener noreferrer">increasingly common</a> in the Chinese APT ecosystem in recent years.</p>
<h3>Abuse of Visual Studio Code</h3>
<p>Our visibility into threat actor activities suggests that the abuse of Visual Studio Code tunneling for C2 purposes was relatively rare in the wild before Operation Digital Eye.</p>
<p>Previous <a href="https://venturebeat.com/security/crowdstrike-2024-report-exposes-north-koreas-covert-workforce-in-u-s-tech-firms/" target="_blank" rel="noopener noreferrer">research</a> indicates that, starting in 2023, a suspected North Korean group has used Visual Studio Remote Tunnels to maintain persistence in compromised networks. Additionally, in October 2024, Cyble released a <a href="https://cyble.com/blog/silent-intrusion-unraveling-the-sophisticated-attack-leveraging-vs-code-for-unauthorized-access/" target="_blank" rel="noopener noreferrer">report</a> documenting unattributed activity in which threat actors distributed a <a href="https://www.sentinelone.com/labs/who-needs-macros-threat-actors-pivot-to-abusing-explorer-and-other-lolbins-via-windows-shortcuts/" target="_blank" rel="noopener noreferrer">Windows Shortcut</a> (LNK) file to deploy Visual Studio Code and activate its tunneling feature to establish remote access.</p>
<p>As of this writing, the only publicly disclosed use of this technique around the time of Operation Digital Eye has been attributed to a suspected Chinese APT group. In September 2024, Unit 42 published a <a href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" target="_blank" rel="noopener noreferrer">report</a> on a campaign targeting government entities in Southeast Asia, in which threat actors used Visual Studio Code as a backdoor. The campaign was attributed to Stately Taurus (also known as Mustang Panda). The exact timeline of the campaign is unclear, with mid-August 2024 being the only reference point explicitly mentioned in the Unit 42 report. Based on this, we suspect that Operation Digital Eye occurred prior to this activity.</p>
<p>We did not observe any overlaps in TTPs between Operation Digital Eye and the activity reported by Unit 42, except for the abuse of Visual Studio Code. We recognize the possibility that distinct Chinese APT clusters may share operational playbooks that include leveraging Visual Studio Code for C2 purposes.</p>
<h3>Temporal Analysis</h3>
<p>Our analysis of timestamps marking the dates and times of operator activity in the targeted organizations showed that all activities occurred on workdays (Monday to Friday). Additionally, converting the timestamps from their original time zones, Coordinated Universal Time (UTC) and Central European Summer Time (CEST, UTC+2), to China Standard Time (CST, UTC+8) revealed that the operators were primarily active during typical working hours in China, mostly between 9 a.m. and 9 p.m. CST.</p>
<p>This suggests a potentially state-sanctioned operation. The &#8216;996&#8217; work schedule (9 a.m. to 9 p.m. CST, six days a week) has been common in China’s technology sector, but it was <a href="https://www.reuters.com/world/china/chinese-authorities-say-overtime-996-policy-is-illegal-2021-08-27/" target="_blank" rel="noopener noreferrer">ruled illegal</a> by the Supreme People&#8217;s Court in 2021. As a result, state employees are almost certainly restricted to weekday work, typically between 9 a.m. and 9 p.m., aligning closely with our observations from the timestamp analysis.</p>
<p>The figure below shows the total number of connections established by the threat actors to Visual Studio Code tunnels throughout Operation Digital Eye, broken down by hour of the day. The data is presented in both the original time zone (CEST) and in China Standard Time (CST, CEST+6). We observed minimal to no activity between 10 p.m. and 9 a.m. CST, as well as between 11 a.m. and 1 p.m. CST, which aligns with the typical daily working hours in China, including the midday lunch break.</p>
<figure id="attachment_109536" aria-describedby="caption-attachment-109536" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye7.jpg" alt="Number of established connections to Visual Studio Code tunnels" width="1999" height="704" class="size-full wp-image-109536" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye7.jpg 1999w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye7-300x106.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye7-1024x361.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye7-768x270.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/Op_Digital_Eye7-1536x541.jpg 1536w" sizes="(max-width: 1999px) 100vw, 1999px" /><figcaption id="caption-attachment-109536" class="wp-caption-text">Number of established connections to Visual Studio Code tunnels</figcaption></figure>
<h2>Conclusions</h2>
<p>Operation Digital Eye highlights the persistent threat posed by Chinese cyberespionage groups to European entities, with these threat actors continuing to focus on high-value targets. The campaign underscores the strategic nature of this threat, as breaching organizations that provide data, infrastructure, and cybersecurity solutions to other industries gives the attackers a foothold in the digital supply chain, enabling them to extend their reach to downstream entities.</p>
<p>The abuse of Visual Studio Code Remote Tunnels in this campaign illustrates how Chinese APT groups often rely on practical, solution-oriented approaches to evade detection. By leveraging a trusted development tool and infrastructure, the threat actors aimed to disguise their malicious activities as legitimate. The exploitation of widely used technologies, which security teams may not scrutinize closely, presents a growing challenge for organizations. For defenders, this calls for a reevaluation of traditional security approaches and the implementation of robust detection mechanisms to identify such evasive techniques in real time.</p>
<p>Lateral movement capabilities observed in Operation Digital Eye, linked to custom Mimikatz modifications used in previous campaigns, indicate the potential involvement of shared vendors or digital quartermasters and the important function they serve in the Chinese APT ecosystem. These centralized entities provide continuity and adaptability to cyberespionage operations, equipping threat actors with consistently updated tools and evolving tactics as they target new victims.</p>
<h2>Indicators of Compromise</h2>
<div style="font-size:0.8em">
<b>SHA1 Hashes</b></p>
<div style="overflow-x:auto;">
<table style="border-collapse: collapse; width: 100%; height: 120px;">
<tbody>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;"><strong>Value</strong></td>
<td style="width: 35.0%; height: 24px;"><strong>Note</strong></td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">0be9dd709d7d68887a92c793881dd4a010796e95</td>
<td style="width: 35.0%; height: 24px;">The CreateDump tool (do.exe)</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">213f06ed5ac9e688816b4bbe73bf507994949964</td>
<td style="width: 35.0%; height: 24px;">The GetUserInfo tool</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">289f3bfe297923507cf4c26ca500ae01819c6a95</td>
<td style="width: 35.0%; height: 24px;">The local.exe tool</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">2e2cf8a4a0e7decceb8e22536b13173479da0d13</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">3035d8846d7a9f309f2d24daba6ac33ad99524fc</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">399776991a094e1ee78b2a915bf4491e67c04ec7</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">3a688c844259822c51ceb3aea508303c4a654eb3</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">4d6947a19dd9a420c22fee39fac8b4df95a47569</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">63cea28d927f8e629377399fa08a9cb4fd0c6238</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">6549e50645bb1c02e4972651d335a75cb6d5aa74</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">7941909fd5c1277c6f7baf21e484c9e59ea454ee</td>
<td style="width: 35.0%; height: 24px;">mimCN (bK2o.exe)</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">7cb7bcb9187f8faf47fd77cf1213ab3fe2350a77</td>
<td style="width: 35.0%; height: 24px;">mimCN (simplify_32.exe)</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">82b1cb9b69d5f05bb20852322fb3c2c00bce9134</td>
<td style="width: 35.0%; height: 24px;">mimCN (wsx.exe)</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">83ca53c95705352ff60149b0b17a686956e23172</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">a9d6d0c47728094feb794ad7e25c253737633140</td>
<td style="width: 35.0%; height: 24px;">Visual Studio Code (code.exe)</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">b2811cb4d0afe13d2722093039a72588c348dcfd</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">c0e03fce8f7f51e91da79f773aa870f0897b0ee2</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">cb6726fb3f7952ede04ed22d2c72389255991827</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">d57fa43944676c56e66f4b20ffa3d82048e354fd</td>
<td style="width: 35.0%; height: 24px;">PHPsert variant</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">e572380ab95c4ab5a87f701d4654d3386911b387</td>
<td style="width: 35.0%; height: 24px;">do.bat</td>
</tr>
<tr style="height: 24px;">
<td style="width: 65.0%; height: 24px;">e8a8d8fa7122c1592a314343b45bac2c213bb57d</td>
<td style="width: 35.0%; height: 24px;">mimCN (wsx1.exe)</td>
</tr>
</tbody>
</table>
</div>
<p><b>IP Addresses</b></p>
<div style="overflow-x:auto;">
<table style="border-collapse: collapse; width: 100%; height: 120px;">
<tbody>
<tr style="height: 24px;">
<td style="width: 38.0%;   height: 24px;"><strong>Value</strong></td>
<td style="width: 62.0%;   height: 24px;"><strong>Note</strong></td>
</tr>
<tr style="height: 24px;">
<td style="width: 38.0%;   height: 24px;">146.70.161[.]78</td>
<td style="width: 62.0%;   height: 24px;">Server used for initial access (SQL injection attack)</td>
</tr>
<tr style="height: 24px;">
<td style="width: 38.0%;   height: 24px;">185.76.78[.]117</td>
<td style="width: 62.0%;   height: 24px;">C2 server (PHPsert webshells)</td>
</tr>
<tr style="height: 24px;">
<td style="width: 38.0%;   height: 24px;">20.103.221[.]187</td>
<td style="width: 62.0%;   height: 24px;">Visual Studio Code dev tunnel</td>
</tr>
<tr style="height: 24px;">
<td style="width: 38.0%;   height: 24px;">4.232.170[.]137</td>
<td style="width: 62.0%;   height: 24px;">C2 server (SSH access)</td>
</tr>
</tbody>
</table>
</div>
<p><b>Domains</b></p>
<div style="overflow-x:auto;">
<table style="border-collapse: collapse; width: 100%; height: 120px;">
<tbody>
<tr style="height: 24px;">
<td style="width: 38.0%;   height: 24px;"><strong>Value</strong></td>
<td style="width: 62.0%;   height: 24px;"><strong>Note</strong></td>
</tr>
<tr style="height: 24px;">
<td style="width: 38.0%;   height: 24px;">[REDACTED].euw.devtunnels[.]ms</td>
<td style="width: 62.0%;   height: 24px;">Visual Studio Code dev tunnel</td>
</tr>
</tbody>
</table>
</div>
</div>
]]></content:encoded>
					
		
		
		<enclosure url="https://www.sentinelone.com/wp-content/uploads/2024/11/Op-Digital-Eye-ftr.jpg" length="524719" type="image/jpeg" />	</item>
		<item>
		<title>LABScon24 Replay &#124; PKfail: Supply-Chain Failures in Secure Boot Key Management</title>
		<link>https://www.sentinelone.com/labs/labscon24-replay-pkfail-supply-chain-failures-in-secure-boot-key-management/</link>
		
		<dc:creator><![CDATA[LABScon]]></dc:creator>
		<pubDate>Tue, 03 Dec 2024 16:15:30 +0000</pubDate>
				<category><![CDATA[labscon24]]></category>
		<guid isPermaLink="false">https://www.sentinelone.com/?post_type=labs&#038;p=110004</guid>

					<description><![CDATA[Binarly’s Alex Matrosov and Fabio Pagani present PKfail, a firmware supply-chain security issue affecting major device vendors and hundreds of device models.]]></description>
										<content:encoded><![CDATA[<p>Modern computing heavily relies on establishing and maintaining trust, which begins with trusted foundations and extends through operating systems and applications in a chain-like manner. This ensures that end users can confidently rely on the integrity of the underlying hardware, firmware, and software.</p>
<p>One of the most prevalent mechanisms for enforcing trust in the UEFI firmware ecosystem is Secure Boot, which ensures that only digitally signed and verified software is executed during the system boot process, safeguarding against attacks on “external” firmware components and boot loaders. A key component of Secure Boot is the Platform Key (PK), the root-of-trust key used for managing the cryptographic material that validates external components and bootloaders before execution.</p>
<p>Given its critical role, one would expect all best practices for cryptographic key management to be meticulously followed, but that has not always been the case. </p>
<p>In this talk, Binarly’s Alex Matrosov and Fabio Pagani unveil PKfail, a firmware supply-chain security issue affecting major device vendors and hundreds of device models. PKfail is the result of shipping default test keys included by IBVs in their reference implementation—a problem known since 2016 but clearly forgotten by the firmware industry.</p>
<p>Given these test keys leaked during various data breaches in the past few years, an attacker can leverage PKfail to completely bypass Secure Boot on affected devices. As Alex and Fabio  demonstrate in the presentation, PKfail makes it extremely straightforward to bootkit affected devices and to launch advanced firmware-level threats, such as BlackLotus.</p>
<p>The speakers also offer a retrospective industry-wide analysis on PKfail, based on their extensive dataset of UEFI firmware images, spanning hundreds of product lines marketed over the past decade.</p>
<p><iframe loading="lazy" src="https://www.youtube.com/embed/lTA2r_5kNhU" width="700" height="392" frameborder="0" allowfullscreen="allowfullscreen"></iframe></p>
<h2>About the Authors</h2>
<p><a href="https://www.labscon.io/speakers/alex-matrosov/" rel="noopener" target="_blank">Alex Matrosov</a> is CEO and Founder of <a href="https://www.binarly.io/" rel="noopener" target="_blank">Binarly Inc</a>. where he builds an AI-powered platform to protect devices against emerging firmware threats. Alex has over two decades of experience with reverse engineering, advanced malware analysis, firmware security, and exploitation techniques.</p>
<p><a href="https://www.labscon.io/speakers/fabio-pagani/" rel="noopener" target="_blank">Fabio Pagani</a> is a Vulnerability Research Lead at Binarly, where he works at the intersection of static and dynamic analysis techniques to help secure the UEFI ecosystem. As part of the Binarly REsearch team, he discovered LogoFAIL and helped affected vendors to identify and mitigate this vulnerability.</p>
<h2>About LABScon</h2>
<p>This presentation was featured live at <a href="https://www.labscon.io/" target="_blank" rel="noopener noreferrer">LABScon</a> 2024, an immersive 3-day conference bringing together the world’s top cybersecurity minds, hosted by SentinelOne’s research arm, SentinelLabs.</p>
<p>Keep up with all the latest on <a href="https://www.labscon.io/" target="_blank" rel="noopener noreferrer">LABScon 2025</a> here.</p>
]]></content:encoded>
					
		
		
		<enclosure url="https://www.sentinelone.com/wp-content/uploads/2024/12/pkfail-ftr.jpg" length="539312" type="image/jpeg" />	</item>
		<item>
		<title>LABScon24 Replay &#124; A 30-Year Journey from Compilation Student to Decompilation Pioneer</title>
		<link>https://www.sentinelone.com/labs/labscon24-replay-a-30-year-journey-from-compilation-student-to-decompilation-pioneer/</link>
		
		<dc:creator><![CDATA[LABScon]]></dc:creator>
		<pubDate>Tue, 26 Nov 2024 14:00:02 +0000</pubDate>
				<category><![CDATA[Decompilers]]></category>
		<category><![CDATA[labscon24]]></category>
		<category><![CDATA[Malware Analysis]]></category>
		<category><![CDATA[tools]]></category>
		<guid isPermaLink="false">https://www.sentinelone.com/?post_type=labs&#038;p=109618</guid>

					<description><![CDATA[Dr. Cristina Cifuentes, known as the Mother of Decompilation, reflects on three decades of innovation in reverse engineering in her LABScon 2024 keynote.]]></description>
										<content:encoded><![CDATA[<p>In 1990, Cristina Cifuentes worked on a machine code interpreter for the Modula-2 programming language as part of her Compilers project. That summer, she integrated it into a mixed GPM Modula-2 compiler/interpreter for the 8086 processor. This gave her hands-on experience with assembly language and the process of converting intermediate representations into executable code, laying the groundwork for her later research.</p>
<p>In 1994, she submitted a PhD thesis entitled <i>Reverse Compilation Techniques</i>. The work involved analyzing 80286 DOS binaries, studying assembly language, mapping groups of instructions into graphs, tracing parameters and data flows, and understanding how compilers optimized code. Her groundbreaking research introduced techniques that, while initially a niche academic endeavor, gained significant traction in the 2000s with the rising focus on application security and need to reverse engineer malware</p>
<p>In this keynote, Dr Cifuentes reflects on her pioneering PhD work, the evolution of decompilation technology over the past three decades, its adoption in commercial applications, and its role in developing tools for malware analysis.</p>
<p>Through this retrospective, she connects the foundational research of her early career with its enduring impact on cybersecurity today.</p>
<p><iframe loading="lazy" src="https://www.youtube.com/embed/wo3xEa2elp4" width="700" height="392" frameborder="0" allowfullscreen="allowfullscreen"></iframe></p>
<h2>About the Author</h2>
<p>Dr Cristina Cifuentes is Vice President of Oracle’s Software Assurance organization. Cristina’s passion for tackling the big issues in the field of Program Analysis began with her doctoral work in binary decompilation at the Queensland University of Technology, which led to her being named the Mother of Decompilation for her contributions to this domain.</p>
<p>Before she joined Oracle and Sun Microsystems, Cristina held academic posts at major Australian Universities, co-edited Going Digital, a landmark book on Cybersecurity, and served on the executive committees of ACM SIGPLAN and IEEE Reverse Engineering.</p>
<h2>About LABScon</h2>
<p>This presentation was featured live at <a href="https://www.sentinelone.com/blog/labscon24-highlights-examining-the-latest-in-cybersecurity-trends-challenges/" target="_blank" rel="noopener noreferrer">LABScon 2024</a>, an immersive 3-day conference bringing together the world’s top cybersecurity minds, hosted by SentinelOne’s research arm, SentinelLabs.</p>
<p>Keep up with all the latest on <a href="https://www.labscon.io/" target="_blank" rel="noopener noreferrer">LABScon 2025</a> here.</p>
]]></content:encoded>
					
		
		
		<enclosure url="https://www.sentinelone.com/wp-content/uploads/2024/11/Cristina-ftr.jpg" length="595795" type="image/jpeg" />	</item>
		<item>
		<title>CyberVolk &#124; A Deep Dive into the Hacktivists, Tools and Ransomware Fueling Pro-Russian Cyber Attacks</title>
		<link>https://www.sentinelone.com/labs/cybervolk-a-deep-dive-into-the-hacktivists-tools-and-ransomware-fueling-pro-russian-cyber-attacks/</link>
		
		<dc:creator><![CDATA[Jim Walter]]></dc:creator>
		<pubDate>Mon, 25 Nov 2024 10:55:10 +0000</pubDate>
				<category><![CDATA[Hacktivism]]></category>
		<guid isPermaLink="false">https://www.sentinelone.com/?post_type=labs&#038;p=108943</guid>

					<description><![CDATA[A loose collective of mostly low-skilled actors, CyberVolk absorbs and adapts a wide array of destructive malware for use against political targets.]]></description>
										<content:encoded><![CDATA[<h2>Executive Summary</h2>
<ul>
<li aria-level="1">CyberVolk/GLORIAMIST is a hacktivist collective originating in India with pro-Russia leanings. Between June and October 2024, CyberVolk claimed responsibility for multiple ransomware attacks.</li>
<li aria-level="1">The main objective of CyberVolk and related groups is to leverage geopolitical issues to launch and justify attacks on public and government entities, primarily in the service of Russian government interests.</li>
<li aria-level="1">SentinelLabs has observed a shared codebase used by CyberVolk, AzzaSec and DoubleFace’s ransomware. Additionally, CyberVolk has promoted other ransomware families like HexaLocker and Parano. These groups and the tools they leverage are all closely intertwined.</li>
<li aria-level="1">These hacktivist groups are extremely dynamic and volatile. In-fighting, threats, and inflated political-posturing are common, leading to fragmentation and the rapid re-shaping of the hacktivist threat landscape.</li>
</ul>
<h2>Introduction</h2>
<p>CyberVolk is a politically motivated hacktivist collective which launched its own RaaS in June 2024. The group uses both DDoS and ransomware attacks in its efforts to undermine and disrupt the operations of those opposed to Russian interests.</p>
<p>The group has become an increasingly prominent player within the cybercrime ecosystem, adopting and repurposing existing commodity malware to advance its causes. Highly-skilled actors within the collective expand and revise such tools, effectively making them more sophisticated as they move through various hands.</p>
<p>The CyberVolk collective is a prime example of how readily threat actors can access and deploy dangerous ransomware builders such as AzzaSec, Diamond, LockBit, Chaos and others. This adaptability makes the group highly dynamic and increasingly challenging to track.</p>
<p>In this post, we provide an overview of a number of ransomware families within the context of CyberVolk’s operations, breaking down the increasingly blurred lines between tools and group affiliations. Understanding the shifting nature of dynamic hacktivist collectives like CyberVolk can help organizations prepare and fortify their defenses.</p>
<h2>The Origins of CyberVolk Ransomware</h2>
<p>CyberVolk is a <a href="https://threatmon.io/blog/cybervolk-ransomware-technical-malware-analysis/" target="_blank" rel="noopener noreferrer">pro-India/pro-Russia</a> “hacktivist” group that has been actively targeting entities in multiple countries. In its current form, it emerged during May 2024. Prior to this, the group was known by a few different names, including GLORIAMIST, GLORIAMIST India and Solntsevskaya Bratva. CyberVolk exploits current geopolitical issues, focused on launching and justifying its attacks on public and government entities.</p>
<p><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_1-1.jpg" alt="" width="540" height="302" class="aligncenter size-full wp-image-109360" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_1-1.jpg 540w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_1-1-300x168.jpg 300w" sizes="(max-width: 540px) 100vw, 540px" /></p>
<p>While the group claims alliances with other broad groups such as <a href="https://www.sentinelone.com/blog/lapsus-data-breach/" target="_blank" rel="noopener noreferrer">LAPSUS$</a>, <a href="https://www.sentinelone.com/labs/hacktivism-and-state-sponsored-knock-offs-attributing-deceptive-hack-and-leak-operations/" target="_blank" rel="noopener noreferrer">Anonymous</a>, and the <a href="https://threatmon.io/blog/digital-war-in-the-middle-east-cyber-threats-in-israel-iran-conflict/" target="_blank" rel="noopener noreferrer">Moroccan</a> <a href="https://threatmon.io/blog/digital-war-in-the-middle-east-cyber-threats-in-israel-iran-conflict/" target="_blank" rel="noopener noreferrer">Dragons</a>, it has also been associated with <a href="https://www.sentinelone.com/labs/noname05716-the-pro-russian-hacktivist-group-targeting-nato/" target="_blank" rel="noopener noreferrer">NONAME057(16)</a> and other RU-friendly, DDoS-focused, groups. However, CyberVolk has also <a href="https://www.rapid7.com/blog/post/2024/10/03/ransomware-groups-demystified-cybervolk-ransomware/" target="_blank" rel="noopener noreferrer">embraced ransomware</a> as a tool to further its cause, with self-branded ransomware payloads as well as alliances with associated ransomware families, namely Doubleface, HexaLocker, and the Parano family.</p>
<p>CyberVolk’s branded ransomware is derived from the AzzaSec (<i>aka</i> AzzaSecurity) ransomware code. <a href="https://threatmon.io/blog/darkwebs-new-favorite-azzasec-ransomware/" target="_blank" rel="noopener noreferrer">AzzaSec</a> is a pro-Russia, anti-Israel, and anti-Ukraine hacktivist group that emerged in February of 2024. It has claimed alliances with some of the same groups linked to CyberVolk such as <a href="https://www.sentinelone.com/labs/noname05716-the-pro-russian-hacktivist-group-targeting-nato/" target="_blank" rel="noopener noreferrer">NONAME057(16)</a>. Initially conducting DDoS and defacement attacks, the group later expanded into extortion and ransomware.</p>
<figure id="attachment_109345" aria-describedby="caption-attachment-109345" style="width: 560px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109345" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_30.jpg" alt="June 2024 Release of AzzaSec Ransomware" width="560" height="571" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_30.jpg 560w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_30-294x300.jpg 294w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_30-50x50.jpg 50w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_30-24x24.jpg 24w" sizes="(max-width: 560px) 100vw, 560px" /><figcaption id="caption-attachment-109345" class="wp-caption-text">June 2024 Release of AzzaSec Ransomware</figcaption></figure>
<p>In June, the source-code for “AzzaSec Ransom” was leaked and subsequently adopted and adapted by multiple groups aligned with AzzaSec’s mission. Prior to its disbandment in August of 2024, AzzaSec operated under a ransomware-as-a-service (RaaS) model and pushed out multiple iterations of its Windows-centric ransomware.</p>
<figure id="attachment_109308" aria-describedby="caption-attachment-109308" style="width: 499px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_42.jpg" alt="AzzaSec “disbandment” announcement, August 2024" width="499" height="731" class="size-full wp-image-109308" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_42.jpg 499w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_42-205x300.jpg 205w" sizes="(max-width: 499px) 100vw, 499px" /><figcaption id="caption-attachment-109308" class="wp-caption-text">AzzaSec “disbandment” announcement, August 2024</figcaption></figure>
<h2>Post-AzzaSec | The Rise of CyberVolk’s RaaS Operations</h2>
<p>The CyberVolk-branded RaaS was announced in late June 2024.</p>
<figure id="attachment_109347" aria-describedby="caption-attachment-109347" style="width: 755px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_20.jpg" alt="CyberVolk Ransomware Announcement, June 2024" width="755" height="385" class="size-full wp-image-109347" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_20.jpg 755w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_20-300x153.jpg 300w" sizes="(max-width: 755px) 100vw, 755px" /><figcaption id="caption-attachment-109347" class="wp-caption-text">CyberVolk Ransomware Announcement, June 2024</figcaption></figure>
<p>The CyberVolk-modified ransomware’s development is credited to<code> @ghostdoor_maldev</code> and is based on the earlier AzzaSec Ransomware code. The Windows-specific payloads are written in C++. Upon execution, the payloads drop bitmap images (files with extension <code>.bmp</code>) into <code>%temp%</code> folder, and display them, prior to any encryption occurring. The ransomware will terminate any running processes belonging to either Microsoft Management Console (MMC) or Task Manager.</p>
<figure id="attachment_109302" aria-describedby="caption-attachment-109302" style="width: 568px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_8.jpg" alt="CyberVolk Ransomware MMC processes and Task Manager Termination" width="568" height="206" class="size-full wp-image-109302" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_8.jpg 568w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_8-300x109.jpg 300w" sizes="(max-width: 568px) 100vw, 568px" /><figcaption id="caption-attachment-109302" class="wp-caption-text">CyberVolk Ransomware MMC processes and Task Manager Termination</figcaption></figure>
<p>Early versions of CyberVolk Ransomware used the AES algorithm for file encryption and the SHA512 algorithm for key generation. This was later updated to “ChaCha20-Poly1305 + AES + RSA + Quantum resistant algorithms” according to posts on the group&#8217;s Telegram.</p>
<figure id="attachment_109326" aria-describedby="caption-attachment-109326" style="width: 1661px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_26.jpg" alt="CyberVolk wallpaper with countdown timer" width="1661" height="876" class="size-full wp-image-109326" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_26.jpg 1661w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_26-300x158.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_26-1024x540.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_26-768x405.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_26-1536x810.jpg 1536w" sizes="(max-width: 1661px) 100vw, 1661px" /><figcaption id="caption-attachment-109326" class="wp-caption-text">CyberVolk wallpaper with countdown timer</figcaption></figure>
<p>The payment screen used by CyberVolk Ransomware displays the decryption timer along with payment details. CyberVolk ransomware supports BTC and USDT payments. Across all the functional samples we analyzed, the timeout value was set to 5 hours, with the ransom amount set to $1000.00 (equivalent in BTC or USDT). A ransom note named <code>CyberVolk_Readme.txt</code> containing the same contact details presented in the wallpaper and payment screens is also dropped to disk. Telegram contact details are provided as well.</p>
<figure id="attachment_109348" aria-describedby="caption-attachment-109348" style="width: 746px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/cybervolk28.jpg" alt="CyberVolk ransom note" width="746" height="224" class="size-full wp-image-109348" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/cybervolk28.jpg 746w, https://www.sentinelone.com/wp-content/uploads/2024/11/cybervolk28-300x90.jpg 300w" sizes="(max-width: 746px) 100vw, 746px" /><figcaption id="caption-attachment-109348" class="wp-caption-text">CyberVolk ransom note</figcaption></figure>
<p>The <code>.CyberVolk</code> extension is added to affected files:</p>
<figure id="attachment_109350" aria-describedby="caption-attachment-109350" style="width: 621px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_23.jpg" alt="CyberVolk-encrypted files" width="621" height="430" class="size-full wp-image-109350" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_23.jpg 621w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_23-300x208.jpg 300w" sizes="(max-width: 621px) 100vw, 621px" /><figcaption id="caption-attachment-109350" class="wp-caption-text">CyberVolk-encrypted files</figcaption></figure>
<p>The decryption timer is controlled via a <code>time.dat</code> file written to <code>%appdata%\Roaming</code> directory. The timeout is set to 5 hours in CyberVolk samples analyzed by SentinelOne. This functionality is mirrored in the Invisible Ransom payloads as well, as they are based on the same codebase (AzzaSec Ransom).</p>
<figure id="attachment_109328" aria-describedby="caption-attachment-109328" style="width: 708px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_24.jpg" alt="Decryption timer in CyberVolk" width="708" height="233" class="size-full wp-image-109328" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_24.jpg 708w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_24-300x99.jpg 300w" sizes="(max-width: 708px) 100vw, 708px" /><figcaption id="caption-attachment-109328" class="wp-caption-text">Decryption timer in CyberVolk</figcaption></figure>
<p>The <code>time.dat</code> file stores the defined timeout value in seconds. Default builds of Invisible Ransom (or CyberVolk) will write <code>time.dat</code> with a value of <strong>17967</strong> seconds (roughly 5 hours).</p>
<p>CyberVolk has continued to utilize their branded ransomware payloads, more recently in attacks against entities in Japan, and hype up these attacks across their various channels (e.g., Telegram, X, Discord). These campaigns were part of “#OpJP” which extended through October. Victims of “#OpJP” include:</p>
<ul>
<li aria-level="1">The Japan Foundation</li>
<li aria-level="1">Japan Oceanographic Data Center (JODC)</li>
<li aria-level="1">The Japan Meteorological Agency (JMA)</li>
<li aria-level="1">Tokyo Global Information System Centre</li>
</ul>
<figure id="attachment_109351" aria-describedby="caption-attachment-109351" style="width: 523px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_43.jpg" alt="CyberVolk and #OpJP (Targeting Japan)" width="523" height="445" class="size-full wp-image-109351" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_43.jpg 523w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_43-300x255.jpg 300w" sizes="(max-width: 523px) 100vw, 523px" /><figcaption id="caption-attachment-109351" class="wp-caption-text">CyberVolk and #OpJP (Targeting Japan)</figcaption></figure>
<h2>CyberVolk Associates | Invisible/Doubleface Team Ransomware</h2>
<p>Invisible or Doubleface ransomware is associated with “Doubleface Team” (<i>aka</i> Double Alliance). This group emerged in August-September 2024 as a convergence of associates within CyberVolk, Doubleface, and Moroccan Black Cyber Army. CyberVolk began promoting Doubleface on September 22, 2024.</p>
<figure id="attachment_109342" aria-describedby="caption-attachment-109342" style="width: 493px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_11.jpg" alt="September 22 DoubleAlliance / CyberVolk posting" width="493" height="404" class="size-full wp-image-109342" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_11.jpg 493w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_11-300x246.jpg 300w" sizes="(max-width: 493px) 100vw, 493px" /><figcaption id="caption-attachment-109342" class="wp-caption-text">September 22 DoubleAlliance / CyberVolk posting</figcaption></figure>
<p>Invisible/Doubleface ransomware payloads function in an identical manner to CyberVolk-branded ransomware samples. This includes duplication of the 5-hour timeout setting and active wallpaper modification used for input of the decryption key and displaying payment details. Both ransomware families are derived from the same AzzaSec Ransomware code base.</p>
<figure id="attachment_109311" aria-describedby="caption-attachment-109311" style="width: 1065px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_4.jpg" alt="Invisible/Doubleface ransomware wallpaper" width="1065" height="545" class="size-full wp-image-109311" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_4.jpg 1065w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_4-300x154.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_4-1024x524.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_4-768x393.jpg 768w" sizes="(max-width: 1065px) 100vw, 1065px" /><figcaption id="caption-attachment-109311" class="wp-caption-text">Invisible/Doubleface ransomware wallpaper</figcaption></figure>
<h3>Invisible/Doubleface Source</h3>
<p>The source code/builder for Invisible has been leaked publicly and distributed through various channels, mainly Telegram. As stated previously, both Invisible and CyberVolk’s payloads as of this writing are based on the same code, observed in AzzaSec Ransomware.</p>
<figure id="attachment_109336" aria-describedby="caption-attachment-109336" style="width: 972px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_17.jpg" alt="Invisible Ransom source files" width="972" height="350" class="size-full wp-image-109336" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_17.jpg 972w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_17-300x108.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_17-768x277.jpg 768w" sizes="(max-width: 972px) 100vw, 972px" /><figcaption id="caption-attachment-109336" class="wp-caption-text">Invisible Ransom source files</figcaption></figure>
<p>The archive contains the full Visual Studio project and source code for building new Invisible Ransom payloads, along with some already compiled samples/stubs.</p>
<p>The file <code>ransom.cpp</code> contains the main logic for the ransomware payload. It contains all the global variables including ransomware note template data, orchestrates all the encryption tasks, and handles any process termination or manipulation. The main <code>ransom.cpp</code> handles calls out to <code>Cryptographic.cpp</code> to process encryption tasks, including the implementation of AES/RSA (via <code>aes.cpp</code> and <code>rsa.cpp</code> respectively).</p>
<p>Similar to earlier AzzaSec ransomware examples, these payloads encrypt files via AES, then manage encryption keys and wrapping via RSA. The current implementation indicates AES-256 for file encryption, and RSA-2048 for wrapping the keys. Each file is encrypted via AES-256 (EncFile function in <code>Cryptographic.cpp</code>) with the AES key then encrypted via RSA-2048.</p>
<figure id="attachment_109313" aria-describedby="caption-attachment-109313" style="width: 1398px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_38.jpg" alt="Encrypting files in Invisible Ransom" width="1398" height="916" class="size-full wp-image-109313" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_38.jpg 1398w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_38-300x197.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_38-1024x671.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_38-768x503.jpg 768w" sizes="(max-width: 1398px) 100vw, 1398px" /><figcaption id="caption-attachment-109313" class="wp-caption-text">Encrypting files in Invisible Ransom</figcaption></figure>
<p>We can also see the implementation of the ransom countdown mechanism in <code>ransom.cpp</code>. As with CyberVolk Ransom, the default timeout period is 5 hours. This is initially set via the <code>timeLeft</code> variable in <code>ransom.cpp</code></p>
<p>The timer writes a <code>time.dat</code> file to <code>%appdata%\Roaming</code> as we saw with CyberVolk. The 5 hour time limit for these samples is read from this path. In theory, this file could be manipulated to alter the timeout.</p>
<figure id="attachment_109331" aria-describedby="caption-attachment-109331" style="width: 741px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_21.jpg" alt="Timer code in Invisible Ransom, referencing time.dat" width="741" height="361" class="size-full wp-image-109331" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_21.jpg 741w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_21-300x146.jpg 300w" sizes="(max-width: 741px) 100vw, 741px" /><figcaption id="caption-attachment-109331" class="wp-caption-text">Timer code in Invisible Ransom, referencing time.dat</figcaption></figure>
<p>The <code>ransom.cpp</code> source file also contains the template for the ransom notes, which are written to the same path from which the ransomware is executed as <code>InvisibleReadMe.txt</code>.</p>
<figure id="attachment_109387" aria-describedby="caption-attachment-109387" style="width: 744px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_7cut.jpg" alt="Invisible Ransom ransom note template in “ransom.cpp”" width="744" height="95" class="size-full wp-image-109387" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_7cut.jpg 744w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_7cut-300x38.jpg 300w" sizes="(max-width: 744px) 100vw, 744px" /><figcaption id="caption-attachment-109387" class="wp-caption-text">Invisible Ransom&#8217;s ransom note template in “ransom.cpp”</figcaption></figure>
<p>The termination of MMC processes and Task Manager is also present in the Invisible Ransom source (as we also see with CyberVolk samples)</p>
<h2>“Lock. Demand. Dominate” | HexaLocker Ransomware</h2>
<p>HexaLocker is a ransomware family that first appeared in July 2024. HexaLocker is closely associated with <a href="https://www.sentinelone.com/blog/lapsus-data-breach/" target="_blank" rel="noopener noreferrer">LAPSUS$</a>, reportedly having been originally developed by “ZZART3XX”, a proclaimed former associate of the group. HexaLocker payloads are written in <a href="https://www.sentinelone.com/labs/alphagolang-a-step-by-step-go-malware-reversing-methodology-for-ida-pro/" target="_blank" rel="noopener noreferrer">Golang</a>. As of this writing, we have only observed payloads targeting Windows systems.</p>
<p>On July 22, CyberVolk first referenced HexaLocker via one of Holy League’s posts. The Holy League is a loosely affiliated group of 70+ members born out of protest against Spain and <a href="https://www.reuters.com/technology/cybersecurity/three-pro-russian-hackers-arrested-spain-over-cyberattacks-2024-07-20/" target="_blank" rel="noopener noreferrer">associated arrests</a> of members of <a href="https://www.sentinelone.com/labs/noname05716-the-pro-russian-hacktivist-group-targeting-nato/" target="_blank" rel="noopener noreferrer">NONAME057(16)</a>. HexaLocker’s posts and branding are all laden with their “Lock. Demand. Dominate” slogan.</p>
<p>In September 2024, HexaLocker launched a new Telegram channel after previous ones had been banned or removed. The updated channel contains details on their ongoing existence along with screenshots of the current HexaLocker panel.</p>
<figure id="attachment_109306" aria-describedby="caption-attachment-109306" style="width: 869px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_44.jpg" alt="HexaLocker Telegram message" width="869" height="295" class="size-full wp-image-109306" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_44.jpg 869w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_44-300x102.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_44-768x261.jpg 768w" sizes="(max-width: 869px) 100vw, 869px" /><figcaption id="caption-attachment-109306" class="wp-caption-text">HexaLocker Telegram message</figcaption></figure>
<p>Throughout October 2024, CyberVolk’s communication channels continued to echo messaging from HexaLocker. This includes HexaLocker’s solicitations for help in continuing to progress with HexaLocker. On October 2, 2024, HexaLocker posted an update asking for help but also teasing new features in the pipeline. These include:</p>
<ul>
<li aria-level="1">Stronger anti-debug/anti-analysis features</li>
<li aria-level="1">Advanced obfuscations (crypting/packing)</li>
<li aria-level="1">Inclusion of EDR/XDR/AV-Killer</li>
<li aria-level="1">Permanent AMSI bypass</li>
<li aria-level="1">Improved process-injection</li>
<li aria-level="1">Remote Thread Hijacking</li>
<li aria-level="1">UAC Bypass improvements</li>
<li aria-level="1">Self-deletion</li>
</ul>
<p>Interesting developments continued with HexaLocker throughout October 2024. On October 4th, the group posted an update with a video demo claiming that an “EDR Killer” and AMSI/WD Bypass features had been added. This was followed on October 6th with an update stating that UAC bypasses had been added to the product.</p>
<p>On October 20, 2024, the actor behind the HexaLocker Telegram channel (ZZART3XX) posted their intention to officially leave and denounce LAPSUS$ as well as any peripheral affiliations. This includes the maintenance of the HexaLocker project and all the relationships and alliances that revolve around it.</p>
<p>In this announcement, the author also indicated that they would be offering HexaLocker source code, including its web panel, along with “LAPSUS$ Ransomware” source for sale.</p>
<figure id="attachment_109320" aria-describedby="caption-attachment-109320" style="width: 500px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_31.jpg" alt="HexaLocker “shut down” posting via Telegram" width="500" height="487" class="size-full wp-image-109320" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_31.jpg 500w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_31-300x292.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_31-50x50.jpg 50w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_31-24x24.jpg 24w" sizes="(max-width: 500px) 100vw, 500px" /><figcaption id="caption-attachment-109320" class="wp-caption-text">HexaLocker “shut down” posting via Telegram</figcaption></figure>
<p>This was followed the next day on October 21 with offers to sell HexaLocker and the panel infrastructure, along with associated “LAPSUS$ Ransomware”. These messages were echoed across HexaLocker, Holy League, and LAPSUS$-aligned channels.</p>
<p>The overt promotion of HexaLocker within CyberVolk channels has ceased since the HexaLocker shutdown announcement.</p>
<h2>Parano Ransomware Within the CyberVolk Collective</h2>
<p>In late October 2024, various identities in the CyberVolk community began promoting the release of Parano Ransomware v1. This appears to be another affiliation for the CyberVolk collective.</p>
<figure id="attachment_109353" aria-describedby="caption-attachment-109353" style="width: 617px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_15.jpg" alt="October 2024 Parano Ransomware Announcement by CyberVolk" width="617" height="528" class="size-full wp-image-109353" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_15.jpg 617w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_15-300x257.jpg 300w" sizes="(max-width: 617px) 100vw, 617px" /><figcaption id="caption-attachment-109353" class="wp-caption-text">October 2024 Parano Ransomware Announcement by CyberVolk</figcaption></figure>
<p>According to the announcement, Parano Ransomware comes with a $400.00 USD price tag per single payload/stub. The ransomware features strong anti-analysis and anti-debugging features, and uses a combination of AES-128 and RSA-4096 for key management. </p>
<p>The Parano malware family extends beyond ransomware, also including “Parano Checker” and &#8220;Parano Stealer”, a commodity, Python-based, infostealer. The malware attempts to gather and exfiltrate browser data, Discord details, crypto wallet information and keys, along with other related software and system diagnostic details. The data can be exfiltrated via Discord webhook to a channel or location of the attacker&#8217;s choosing.</p>
<figure id="attachment_109355" aria-describedby="caption-attachment-109355" style="width: 516px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_35.jpg" alt="Parano Stealer Announcement, October 2024" width="516" height="475" class="size-full wp-image-109355" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_35.jpg 516w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_35-300x276.jpg 300w" sizes="(max-width: 516px) 100vw, 516px" /><figcaption id="caption-attachment-109355" class="wp-caption-text">Parano Stealer Announcement, October 2024</figcaption></figure>
<p>Parano Checker is a reconnaissance and info-gathering tool capable of navigating targets and helping to isolate interesting ingress points or data repositories, or assist with dictionary/brute force attacks on certain interfaces (e.g., CPanel and WordPress login panels).</p>
<p>At the time of writing, we have not observed the executable variations of Parano (<i>aka</i> Paraodeus Ransomware) in the wild. The author has shared a non-malicious Python-based demo of a “ScreenLocker”. As it stands, the nature of the relationship between CyberVolk and the Parano ecosystem is still evolving.</p>
<h2>Beyond Ransomware | CyberVolk Stealers and Webshells</h2>
<p>In addition to ransomware and other disruptive attacks, CyberVolk develops and distributes infostealer malware and webshells. The group announced the new webshell in late October 2024.</p>
<figure id="attachment_109318" aria-describedby="caption-attachment-109318" style="width: 469px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_33.jpg" alt="CyberVolk Webshell announcement (Telegram)" width="469" height="552" class="size-full wp-image-109318" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_33.jpg 469w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_33-255x300.jpg 255w" sizes="(max-width: 469px) 100vw, 469px" /><figcaption id="caption-attachment-109318" class="wp-caption-text">CyberVolk Webshell announcement (Telegram)</figcaption></figure>
<p>The CyberVolk webshell is distributed as a standard PHP file with the actual malicious code base64-encoded inside its body.</p>
<figure id="attachment_109325" aria-describedby="caption-attachment-109325" style="width: 981px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="magnify" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_27.jpg" alt="CyberVolk Webshell decoded" width="981" height="545" class="size-full wp-image-109325" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_27.jpg 981w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_27-300x167.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_27-768x427.jpg 768w" sizes="(max-width: 981px) 100vw, 981px" /><figcaption id="caption-attachment-109325" class="wp-caption-text">CyberVolk Webshell decoded</figcaption></figure>
<p>The publicly <a href="https://x.com/FalconFeedsio/status/1838244850669392307/photo/1" target="_blank" rel="noopener noreferrer">released</a> version of the CyberVolk webshell provides multiple functions. The current version of the webshell allows for files to be uploaded, renamed, and downloaded. Further, attackers can traverse directories on the target server and gather environmental details.</p>
<p>“CyberVolk Stealer” is distributed in the form of a Python script and is based on LBX-Grabber, an existing Python information stealer, which is in turn built into <a href="https://www.cyfirma.com/research/blx-stealer/" target="_blank" rel="noopener noreferrer">BLX-Stealer</a>. Specifically, CyberVolk is derived from the LBX-Grabber component.</p>
<figure id="attachment_109309" aria-describedby="caption-attachment-109309" style="width: 1764px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_41.jpg" alt="CyberVolk Stealer Python Script" width="1764" height="1034" class="size-full wp-image-109309" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_41.jpg 1764w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_41-300x176.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_41-1024x600.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_41-768x450.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_41-1536x900.jpg 1536w" sizes="(max-width: 1764px) 100vw, 1764px" /><figcaption id="caption-attachment-109309" class="wp-caption-text">CyberVolk Stealer Python Script</figcaption></figure>
<p>CyberVolk Stealer attempts to gather various types of data from the system, then exfiltrates the data via Discord. Version 1 of the stealer was announced in September 2024. Core features include robust gathering of browser, discord, game and crypto wallet data. The stealer targets multiple browsers and numerous wallets.</p>
<figure id="attachment_109304" aria-describedby="caption-attachment-109304" style="width: 663px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_6.jpg" alt="CyberVolk Stealer identifying sensitive data" width="663" height="533" class="size-full wp-image-109304" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_6.jpg 663w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_6-300x241.jpg 300w" sizes="(max-width: 663px) 100vw, 663px" /><figcaption id="caption-attachment-109304" class="wp-caption-text">CyberVolk Stealer identifying sensitive data</figcaption></figure>
<h2>Telegram Exit and Weaponized Bans</h2>
<p>In early November 2024, CyberVolk, and numerous affiliated groups, vanished from Telegram as a result of a mass ban of hacktivist groups. The last significant posts to the CyberVolk Telegram channels were on November 3, 2024.</p>
<p>The group subsequently announced, via Twitter/X, that it would only be using the X platform going forward. The Twitter/X account for DoubleFace, <code>@DoubleFace_Team</code>, made a similar announcement around the same time.</p>
<figure id="attachment_109322" aria-describedby="caption-attachment-109322" style="width: 1260px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_3.jpg" alt="Telegram ban updates on X" width="1260" height="346" class="size-full wp-image-109322" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_3.jpg 1260w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_3-300x82.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_3-1024x281.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_3-768x211.jpg 768w" sizes="(max-width: 1260px) 100vw, 1260px" /><figcaption id="caption-attachment-109322" class="wp-caption-text">Telegram ban updates on X</figcaption></figure>
<p>Telegram channels belonging to CyberVolk and numerous allies appear to have been banned maliciously. We have observed specific actors claiming responsibility for attempting to close and/or extort channels belonging to AzzaSec and DoubleFace amongst others.</p>
<p>In September, some users began threatening to have rival hacktivist group channels including CyberVolk, APTZone, Doubleface, AzzaSec and others banned.</p>
<figure id="attachment_109341" aria-describedby="caption-attachment-109341" style="width: 1586px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_12.jpg" alt="September 14, 2024 - “Matteo” targeting CyberVolk/APTZone with bans" width="1586" height="886" class="size-full wp-image-109341" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_12.jpg 1586w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_12-300x168.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_12-1024x572.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_12-768x429.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_12-1536x858.jpg 1536w" sizes="(max-width: 1586px) 100vw, 1586px" /><figcaption id="caption-attachment-109341" class="wp-caption-text">September 14, 2024 &#8211; “Matteo” targeting CyberVolk/APTZone with bans</figcaption></figure>
<p>On November 16, 2024, RipperSec posted their ‘perspective’ on the banning of multiple hacktivist channels, indicating that some prior members of AzzaSec and Doubleface were attempting to exhort other channels under the threat of a Telegram ban.</p>
<figure id="attachment_109334" aria-describedby="caption-attachment-109334" style="width: 675px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_19.jpg" alt="November 13, 2024 RipperSec Telegram Post" width="675" height="294" class="size-full wp-image-109334" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_19.jpg 675w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_19-300x131.jpg 300w" sizes="(max-width: 675px) 100vw, 675px" /><figcaption id="caption-attachment-109334" class="wp-caption-text">November 13, 2024 RipperSec Telegram Post</figcaption></figure>
<p>This was highlighted in another post on November 13, 2024 in the “Hunt3r Kill3rs” Telegram channel. In this post, an actor referring to AzzaSec claimed “they didn’t close nobody’s channels, all the channels got closed by me”. The post went on to advise others receiving extortion threats to ignore them. “I’m the only one that is closing the hacktivist community’s channels and groups”, the actor claimed.</p>
<figure id="attachment_109333" aria-describedby="caption-attachment-109333" style="width: 529px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_2.jpg" alt="November 13, 2024 posting in Hunt3r Kill3rs Telegram Channel" width="529" height="324" class="size-full wp-image-109333" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_2.jpg 529w, https://www.sentinelone.com/wp-content/uploads/2024/11/CyberVolk_2-300x184.jpg 300w" sizes="(max-width: 529px) 100vw, 529px" /><figcaption id="caption-attachment-109333" class="wp-caption-text">November 13, 2024 posting in Hunt3r Kill3rs Telegram Channel</figcaption></figure>
<p>This weaponization of the Telegram <a href="https://securityintelligence.com/articles/what-telegrams-recent-policy-shift-means-for-cyber-crime/" target="_blank" rel="noopener noreferrer">Terms-of-Service</a> is increasing in parallel with threat actor groups moving off Telegram to seek more clandestine and secure communication channels in response to increased <a href="https://apnews.com/article/telegram-pavel-durov-arrest-2c8015c102cce23c23d55c6ca82641c5" target="_blank" rel="noopener noreferrer">scrutiny</a> and declining trust in the platform after the arrest of Telegram founder Pavel Durov.</p>
<h2>Conclusion</h2>
<p>The number of ransomware families associated with the CyberVolk hacktivist group highlights the ability of this group to rapidly pivot, building upon existing tools to suit their needs and further their causes. Though primarily composed of lower-skilled threat actors that reach for and use whatever works for them, we continue to see how quickly the group is able to move and adapt.</p>
<p>The reuse of tools like AzzaSec Ransom, Diamond RW, and even more established ones like LockBit and Chaos, demonstrates just how dynamic these affiliations and alliances between hacktivist groups can be. Not only are such groups touting new tools within short time frames only to abandon them and pivot to something else later, the number of hacktivist groups is also growing. Infighting and tensions amongst them are also fuel for the rates of growth and change &#8211; as alliances crumble or shift, the threat environment stays highly volatile and dynamic, making it more difficult for cyber defenders to track their activities consistently.</p>
<p>As groups like CyberVolk leverage openly-available commodity tools with high potential for causing damage, they continue to add more layers of complexity, expanding and revising the tools as they are passed around within the collective. Ransomware operations will only get muddier and increase how much cybersecurity teams will need to monitor in order to stay up to date on the happenings within the cybercrime ecosystem.</p>
<h2>Indicators of Compromise</h2>
<div style="font-size:0.8em">
<p><strong>CyberVolk</strong><br />
0ce59e479ec6eacd3a44ed3de2dc572676e5b2dd<br />
16bf55122bbb6073cc1d77ce23e2a8e6052f9ec1 | Stealer<br />
3bf6a90017bf22083ab735ecf3f8589a3f220e53 | Ransom note<br />
5d8bed459f55a37e2fcb801d04de337a01c5d623 | Ransom note<br />
813c510fb2463ecc6dff7795ef96744ca82544b3 | Webshell<br />
b958fb7241cc9675b8dd967b02df6a6ad92de52d<br />
c70d2350cbac3d0abeb896adcce2fcf243943633 | Webshell<br />
eae366ee4a7c19a87bc5ab9360f4333907a6a387<br />
f5d0c94b2be91342dc01ecf2f89e7e6f21a74b90</p>
<p><strong>AzzaSec</strong><br />
5499da31260a4aa75eea46c1d4aa6559074749a8 | Ransomware (src)</p>
<p><strong>Invisible / Doubleface Team</strong><br />
197d5c9c5cbf53ed3e78d53a008b6ad665fa3e4c<br />
1f325950a7a8e1a2050e954f33d2c3774510bd6e<br />
59e293623e4fb828a29fb982d5ac9a4f993abc3b<br />
d35da3f4e36eebf36a130bc7e0182fc4c35cf551 | Archive</p>
<p><strong>HexaLocker</strong><br />
11288fb54c6f2ed4d8cddfb004c754e5e9c35ad5<br />
4c24fdf504af452fb7245db33bfc1dc4f72c04a8<br />
4f8e1e7bfd484cf312fdc77e8687086f6f6007c<br />
7ba4eb7842730bbc82fc129a3f3d4a239ac436c2<br />
84dacf9da57d9d69c2ca711831895bf185834b8c<br />
904f46ef4c66ccf844bf31d37c11298fb7f65157<br />
93334882ff3c03c42b1179d9db0c165c99145369<br />
a4b7ef2ca1d5fda318505cac6757b5313b47eeac<br />
b6a9c5692b76f2defc1c170bdce0e41d91d706db<br />
be581fc1f430dd6855effd9e54429c5c5fcb9f8c | Ransom note<br />
cd8f934fa7ba7817bb62f0e4b968b3f124355b60</p>
<p><strong>PDBs</strong> </p>
<pre>
C:/Users/zzart/Desktop/HexaLocker RaaS/crypter.go
C:/Users/zzart/Desktop/MalwareDeveloppement/HexaLocker RaaS/decrypt_key.go
C:/Users/zzart/Desktop/MalwareDeveloppement/HexaLocker RaaS/crypterV1.go
</pre>
<p><strong>DNS</strong><br />
darkslategray-baboon-853641[.]hostingersite[.]com</p>
<p><strong>LAPSUS$/HexaLocker</strong><br />
481830db2daf40607748bd9624e970781e7f4408<br />
e1d8993ef4bbc8d2aa331262e5422d91865acc4f</p>
<p><strong>Parano</strong><br />
3ce26f45f5da58ab75b4d1cecc78c3bbe275f708 | Stealer (archive)<br />
4581b30e6f5946a570963cd76dc79beaa8bcf1c3 | ScreenLocker<br />
91abb7fadf847f3810bbe0734e3c31d5dc7bce6d | ScreenLocker<br />
b5d8e690a75f07e7d3e18fcc5b86bfe2362a3300 | ScreenLocker
</div>
]]></content:encoded>
					
		
		
		<enclosure url="https://www.sentinelone.com/wp-content/uploads/2024/11/cybervolk_v2-ftr.jpg" length="900294" type="image/jpeg" />	</item>
		<item>
		<title>DPRK IT Workers &#124; A Network of Active Front Companies and Their Links to China</title>
		<link>https://www.sentinelone.com/labs/dprk-it-workers-a-network-of-active-front-companies-and-their-links-to-china/</link>
		
		<dc:creator><![CDATA[Tom Hegel &amp; Dakota Cary]]></dc:creator>
		<pubDate>Thu, 21 Nov 2024 10:55:47 +0000</pubDate>
				<category><![CDATA[China]]></category>
		<category><![CDATA[DPRK]]></category>
		<guid isPermaLink="false">https://www.sentinelone.com/?post_type=labs&#038;p=109228</guid>

					<description><![CDATA[SentinelLabs has identified multiple deceptive websites linked to businesses in China fronting for North Korea's fake IT workers scheme.]]></description>
										<content:encoded><![CDATA[<h2>Executive Summary</h2>
<ul>
<li aria-level="1">SentinelLabs has identified unique characteristics of multiple websites, now seized by the US Government, associated with the DPRK IT Worker front companies.</li>
<li aria-level="1">We assess with high confidence that DPRK actors seek to impersonate US based software and technology consulting businesses by copying the online brands of legitimate organizations, seeking to use these for financial objectives.</li>
<li aria-level="1">SentinelLabs has linked the activity to several active front companies and links these with high confidence to a larger set of organizations being created in China.</li>
<li aria-level="1">Our findings link additional companies, which remain active today, to the DPRK IT Workers scheme.</li>
</ul>
<h2>Background</h2>
<p>North Korea operates a global network of IT workers, both as individuals and under front companies, to evade sanctions and generate revenue for the regime. These workers are highly skilled in areas like software development, mobile applications, blockchain, and cryptocurrency technologies. By posing as professionals from other countries using fake identities and forged credentials, they secure remote jobs and freelance contracts with businesses worldwide.</p>
<p>Our PinnacleOne team has compiled an executive summary of this threat, <a href="https://www.sentinelone.com/blog/pinnacleone-execbrief-north-korean-it-worker-threat/" target="_blank" rel="noopener noreferrer">available here</a>.</p>
<p>Front companies, often based in China, Russia, Southeast Asia, and Africa, play a key role in masking the workers’ true origins and managing payments. Notable examples include China-based Yanbian Silverstar Network Technology Co. Ltd., <a href="https://www.justice.gov/opa/pr/justice-department-announces-court-authorized-action-disrupt-illicit-revenue-generation" target="_blank" rel="noopener noreferrer">disrupted in October 2023</a>, and Russia-based Volasys Silver Star, sanctioned by the U.S. Department of the Treasury <a href="https://home.treasury.gov/news/press-releases/sm481" target="_blank" rel="noopener noreferrer">in 2018</a>, for their roles in facilitating fraudulent IT operations. These entities helped DPRK workers launder earnings through online payment services and Chinese bank accounts. The payments, often routed through cryptocurrencies or shadow banking systems, ultimately support state programs, including weapons development, circumventing international sanctions.</p>
<p>These schemes present significant risks to employers, including potential legal violations, reputational damage, and insider threats such as intellectual property theft or malware implantation. Addressing these risks requires heightened awareness and stringent vetting processes to limit North Korea’s ability to exploit global tech markets.</p>
<p>This blog explores four newly identified examples of DPRK IT Worker front companies, analyzing their online presence and the methods they use to appear legitimate to unsuspecting targets in recent months. These four companies’ websites were recently subject to law enforcement action and taken offline.</p>
<h2>Independent Lab LLC</h2>
<p>The Independent Lab LLC website, <code>inditechlab[.]com</code> was active since at least February 2024, with indication it was acquired and operated using InterServer hosting since May 2022 (<code>174.138.181[.]198</code>). The domain itself was registered through NameCheap.</p>
<p>The content of the website is in line with what you would expect of a legitimate software development outsourcing business, with no obvious major indicators associated with the DPRK, or even illegitimate in any way. In the case of Independent Lab LLC, the website format and content was copied from Kitrum, a legitimate custom software firm headquartered in the United States. The DPRK actors did not retain the “We Stand with Ukraine” link or menu header.</p>
<figure id="attachment_109246" aria-describedby="caption-attachment-109246" style="width: 1412px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109246" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_13.jpg" alt="DPRK IT Worker Front Company Website - Independent Lab LLC" width="1412" height="947" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_13.jpg 1412w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_13-300x201.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_13-1024x687.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_13-768x515.jpg 768w" sizes="(max-width: 1412px) 100vw, 1412px" /><figcaption id="caption-attachment-109246" class="wp-caption-text">DPRK IT Worker Front Company Website &#8211; Independent Lab LLChot</figcaption></figure>
<figure id="attachment_109244" aria-describedby="caption-attachment-109244" style="width: 1391px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109244" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_15.jpg" alt="Legitimate business, source of copied website design used by DPRK" width="1391" height="1034" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_15.jpg 1391w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_15-300x223.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_15-1024x761.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_15-768x571.jpg 768w" sizes="(max-width: 1391px) 100vw, 1391px" /><figcaption id="caption-attachment-109244" class="wp-caption-text">Legitimate business, source of copied website design used by DPRK</figcaption></figure>
<p>The content of the website centered around the Contact Us form, enticing visitors to engage in communications, providing no contact details on the website itself.</p>
<h2>Shenyang Tonywang Technology LTD</h2>
<p>The name “Shenyang Tonywang Technology” was used in the formal content of the website; however, the domain itself is <code>tonywangtech[.]com</code>. The website first became active in November 2023, overlapping with previously used InterServer hosting infrastructure (<code>174.138.181[.]198</code>), and was also registered via NameCheap.</p>
<p>Similar to the previous example, Shenyang Tonywang Technology advertises itself as a top software consulting company with bespoke solutions, including DevOps &amp; cloud consulting. In this case, the website format and content was copied from Urolime, a legitimate DevOps consulting company headquartered in the United States.</p>
<figure id="attachment_109237" aria-describedby="caption-attachment-109237" style="width: 1506px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109237" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_4.jpg" alt="DPRK IT Worker Front Company Website - Shenyang Tonywang Technology LTD" width="1506" height="925" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_4.jpg 1506w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_4-300x184.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_4-1024x629.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_4-768x472.jpg 768w" sizes="(max-width: 1506px) 100vw, 1506px" /><figcaption id="caption-attachment-109237" class="wp-caption-text">DPRK IT Worker Front Company Website &#8211; Shenyang Tonywang Technology LTD</figcaption></figure>
<figure id="attachment_109235" aria-describedby="caption-attachment-109235" style="width: 1344px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109235" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_6.jpg" alt="Legitimate Urolime business, source of copied website design used by DPRK" width="1344" height="988" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_6.jpg 1344w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_6-300x221.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_6-1024x753.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_6-768x565.jpg 768w" sizes="(max-width: 1344px) 100vw, 1344px" /><figcaption id="caption-attachment-109235" class="wp-caption-text">Legitimate Urolime business, source of copied website design used by DPRK</figcaption></figure>
<h2>Tony WKJ LLC</h2>
<p>Tony WKJ LLC IT Services website, <code>wkjllc[.]com</code>, was active since at least May 2024, with indication it was acquired and operated using InterServer hosting (<code>174.138.181[.]198</code>) since May 2022. The domain itself was registered through NameCheap.</p>
<p>Tony WKJ LLC advertises itself as a leading software development company that specializes in Agile IT development. Once again, In this case the website format and content was copied from a legitimate business. Specifically, this website is a copy from  ArohaTech IT Services, a software and web development company headquartered in Noida, India.</p>
<p>However, a comparison to the legitimate website reveals that the DPRK actors have not only placed their own name, and removed original ArohaTech logos, they have also modified the content to clearly attempt to brand Tony WKJ LLC as a US based company.</p>
<figure id="attachment_109234" aria-describedby="caption-attachment-109234" style="width: 1392px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109234" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_7.jpg" alt="DPRK IT Worker Front Company Website - Tony WKJ LLC" width="1392" height="1158" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_7.jpg 1392w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_7-300x250.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_7-1024x852.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_7-768x639.jpg 768w" sizes="(max-width: 1392px) 100vw, 1392px" /><figcaption id="caption-attachment-109234" class="wp-caption-text">DPRK IT Worker Front Company Website &#8211; Tony WKJ LLC</figcaption></figure>
<figure id="attachment_109241" aria-describedby="caption-attachment-109241" style="width: 1390px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109241" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_18.jpg" alt="Legitimate business, source of copied website design used by DPRK" width="1390" height="1259" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_18.jpg 1390w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_18-300x272.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_18-1024x927.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_18-768x696.jpg 768w" sizes="(max-width: 1390px) 100vw, 1390px" /><figcaption id="caption-attachment-109241" class="wp-caption-text">Legitimate business, source of copied website design used by DPRK</figcaption></figure>
<h2>HopanaTech</h2>
<p>HopanaTech website, <code>hopanatech[.]com</code> is a bit more unique from the others above. The domain itself was first registered in November 2020, and began hosting publicly via Asia Web Services Ltd (<code>180.235.135[.]177</code>) in December 2020. The website has been presented as shown below since at least the end of 2021. The domain was registered through NameCheap.</p>
<p>The website content aligns with the previous examples, including the description of being a custom software development company. The HopanaTech version of the content has been modified significantly; however, it continued to make use of customer reviews and marketing content from legitimate public websites. However, in some cases, content that would have required more than a simple text edit remains unchanged, showing the original sources name, such as the legitimate ITechArt firm&#8217;s website.</p>
<figure id="attachment_109236" aria-describedby="caption-attachment-109236" style="width: 1527px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109236" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_5.jpg" alt="DPRK IT Worker Front Company Website - HopanaTech" width="1527" height="1036" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_5.jpg 1527w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_5-300x204.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_5-1024x695.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_5-768x521.jpg 768w" sizes="(max-width: 1527px) 100vw, 1527px" /><figcaption id="caption-attachment-109236" class="wp-caption-text">DPRK IT Worker Front Company Website &#8211; HopanaTech</figcaption></figure>
<figure id="attachment_109239" aria-describedby="caption-attachment-109239" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109239" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_2.jpg" alt="DPRK IT Worker Front Company Website - HopanaTech - Showing content source" width="1999" height="1020" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_2.jpg 1999w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_2-300x153.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_2-1024x523.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_2-768x392.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_2-1536x784.jpg 1536w" sizes="(max-width: 1999px) 100vw, 1999px" /><figcaption id="caption-attachment-109239" class="wp-caption-text">DPRK IT Worker Front Company Website &#8211; HopanaTech &#8211; Showing content source</figcaption></figure>
<h2>United States Government Response</h2>
<p>Each of the above four companies has been disrupted by US Government agencies, specifically the Department of Justice, Federal Bureau of Investigation, Homeland Security Investigations, Defense Criminal Investigative Service, and the United States Postal Inspection Service.</p>
<p>On October 10th, the US Government seized the four domains belonging to the front companies, each of which now shows the standard takedown alert and links to <a href="https://ofac.treasury.gov/media/923131/download?inline" target="_blank" rel="noopener noreferrer">the 2022 US Treasury fact sheet</a> on DPRKs IT Worker scheme. The websites rotate between English and Korean language versions.</p>
<figure id="attachment_109233" aria-describedby="caption-attachment-109233" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109233" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_8.jpg" alt="Domain Seized Alert - English" width="1999" height="1128" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_8.jpg 1999w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_8-300x169.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_8-1024x578.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_8-768x433.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_8-1536x867.jpg 1536w" sizes="(max-width: 1999px) 100vw, 1999px" /><figcaption id="caption-attachment-109233" class="wp-caption-text">Domain Seized Alert &#8211; English</figcaption></figure>
<figure id="attachment_109240" aria-describedby="caption-attachment-109240" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109240" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_19.jpg" alt="Domain Seized Alert - Korean" width="1999" height="1124" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_19.jpg 1999w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_19-300x169.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_19-1024x576.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_19-768x432.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_19-1536x864.jpg 1536w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_19-1600x900.jpg 1600w" sizes="(max-width: 1999px) 100vw, 1999px" /><figcaption id="caption-attachment-109240" class="wp-caption-text">Domain Seized Alert &#8211; Korean</figcaption></figure>
<h2>Expanded Analysis</h2>
<p>Drawing on details from the four companies disrupted by US Government agencies, SentinelLabs was able to find multiple leads to an active network of DPRK IT front companies originating in China.</p>
<h3>The Mysterious A1 Building</h3>
<p>In an early 2024 archived snapshot of Shenyang Tonywang Technology’s website, <code>tonywangtech[.]com</code>, we can see the actor added the following address:</p>
<p><i>No. 1006-25, Building A1, No. 11, Tawan Street, Huanggu District, Shenyang City Liaoning 110036</i></p>
<p><figure id="attachment_109248" aria-describedby="caption-attachment-109248" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109248" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_10.jpg" alt="tonywangtech[.]com listed address and contact details" width="1999" height="1022" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_10.jpg 1999w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_10-300x153.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_10-1024x524.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_10-768x393.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_10-1536x785.jpg 1536w" sizes="(max-width: 1999px) 100vw, 1999px" /><figcaption id="caption-attachment-109248" class="wp-caption-text">tonywangtech[.]com listed address and contact details</figcaption></figure>We identified an additional company with similar traits. First, the address happens to be highly close in proximity – listed next to each other on the same floor of the same building. <i>No. 1006-23, Building A1, No. 11, Tawan Street, Huanggu, Shenyang, Liaoning, China</i></p>
<p>The additional company is Shenyang Huguo Technology Ltd, which uses the domain <code>huguotechltd[.]com</code> in a similar way to the previous four. The website uses copied content and logos from the legitimate Indian software firm TatvaSoft.</p>
<figure id="attachment_109238" aria-describedby="caption-attachment-109238" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109238" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_3.jpg" alt="Active DPRK linked company website -Shenyang Huguo Technology Ltd" width="1999" height="1065" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_3.jpg 1999w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_3-300x160.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_3-1024x546.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_3-768x409.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_3-1536x818.jpg 1536w" sizes="(max-width: 1999px) 100vw, 1999px" /><figcaption id="caption-attachment-109238" class="wp-caption-text">Active DPRK linked company website -Shenyang Huguo Technology Ltd</figcaption></figure>
<p>The <code>huguotechltd[.]com</code> domain was registered in October 2023 via NameCheap. The domain has since been and continues to be hosted at <code>103.15.29[.]44</code>, of Asia Web Services Ltd.</p>
<p>We assess Shenyang Huguo Technology Ltd. is closely associated with the previously four reviewed DPRK IT Worker front companies, and had remained online long enough to have been used to achieve the DPRKs objectives.</p>
<h3>The Tony Wang Link</h3>
<p>HopanaTech’s website, <code>hopanatech[.]com</code>, listed three contacts before it was taken down by law enforcement. The first person, Wang Kejia, is listed with the email address “Tonywkj”.</p>
<figure id="attachment_109245" aria-describedby="caption-attachment-109245" style="width: 1058px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_14.jpg" alt="Contacts from the now-seized HopanaTech website" width="1058" height="738" class="size-full wp-image-109245" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_14.jpg 1058w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_14-300x209.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_14-1024x714.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_14-768x536.jpg 768w" sizes="(max-width: 1058px) 100vw, 1058px" /><figcaption id="caption-attachment-109245" class="wp-caption-text">Contacts from the now-seized HopanaTech website</figcaption></figure>
<p>The “wkj” is almost certainly the acronym for the preceding Chinese name, Wang Kejia. The <code>Tonywkj@Hopana</code> email address establishes a link between Wang Kejia, a real person who is a resident of the address in New Jersey and the “Tony Wang” identity. The Shenyang Tonywang Technology Company website discussed above was also subject to law enforcement action, and its name bears resemblance to the same Tongwkj listed by Hopana. Furthermore, the Tonywkj email also directly matches the domain of another taken-down DPRK IT Worker site discussed above, Tony WKJ LLC.</p>
<h3>The Tong Yuze Identity</h3>
<p>Law enforcement action established that Hopana Tech and <code>Hopanatech[.]com</code> are DRPK IT Worker Front companies. This analysis expands on the Hopana Tech company corporate registration data inside China.</p>
<p>A corporate records website from the PRC indicates the Beijing Xiwang Technology Company (北京市戏网科技有限公司), previously used the name Beijing Hou Pa Na Technology Company (北京后帕纳科技有限公司), a clear cognate for the English-translated “HopanaTech.”</p>
<figure id="attachment_109232" aria-describedby="caption-attachment-109232" style="width: 1838px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109232" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_9.jpg" alt="Corporate record showing Xiwang’s previous use of the Hopana Technology name" width="1838" height="556" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_9.jpg 1838w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_9-300x91.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_9-1024x310.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_9-768x232.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_9-1536x465.jpg 1536w" sizes="(max-width: 1838px) 100vw, 1838px" /><figcaption id="caption-attachment-109232" class="wp-caption-text">Corporate record showing Xiwang’s previous use of the Hopana Technology name</figcaption></figure>
<p>Furthermore, the above screenshot of HopanaTech’s website, which lists the Tonywkj email address, also lists Tong Yuze (佟雨泽). The same name is used for the corporate registrant of Beijing Xiwang Technology Company.Highlighted text shows that Beijing Xiwang Technology was previously known as Hopana Tech.</p>
<figure id="attachment_109247" aria-describedby="caption-attachment-109247" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109247" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_12.jpg" alt="Contacts from the now-seized HopanaTech website" width="1999" height="969" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_12.jpg 1999w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_12-300x145.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_12-1024x496.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_12-768x372.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_12-1536x745.jpg 1536w" sizes="(max-width: 1999px) 100vw, 1999px" /><figcaption id="caption-attachment-109247" class="wp-caption-text">Contacts from the now-seized HopanaTech website</figcaption></figure>
<p>As if to allay concerns that Beijing Xiwang Technology Company was not a front company, corporate records show the firm only pays unemployment insurance, health insurance, and employee injury liability insurance for one person.</p>
<figure id="attachment_109243" aria-describedby="caption-attachment-109243" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109243" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_16.jpg" alt="Corporate records for Bejing Xiwang Technology Company" width="1999" height="449" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_16.jpg 1999w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_16-300x67.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_16-1024x230.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_16-768x173.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_16-1536x345.jpg 1536w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_16-221x51.jpg 221w" sizes="(max-width: 1999px) 100vw, 1999px" /><figcaption id="caption-attachment-109243" class="wp-caption-text">Corporate records for Bejing Xiwang Technology Company</figcaption></figure>
<p>Tong Yuze is currently listed as the corporate registrant of 25 companies in China, including many restaurants and catering companies. Owing to increased data protection measures by the PRC, a complete accounting of Tong Yuze’s companies is not possible.</p>
<p>Some companies identified as Tong Yuze’s include:</p>
<ul>
<li>海口宜路畅佟科技贸易有限公司</li>
<li>北京上日清新食品有限公司</li>
<li>京山味诚（北京）餐饮管理有限公司</li>
<li>泽日启程（北京）餐饮管理有限公司</li>
<li>北京哈巴萨科贸有限公司</li>
</ul>
<p>This foray into restaurants does not appear to be a case of mistaken identity. The email provided for Tong Yuze on the registration of Beijing Xiwang Technology Company is <code>tongyuze@jswc[.]com[.]cn</code>. The email domain “JSWC” aligns with the name of some of Tong Yuze’s restaurant companies. In this case, Jing Shan Wei Cheng (京山味诚), matches the acronym of the email domain. This provides reasonable evidence of a legitimate connection between Tong Yuze and the mentioned food service companies.</p>
<p>Given the very real businesses being run by Tong Yuze’s other corporate registrations– seemingly many franchises of Yiwei Yicheng (一味一诚) –it’s possible this individual is serving as a cut-out for the DPRK. We hypothesize that his collection of businesses may serve to provide cover for illegal ones.</p>
<h3>The Haikou Yilu Changtong Technology Trading Company</h3>
<p>One of the companies connected to the Tong Yuze identity and accessible on corporate registration sites is Haikou Yilu Changtong Technology Trading Company (海口宜路畅佟科技贸易有限公司).</p>
<figure id="attachment_109249" aria-describedby="caption-attachment-109249" style="width: 1844px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="size-full wp-image-109249" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_1.jpg" alt="Haikou Yilu Changtong Technology Trading Company corporate registration" width="1844" height="472" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_1.jpg 1844w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_1-300x77.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_1-1024x262.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_1-768x197.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_1-1536x393.jpg 1536w" sizes="(max-width: 1844px) 100vw, 1844px" /><figcaption id="caption-attachment-109249" class="wp-caption-text">Haikou Yilu Changtong Technology Trading Company corporate registration</figcaption></figure>
<p>Haikou Yilu is distinct from the other Tong Yuze-registered companies for two reasons. First, it is another technology company–not a restaurant. Second, its corporate registration makes use of a telephone number that differs from Tong Yuze’s restaurant businesses but is shared with the Beijing Xiwang Technology Company corporate registration.</p>
<p>To help visualize the connections we described, the graphic below provides a simplified representation of the key relationships and pivots.</p>
<figure id="attachment_109242" aria-describedby="caption-attachment-109242" style="width: 1999px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="magnify" src="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK_IT_17.jpg" alt="Visual representation of front company connections" width="1999" height="1047" /><figcaption id="caption-attachment-109242" class="wp-caption-text">Visual representation of front company connections</figcaption></figure>
<h2>Conclusion</h2>
<p>The DPRK&#8217;s use of the IT Worker scheme underscores the regime&#8217;s adaptability in exploiting global markets to further its financial objectives. By impersonating legitimate U.S.-based software and technology consulting firms, North Korean actors aim to gain trust and access to sensitive contracts, circumventing sanctions and evading detection. These tactics highlight a deliberate and evolving strategy that leverages the global digital economy to fund state activities, including weapons development.</p>
<p>Our research not only exposes the deceptive tactics employed by DPRK IT workers but also connects these efforts to a broader, active network of front companies originating in China. This linkage emphasizes the scale and complexity of North Korea’s financial schemes and the importance of vigilance across industries. Organizations are urged to implement robust vetting processes, including careful scrutiny of potential contractors and suppliers, to mitigate risks and prevent inadvertent support of such illicit operations. By shedding light on these activities, SentinelLabs aims to equip businesses, governments, and the public with the insights needed to stay ahead of these threats and safeguard the integrity of global markets.</p>
]]></content:encoded>
					
		
		
		<enclosure url="https://www.sentinelone.com/wp-content/uploads/2024/11/DPRK-Front-v3-ftr.jpg" length="503118" type="image/jpeg" />	</item>
		<item>
		<title>BlueNoroff Hidden Risk &#124; Threat Actor Targets Macs with Fake Crypto News and Novel Persistence</title>
		<link>https://www.sentinelone.com/labs/bluenoroff-hidden-risk-threat-actor-targets-macs-with-fake-crypto-news-and-novel-persistence/</link>
		
		<dc:creator><![CDATA[Raffaele Sabato, Phil Stokes &amp; Tom Hegel]]></dc:creator>
		<pubDate>Thu, 07 Nov 2024 10:55:47 +0000</pubDate>
				<category><![CDATA[DPRK]]></category>
		<guid isPermaLink="false">https://www.sentinelone.com/?post_type=labs&#038;p=108328</guid>

					<description><![CDATA[SentinelLabs has observed a suspected DPRK threat actor targeting Crypto-related businesses with novel multi-stage malware.]]></description>
										<content:encoded><![CDATA[<h2>Executive Summary</h2>
<ul>
<li aria-level="1">SentinelLabs has observed a suspected DPRK threat actor targeting Crypto-related businesses with novel multi-stage malware.</li>
<li aria-level="1">We assess with high confidence that the same actor is responsible for earlier attacks attributed to BlueNoroff and the RustDoor/ThiefBucket and RustBucket campaigns.</li>
<li aria-level="1">SentinelLabs observed the use of a novel persistence mechanism abusing the Zsh configuration file <code>zshenv</code>.</li>
<li aria-level="1">The campaign, which we dubbed ‘Hidden Risk’, uses emails propagating fake news about cryptocurrency trends to infect targets via a malicious application disguised as a PDF file.</li>
</ul>
<h2>Overview</h2>
<p>Cryptocurrency-related businesses have been targets of North Korean-affiliated threat actors for some time now, with multiple campaigns aiming to steal funds and/or insert backdoor malware into targets. In April 2023, <a href="https://www.jamf.com/blog/bluenoroff-apt-targets-macos-rustbucket-malware/" target="_blank" rel="noopener noreferrer">researchers</a> detailed an APT campaign targeting macOS users with multi-stage malware that culminated in a Rust backdoor capable of downloading and executing further malware on infected devices. ‘RustBucket’, as they labeled it, was attributed with strong confidence to the BlueNoroff APT. In May 2023, ESET researchers discovered a second RustBucket variant targeting macOS users, followed by Elastic’s <a href="https://www.elastic.co/security-labs/DPRK-strikes-using-a-new-variant-of-rustbucket" target="_blank" rel="noopener noreferrer">discovery</a> in July that year of a third variant that included a LaunchAgent for persistence. In November 2023, Elastic also <a href="https://www.elastic.co/security-labs/elastic-catches-dprk-passing-out-kandykorn" target="_blank" rel="noopener noreferrer">reported</a> on another DPRK campaign targeting blockchain engineers of a crypto exchange platform with KandyKorn malware. Further analysis by SentinelLabs was able to <a href="https://www.sentinelone.com/blog/dprk-crypto-theft-macos-rustbucket-droppers-pivot-to-deliver-kandykorn-payloads/" target="_blank" rel="noopener noreferrer">connect</a> the KandyKorn and RustBucket campaigns.</p>
<p>In early September 2024, the FBI began <a href="https://www.ic3.gov/PSA/2024/PSA240903" target="_blank" rel="noopener noreferrer">warning</a> that North Korea was conducting “highly tailored, difficult-to-detect social engineering campaigns against employees of decentralized finance (&#8220;DeFi&#8221;), cryptocurrency, and similar businesses to deploy malware and steal company cryptocurrency”. Researchers from <a href="https://www.jamf.com/blog/jamf-threat-labs-observes-targeted-attacks-amid-fbi-warnings/" target="_blank" rel="noopener noreferrer">Jamf</a> subsequently followed up on this report a few weeks later detailing an attack attempt that deployed malware masquerading as a Visual Studio updater.</p>
<p>In October 2024, SentinelLabs observed a phishing attempt on a crypto-related industry that delivered a dropper application and a payload bearing many of the hallmarks of these previous attacks. We believe the campaign likely began as early as July 2024 and uses email and PDF lures with fake news headlines or stories about crypto-related topics. We dubbed this campaign ‘Hidden Risk’ and detail its operation and indicators of compromise below, including the use of a novel persistence mechanism abusing the zshenv configuration file.</p>
<h2>Infection Vector</h2>
<p>Initial infection is achieved via phishing email containing a link to a malicious application. The application is disguised as a link to a PDF document relating to a cryptocurrency topic such as “Hidden Risk Behind New Surge of Bitcoin Price”, “Altcoin Season 2.0-The Hidden Gems to Watch” and “New Era for Stablecoins and DeFi, CeFi”.</p>
<p>The emails hijack the name of a real person in an unrelated industry as a sender and purport to be forwarding a message from a well-known crypto social media influencer. In the case of the ‘Hidden Risk’ pdf, the threat actors copied a <a href="https://ijsra.net/sites/default/files/IJSRA-2024-1296.pdf" target="_blank" rel="noopener noreferrer">genuine research paper</a> entitled ‘Bitcoin ETF: Opportunities and risk’ by an academic associated with the University of Texas and hosted online by the International Journal of Science and Research Archive (IJSRA).</p>
<figure id="attachment_108341" aria-describedby="caption-attachment-108341" style="width: 1789px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_4.jpg" alt="The fake PDF displayed to targets (left) and the original source document hosted online (right)" width="1789" height="614" class="size-full wp-image-108341" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_4.jpg 1789w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_4-300x103.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_4-1024x351.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_4-768x264.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_4-1536x527.jpg 1536w" sizes="(max-width: 1789px) 100vw, 1789px" /><figcaption id="caption-attachment-108341" class="wp-caption-text">The fake PDF displayed to targets (left) and the original source document hosted online (right)</figcaption></figure>
<p>Unlike earlier campaigns attributed to BlueNoroff, the Hidden Risk campaign uses an unsophisticated phishing email that does not engage the recipient with contextually-relevant content, such as reference to personal or work-related information.</p>
<p>Also of note is that the sender domain in our observed incident, <code>kalpadvisory[.]com</code>, has been <a href="https://www.reddit.com/r/IndianStockMarket/comments/1c3rema/incessant_spam_calls_from_kalp_advisory_and_others/" target="_blank" rel="noopener noreferrer">noted</a> for spamming among online communities involved in the Indian stock market.</p>
<figure id="attachment_108336" aria-describedby="caption-attachment-108336" style="width: 1574px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_9.jpg" alt="Social media users complain about spam calls from Kalp Advisory" width="1574" height="1024" class="size-full wp-image-108336" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_9.jpg 1574w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_9-300x195.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_9-1024x666.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_9-768x500.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_9-1536x999.jpg 1536w" sizes="(max-width: 1574px) 100vw, 1574px" /><figcaption id="caption-attachment-108336" class="wp-caption-text">Social media users complain about spam calls from Kalp Advisory</figcaption></figure>
<p>The ‘open’ link in the phishing email hides a URL to another domain, <code>delphidigital[.]org</code>. The full URL currently serves a benign form of the Bitcoin ETF document with titles that differ over time. However, at some point, this URL has or does switch to serving the first stage of a malicious application bundle entitled ‘Hidden Risk Behind New Surge of Bitcoin Price.app’ (<code>3f17c5a7d1e7fd138163d8039e614b8a967a56cb</code>).</p>
<figure id="attachment_108345" aria-describedby="caption-attachment-108345" style="width: 1674px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_14.jpg" alt="Application icon for the Stage 1 dropper" width="1674" height="650" class="size-full wp-image-108345" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_14.jpg 1674w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_14-300x116.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_14-1024x398.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_14-768x298.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_14-1536x596.jpg 1536w" sizes="(max-width: 1674px) 100vw, 1674px" /><figcaption id="caption-attachment-108345" class="wp-caption-text">Application icon for the Stage 1 dropper</figcaption></figure>
<h2>First Stage | “Bait and Switch” Dropper Application Replaces PDF</h2>
<p>The first stage is a Mac application written in Swift displaying the same name as the expected PDF, “Hidden Risk Behind New Surge of Bitcoin Price.app”. The application bundle has the bundle identifier <code>Education.LessonOne</code> and contains a universal architecture (i.e., arm64 and x86-64) Mach-O executable named <code>LessonOne</code>.</p>
<p>The application bundle was signed and notarized on 19 October, 2024 with the Apple Developer ID “Avantis Regtech Private Limited (2S8XHJ7948)”. The signature has since been revoked by Apple.</p>
<figure id="attachment_108337" aria-describedby="caption-attachment-108337" style="width: 1892px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_8.jpg" alt="Code signing details for the Hidden Risk Behind New Surge of Bitcoin Price.app" width="1892" height="1004" class="size-full wp-image-108337" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_8.jpg 1892w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_8-300x159.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_8-1024x543.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_8-768x408.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_8-1536x815.jpg 1536w" sizes="(max-width: 1892px) 100vw, 1892px" /><figcaption id="caption-attachment-108337" class="wp-caption-text">Code signing details for the Hidden Risk Behind New Surge of Bitcoin Price.app</figcaption></figure>
<p>On launch, the application downloads the decoy “Hidden Risk” pdf file from a Google Drive share and opens it using the default macOS PDF viewer (typically Preview). Similar TTPs were previously reported by researchers at <a href="https://www.kandji.io/blog/todoswift-disguises-malware-download-behind-bitcoin-pdf" rel="noopener" target="_blank">Kandji</a> in August. The PDF is written into a temporary file before being moved to <code>/Users/Shared</code> using NSFileManager’s <a href="https://developer.apple.com/documentation/foundation/nsfilemanager/1414750-moveitematurl" target="_blank" rel="noopener noreferrer">moveItemAtURL:toURL:error</a> method.</p>
<p>The malware then downloads and executes a malicious x86-64 binary sourced from <code>matuaner[.]com</code> via a URL hard-coded into the Stage 1 binary. Since by default macOS won’t allow an application to download from an insecure HTTP protocol, the application’s <code>Info.plist</code> specifies this domain in the dictionary for its <a href="https://developer.apple.com/documentation/bundleresources/information_property_list/nsapptransportsecurity/" target="_blank" rel="noopener noreferrer">NSAppTransportSecurity</a> key and sets the <code>NSExceptionAllowsInsecureHTTPLoads</code> value to “true”.</p>
<figure id="attachment_108348" aria-describedby="caption-attachment-108348" style="width: 1200px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_11.jpg" alt="The Stage 1’s Info.plist adds the C2 domain as an exception for Apple’s App Transport Security settings" width="1200" height="646" class="size-full wp-image-108348" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_11.jpg 1200w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_11-300x162.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_11-1024x551.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_11-768x413.jpg 768w" sizes="(max-width: 1200px) 100vw, 1200px" /><figcaption id="caption-attachment-108348" class="wp-caption-text">The Stage 1’s <em>Info.plist</em> adds the C2 domain as an exception for Apple’s App Transport Security settings</figcaption></figure>
<p>The <code>Info.plist</code> also indicates that the application was built on a macOS 14.2 Sonoma machine but will run on both Intel and Apple silicon Macs with macOS 12 Monterey or later.</p>
<h2>Second Stage | ‘growth’ x86-64 Mach-O Backdoor</h2>
<p>The malicious binary downloaded by the first stage dropper is a single architecture Mach-O x86-64 executable (<code>7e07765bf8ee2d0b2233039623016d6dfb610a6d</code>), meaning that although the parent dropper will execute on both Intel and Apple silicon machines, the Stage 2 will only run on Intel architecture Macs or Apple silicon devices with the <a href="https://www.sentinelone.com/blog/why-your-macos-edr-solution-shouldnt-be-running-under-rosetta-2/" target="_blank" rel="noopener noreferrer">Rosetta emulation framework</a> installed. The binary, written in C++, has the name ‘growth’, weighs in at around 5.1 MB and is not code signed at all (SentinelLabs was able to share the file for researchers <a href="https://www.virustotal.com/gui/file/bd2aa5805b76f272b43a595b3d73e29d0fc4647e15e87950b8f904ea26dcf053/detection" rel="noopener" target="_blank">here</a>).</p>
<p>The executable contains a number of identifiable functions, which we outline below, with the overall objective being to act as a backdoor to execute remote commands.</p>
<figure id="attachment_108347" aria-describedby="caption-attachment-108347" style="width: 1638px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_12.jpg" alt="Some interesting functions in the &#039;growth&#039; binary" width="1638" height="516" class="size-full wp-image-108347" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_12.jpg 1638w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_12-300x95.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_12-1024x323.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_12-768x242.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_12-1536x484.jpg 1536w" sizes="(max-width: 1638px) 100vw, 1638px" /><figcaption id="caption-attachment-108347" class="wp-caption-text">Some interesting functions in the &#8216;growth&#8217; binary</figcaption></figure>
<p>On execution, the ‘growth’ binary performs the following actions.</p>
<ol>
<li aria-level="1">Calls the <code>sym.install_char__char_</code> function to install persistence. We discuss this in the next section.</li>
<li aria-level="1">Runs several commands to gather environmental information from the host and generate a random UUID of length 16. These commands include <code>sw_vers ProductVersion</code>, <code>sysctl hw.model</code> and <code>sysctl kern.boottime</code>.</li>
<li aria-level="1">Calculates the current date and time and performs <code>ps aux</code> to list running processes.</li>
<li aria-level="1">Sends the string “ci”, the random UUID and the gathered host data to a remote server using the <code>DoPost</code> function and awaits the C2 response.</li>
<li aria-level="1">Uses the <code>ProcessRequest</code> function to parse the response. If the first byte in the response is <b>0x31</b>, it sends the string “cs”, the random UUID and the value <b>-1</b> using <code>DoPost</code> and exits. If the first byte in the response is <b>0x30</b>, it executes the <code>SaveAndExec</code> function, sends the string “cs”, the random UUID and the value <b>0</b> using <code>DoPost</code>. The <code>SaveAndExec</code> function reads the C2 response, parses it, saves it into a random, hidden file at <code>/Users/Shared/.XXXXXX</code>, and executes it.<br />
<figure id="attachment_108346" aria-describedby="caption-attachment-108346" style="width: 1704px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_13.jpg" alt="The ProcessRequest function parses the C2 response" width="1704" height="608" class="size-full wp-image-108346" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_13.jpg 1704w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_13-300x107.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_13-1024x365.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_13-768x274.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_13-1536x548.jpg 1536w" sizes="(max-width: 1704px) 100vw, 1704px" /><figcaption id="caption-attachment-108346" class="wp-caption-text">The <em>ProcessRequest</em> function parses the C2 response</figcaption></figure></li>
<li aria-level="1">Sleeps for 60 seconds and starts the flow again from step 3.</li>
</ol>
<p>The <code>DoPost</code> function is used to make the HTTP Post request to the C2 using <code>libcurl</code>. The first argument is the C2 URL, the second argument is the data sent in the body of the POST request, and the third argument is the data pointer passed to the write callback.</p>
<figure id="attachment_108340" aria-describedby="caption-attachment-108340" style="width: 1258px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_5.jpg" alt="The DoPost function constructs and sends the http request" width="1258" height="1035" class="size-full wp-image-108340" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_5.jpg 1258w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_5-300x247.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_5-1024x842.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_5-768x632.jpg 768w" sizes="(max-width: 1258px) 100vw, 1258px" /><figcaption id="caption-attachment-108340" class="wp-caption-text">The <em>DoPost</em> function constructs and sends the HTTP request</figcaption></figure>
<p>We have previously <a href="https://www.sentinelone.com/blog/bluenoroff-how-dprks-macos-rustbucket-seeks-to-evade-analysis-and-detection/" target="_blank" rel="noopener noreferrer">noted</a> that this same User-Agent string, <code>mozilla/4.0 (compatible; msie 8.0; windows nt 5.1; trident/4.0)</code>, appeared in RustBucket malware in 2023. The User-Agent string also uses <code>cur1-agent</code> (using a 1 in place of the l in “curl”) as <a href="https://www.elastic.co/security-labs/DPRK-strikes-using-a-new-variant-of-rustbucket" target="_blank" rel="noopener noreferrer">reported</a> by Elastic, a fairly unique indicator we have not observed elsewhere.</p>
<p>We also see similarities in the way that earlier malware parsed the response from the C2, essentially comparing one of two values as decision logic between awaiting further response, exiting or reading and writing a remote command to file. The <code>ProcessRequest</code> function used for this purpose was also the name of an <a href="https://www.sentinelone.com/blog/dprk-crypto-theft-macos-rustbucket-droppers-pivot-to-deliver-kandykorn-payloads/" target="_blank" rel="noopener noreferrer">ObjCShellz</a> payload observed in a previous campaign.</p>
<p>The <code>SaveAndExec</code> function is responsible for executing any commands received from the C2. This function takes two parameters, the payload received and the length of the payload. The function parses the malicious payload and calculates indices related to the presence of the characters “#” and the “:”, receiving data from the C2 in the form <code>0#\0:command</code>.</p>
<figure id="attachment_108339" aria-describedby="caption-attachment-108339" style="width: 872px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_6.jpg" alt="SaveAndExec function parses the received script for embedded commands" width="872" height="580" class="size-full wp-image-108339" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_6.jpg 872w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_6-300x200.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_6-768x511.jpg 768w" sizes="(max-width: 872px) 100vw, 872px" /><figcaption id="caption-attachment-108339" class="wp-caption-text"><em>SaveAndExec</em> function parses the received script for embedded commands</figcaption></figure>
<p>Based on the calculated indices, it creates a random file name of length 6 and writes the received command as a hidden file to <code>/Users/Shared/.%s</code>. It then uses <code>chmod 0x777</code> to set the permissions of the file to world read, write and execute, and finally executes it via <code>popen</code>.</p>
<figure id="attachment_108338" aria-describedby="caption-attachment-108338" style="width: 1064px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_7.jpg" alt="The SaveAndExec function changes the file’s permissions and then executes it" width="1064" height="720" class="size-full wp-image-108338" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_7.jpg 1064w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_7-300x203.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_7-1024x693.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_7-768x520.jpg 768w" sizes="(max-width: 1064px) 100vw, 1064px" /><figcaption id="caption-attachment-108338" class="wp-caption-text">The <em>SaveAndExec</em> function changes the file’s permissions and then executes it</figcaption></figure>
<h2>Persistence via Zshenv</h2>
<p>The backdoor’s operation is functionally similar to previous malware attributed to this threat actor, but what makes it especially interesting is the persistence mechanism, which abuses the Zshenv configuration file.</p>
<p>Zshenv is one of several optional configuration files used by the Zsh shell. At the user level, it sits as a hidden file in the Home directory, <code>~/.zshenv</code>. A system wide version can also be located at <code>/etc/zshenv</code>. If it exists, the file is sourced for all Zsh sessions, including interactive and non-interactive shells, non-login shells and scripts. It is also read before all other Zsh startup files.</p>
<p>Interestingly, previous malware samples used by the same threat actor have referenced <a href="https://www.jamf.com/blog/jamf-threat-labs-observes-targeted-attacks-amid-fbi-warnings/" target="_blank" rel="noopener noreferrer">zsh_env</a> in their naming convention, but not actually used the mechanism. In an <a href="https://www.jamf.com/blog/jamf-threat-labs-observes-targeted-attacks-amid-fbi-warnings/" target="_blank" rel="noopener noreferrer">earlier campaign</a>, BlueNoroff used the <code>~/.zshrc</code> config file to achieve persistence. However, this is a less reliable form of persistence since the file is only sourced when a user launches an interactive Terminal session or subsession from an existing console.</p>
<p>Infecting the host with a malicious Zshenv file allows for a more powerful form of persistence. While this technique is not unknown, it is the first time we have observed it used in the wild by malware authors. It has particular value on modern versions of macOS since Apple <a href="https://www.sentinelone.com/blog/apples-macos-ventura-7-new-security-changes-to-be-aware-of/" target="_blank" rel="noopener noreferrer">introduced user notifications</a> for background Login Items as of macOS 13 Ventura. Apple’s notification aims to warn users when a persistence method is installed, particularly oft-abused LaunchAgents and LaunchDaemons. Abusing Zshenv, however, does not trigger such a notification in current versions of macOS.</p>
<p>In the binary, installation of the persistence mechanism is handled by the <code>sym.install_char__char_</code> function. The mechanism checks for a hidden touch file (zero byte) in the <code>/tmp/</code> folder called <code>.zsh_init_success</code>. If the file does not exist, then the &#8216;growth&#8217; binary is called and the touch file is created.</p>
<figure id="attachment_108343" aria-describedby="caption-attachment-108343" style="width: 1195px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_16.jpg" alt="Contents of the malicious ~/.zshenv, executed for every Zsh session" width="1195" height="281" class="size-full wp-image-108343" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_16.jpg 1195w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_16-300x71.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_16-1024x241.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_16-768x181.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_16-221x51.jpg 221w" sizes="(max-width: 1195px) 100vw, 1195px" /><figcaption id="caption-attachment-108343" class="wp-caption-text">Contents of the malicious <em>~/.zshenv</em>, executed for every Zsh session</figcaption></figure>
<h2>Network Infrastructure</h2>
<p>Analysis of the actor operated and controlled network infrastructure associated with the Hidden Risk campaign further corroborates our confidence in attribution to DPRK’s BlueNoroff threat actor. Additionally, infrastructure analysis provides new insight into an extensive cluster of activity over the last year plus, and provides further links to industry reporting mentioned above, and <a href="https://x.com/500mk500/status/1826552762995187893" target="_blank" rel="noopener noreferrer">others in the community</a>.</p>
<p>Over recent months, the actor has built a network of connected infrastructure often themed around their cryptocurrency interests, methods of delivering malware lures, and mimicking legitimate Web3, cryptocurrency, fintech, and investment organizations to appear legitimate. NameCheap is the predominant domain registrar being abused. Virtual server hosting services such as Quickpacket, Routerhosting, Hostwinds, and others are the most commonly used based on our observations.</p>
<p>Various methods of pivoting across network infrastructures and services can be used to connect the Hidden Risk campaign to domains themed around the following organizations, indicating the actors interest in potential targeting and spoofing for targeting on other organizations.</p>
<div style="overflow-x:auto;">
<table style="border-collapse: collapse; width: 100%; height: 120px;">
<tbody>
<tr style="height: 24px;">
<td style="width: 50.0%; height: 24px;">Cryptocurrency Technologies</td>
<td style="width: 50.0%; height: 24px;">Delphi Digital, Solana Labs, Douro Labs, bitsCrunch, Caladan</td>
</tr>
<tr style="height: 24px;">
<td style="width: 50.0%; height: 24px;">Investment and Capital Entities</td>
<td style="width: 50.0%; height: 24px;">Maelstrom Fund, Selini Capital, Flori Ventures, ARK Invest, Long Journey Ventures</td>
</tr>
<tr style="height: 24px;">
<td style="width: 50.0%; height: 24px;">Generic IT/Communication</td>
<td style="width: 50.0%; height: 24px;">Virtual Meetings (Zoom, generic), Software Updates (macOS, browsers, generic)</td>
</tr>
</tbody>
</table>
</div>
<p>When examining the infrastructure of the campaign detailed above in infrastructure analysis tools such as Validin, we can identify clear relations between the initial stage 1 delivery domain (<code>matuaner[.]com</code>) and the IPs <code>45.61.135[.]105</code> and <code>172.86.108[.]47</code>. These two IPs, in combination with an overlapping certificate use, link to a variety of domains that open the door to the larger and longer running history of BlueNoroff activity (green lines), and additional lesser confidence infrastructure to explore further (orange dotted lines).</p>
<figure id="attachment_108344" aria-describedby="caption-attachment-108344" style="width: 1220px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="magnify" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_15.jpg" alt="Pivoting from sample delivery to initial set of infrastructure" width="1220" height="1082" class="size-full wp-image-108344" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_15.jpg 1220w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_15-300x266.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_15-1024x908.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_15-768x681.jpg 768w" sizes="(max-width: 1220px) 100vw, 1220px" /><figcaption id="caption-attachment-108344" class="wp-caption-text">Pivoting from sample delivery to initial set of infrastructure</figcaption></figure>
<p>Additional valuable pivoting can be achieved by analyzing attributes like DNS TXT records linked to domains that the actor may be using for phishing email delivery. For instance, we’ve observed the actor abusing email marketing automation tools, such as Brevo, where they go so far as to verify domain ownership to <a href="https://help.brevo.com/hc/en-us/articles/12163873383186-Authenticate-your-domain-with-Brevo-Brevo-code-DKIM-record-DMARC-record" target="_blank" rel="noopener noreferrer">meet email authentication standards</a>—an effort to bypass spam and phishing detection filters.</p>
<figure id="attachment_108349" aria-describedby="caption-attachment-108349" style="width: 1016px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="magnify" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_10.jpg" alt="Pivoting initial infrastructure to wider set, though DNS TXT Records" width="1016" height="1048" class="size-full wp-image-108349" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_10.jpg 1016w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_10-291x300.jpg 291w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_10-993x1024.jpg 993w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_10-768x792.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_10-24x24.jpg 24w" sizes="(max-width: 1016px) 100vw, 1016px" /><figcaption id="caption-attachment-108349" class="wp-caption-text">Pivoting initial infrastructure to wider set, though DNS TXT Records</figcaption></figure>
<p>Beyond direct pivoting based on infrastructure and overlapping response data, we also identified additional domains registered using similar methods that reflect previous organization naming themes across various top level domains (TLDs), though these domains have not yet been linked to any known actor activity. For instance, by analyzing bulk domain search datasets, we found related but non-pivotable domains based on &#8220;Selini Capital,&#8221; such as <code>selinicapital[.]network</code>. This approach has proven effective in uncovering additional BlueNoroff domains linked to the Hidden Risk activity cluster.</p>
<p>Example Regular Expression: <code>/s+e+l+i+n+i+c+a+p+i+t+a+l+\.[a-z0-9-]+/</code></p>
<figure id="attachment_108350" aria-describedby="caption-attachment-108350" style="width: 1861px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_1.jpg" alt="Bulk domain scanning, past 180 days, showing registration summary" width="1861" height="1417" class="size-full wp-image-108350" srcset="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_1.jpg 1861w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_1-300x228.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_1-1024x780.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_1-768x585.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief_1-1536x1170.jpg 1536w" sizes="(max-width: 1861px) 100vw, 1861px" /><figcaption id="caption-attachment-108350" class="wp-caption-text">Bulk domain scanning, past 180 days, showing registration summary</figcaption></figure>
<p>The extensive collection of BlueNoroff infrastructure we&#8217;ve gathered over the years, recently expanded through the latest Hidden Risk campaign activity, prevents us from detailing every unique pivoting method as this actor continues to evolve. As with all quality threat intelligence, our goal is to aid defenders while carefully managing the exposure of our tracking techniques to the actor. However, we are sharing a broader set of associated infrastructure in the Indicator of Compromise section below.</p>
<h2>Conclusion</h2>
<p>Over the last 12 months or so, North Korean cyber actors have engaged in a series of campaigns against crypto-related industries, many of which involved extensive &#8216;grooming&#8217; of targets via social media. We observe that the Hidden Risk campaign diverts from this strategy taking a more traditional and cruder, though not necessarily any less effective, email phishing approach. Despite the bluntness of the initial infection method, other hallmarks of previous DPRK-backed campaigns are evident, both in terms of observed malware artifacts and associated network infrastructure, as discussed extensively throughout this post.</p>
<p>We might speculate that heightened attention on previous DRPK campaigns could have reduced the effectiveness of previous &#8216;social media grooming&#8217; attempts, perhaps as a result of intended targets in DeFi, ETF and other crypto-related industries becoming more wary, but it is equally likely that such state-backed threat actors have sufficient resources to pursue multiple strategies simultaneously.</p>
<p>One factor that is relatively consistent throughout many of these campaigns is that the threat actors are seemingly able to acquire or hijack valid Apple &#8216;identified developer&#8217; accounts at will, have their malware notarized by Apple, and bypass macOS Gatekeeper and other built-in Apple security technologies. In light of this and the general increase in macOS crimeware observed across the security industry, we encourage all macOS users, but particularly those in organizational settings, to harden their security and increase their awareness of potential risks.</p>
<h2>Indicators of Compromise</h2>
<div style="font-size:0.8em">
<div style="overflow-x:auto;">
<table style="border-collapse: collapse; width: 100%; height: 120px;">
<tbody>
<tr style="height: 24px;">
<td style="width: 55.0%; height: 24px;"><strong>SHA1</strong></td>
<td style="width: 15.0%; height: 24px;"><strong>Function</strong></td>
<td style="width: 15.0%; height: 24px;"><strong>File</strong></td>
<td style="width: 15.0%; height: 24px;"><strong>Arch</strong></td>
</tr>
<tr style="height: 24px;">
<td style="width: 55.0%; height: 24px;">05c178891ca1e65af53bbcfdbec573da3f74d176</td>
<td style="width: 15.0%; height: 24px;">Dropper</td>
<td style="width: 15.0%; height: 24px;">Macho</td>
<td style="width: 15.0%; height: 24px;">arm64</td>
</tr>
<tr style="height: 24px;">
<td style="width: 55.0%; height: 24px;">3f17c5a7d1e7fd138163d8039e614b8a967a56cb</td>
<td style="width: 15.0%; height: 24px;">Dropper</td>
<td style="width: 15.0%; height: 24px;">App</td>
<td style="width: 15.0%; height: 24px;">Universal</td>
</tr>
<tr style="height: 24px;">
<td style="width: 55.0%; height: 24px;">7e07765bf8ee2d0b2233039623016d6dfb610a6d</td>
<td style="width: 15.0%; height: 24px;">Backdoor</td>
<td style="width: 15.0%; height: 24px;">Macho</td>
<td style="width: 15.0%; height: 24px;">x86_64</td>
</tr>
<tr style="height: 24px;">
<td style="width: 55.0%; height: 24px;">baf4da6b89b7d7cbf24c9deef5984ef9dfd52e6a</td>
<td style="width: 15.0%; height: 24px;">Dropper</td>
<td style="width: 15.0%; height: 24px;">Macho</td>
<td style="width: 15.0%; height: 24px;">Universal</td>
</tr>
<tr style="height: 24px;">
<td style="width: 55.0%; height: 24px;">e5d97afa5f1501b3d5ec1a471dc8a3b8e2a84fdb</td>
<td style="width: 15.0%; height: 24px;">Dropper</td>
<td style="width: 15.0%; height: 24px;">Macho</td>
<td style="width: 15.0%; height: 24px;">x86_64</td>
</tr>
</tbody>
</table>
</div>
<p><b>IP Addresses</b><br />
23[.]254.253[.]75<br />
45[.]61.128[.]122<br />
45[.]61.135[.]105<br />
45[.]61.140[.]26<br />
139[.]99.66[.]103<br />
144[.]172.74[.]23<br />
144[.]172.74[.]141<br />
172[.]86.102[.]98<br />
172[.]86.108[.]47<br />
216[.]107.136[.]10</p>
<p><b>Domains</b><br />
analysis.arkinvst[.]com<br />
appleaccess[.]pro<br />
arkinvst[.]com<br />
atajerefoods[.]com<br />
buy2x[.]com<br />
calendly[.]caladan[.]video<br />
cardiagnostic[.]net<br />
cmt[.]ventures<br />
community.edwardcaputo[.]shop<br />
community.kevinaraujo[.]shop<br />
community.selincapital[.]com<br />
community.selincapital[.]com<br />
customer-app[.]xyz<br />
delphidigital[.]org<br />
doc.solanalab[.]org<br />
dourolab[.]xyz<br />
drogueriasanjose[.]net<br />
edwardcaputo[.]shop<br />
email.sellinicapital[.]com<br />
evalaskatours[.]com<br />
happyz[.]one<br />
hwsrv-1225327.hostwindsdns[.]com<br />
info.ankanimatoka[.]com<br />
info.customer-app[.]xyz<br />
kevinaraujo[.]shop<br />
maelstromfund[.]org<br />
maelstroms[.]fund<br />
matuaner[.]com<br />
mbupdate.linkpc[.]net<br />
mc.tvdhoenn[.]net<br />
meet.caladan[.]video<br />
meet.caladangroup[.]xyz<br />
meet.hananetwork[.]video<br />
meet.selinicapital[.]info<br />
meet.selinicapital[.]online<br />
meet.selinicapital[.]xyz<br />
meet.sellinicapital[.]com<br />
meeting.sellinicapital[.]com<br />
meeting.zoom-client[.]com<br />
mg21.1056[.]uk<br />
nodnote.com<br />
online.selinicapital[.]info<br />
online.zoom-client[.]com<br />
panda95sg[.]asia<br />
pixelmonmmo[.]net<br />
presentations[.]life<br />
selincapital[.]com<br />
selinicapital[.]info<br />
selinicapital[.]network<br />
selinicapital[.]online<br />
sellinicapital[.]com<br />
sendmailed[.]com<br />
sendmailer[.]org<br />
shh5.baranftw[.]xyz<br />
tvdhoenn[.]net<br />
verify.selinicapital[.]info<br />
versionupdate.dns[.]army<br />
www.buy2x[.]com<br />
www.delphidigital[.]org<br />
www.frameworks[.]ventures<br />
www.happyz[.]one<br />
www.huspot[.]blog<br />
www.maelstromfund[.]org<br />
www.panda95sg[.]asia<br />
www.prismlab[.]xyz<br />
www.sellinicapital[.]com<br />
www.sendmailed[.]com<br />
www.sendmailer[.]org<br />
www.yoannturp[.]xyz<br />
xu10.1056[.]uk<br />
zoom-client[.]com
</div>
]]></content:encoded>
					
		
		
		<enclosure url="https://www.sentinelone.com/wp-content/uploads/2024/11/BNThief-feature.jpg" length="376259" type="image/jpeg" />	</item>
		<item>
		<title>Cloud Malware &#124; A Threat Hunter&#8217;s Guide to Analysis, Techniques and Delivery</title>
		<link>https://www.sentinelone.com/labs/cloud-malware-a-threat-hunters-guide-to-analysis-techniques-and-delivery/</link>
		
		<dc:creator><![CDATA[Alex Delamotte]]></dc:creator>
		<pubDate>Thu, 24 Oct 2024 15:17:35 +0000</pubDate>
				<category><![CDATA[Malware Analysis]]></category>
		<guid isPermaLink="false">https://www.sentinelone.com/?post_type=labs&#038;p=107667</guid>

					<description><![CDATA[Learn about cloud threats, how to hunt for them and how to analyze them in this post based on Alex Delamotte's recent LABScon workshop.]]></description>
										<content:encoded><![CDATA[<p>As many researchers have noticed, malware in the cloud is different. Perhaps more strikingly different than Windows versus Linux threats, cloud services are targeted through entirely different methods altogether.</p>
<p>At <a href="https://www.labscon.io/" target="_blank" rel="noopener noreferrer">LABScon 2024</a>, I gave a workshop <a href="https://www.labscon.io/speakers/alex-delamotte/" target="_blank" rel="noopener noreferrer">Taxonomy in the Troposphere</a> that outlines categories of cloud threats and how to approach analyzing and hunting them. The workshop structure highlighted three general sections to approach this problem:</p>
<ul>
<li aria-level="1">What cloud malware looks like</li>
<li aria-level="1">Cloud malware taxonomy and exercises</li>
<li aria-level="1">How to approach threat hunting in the cloud</li>
</ul>
<h2>What Does Cloud Malware Look Like?</h2>
<p>Cloud threats are tailored for the specific environment or service being targeted. There are no comprehensive infostealers as are commonplace on platforms like macOS or Windows. Instead, individual facets of cloud security are targeted through a variety of means. Attackers run scripts remotely that interact with the targeted service’s API to achieve a goal like collecting credentials or automating the process of sending spam messages in bulk through a cloud or SaaS provider.</p>
<p>We covered several unique families of cloud threats, including <a href="https://www.sentinelone.com/labs/dissecting-alienfox-the-cloud-spammers-swiss-army-knife/" target="_blank" rel="noopener noreferrer">AlienFox</a>, a cloud spamming tool; <a href="https://www.sentinelone.com/labs/cloudy-with-a-chance-of-credentials-aws-targeting-cred-stealer-expands-to-azure-gcp/" target="_blank" rel="noopener noreferrer">TeamTNT’s</a> credential harvesting scripts; and <a href="https://www.cadosecurity.com/blog/cado-discovers-denonia-the-first-malware-specifically-targeting-lambda" target="_blank" rel="noopener noreferrer">Denonia</a>, a cryptominer tailored to run in AWS serverless Lambda environment.</p>
<p>We also explored the objectives of cloud attacks. These are less distinct from threats targeting any other attack surface, including:</p>
<ul>
<li aria-level="1">Cryptomining</li>
<li aria-level="1">Spamming</li>
<li aria-level="1">Data theft</li>
<li aria-level="1">Espionage</li>
<li aria-level="1">Extortion</li>
<li aria-level="1">Disruption, attacks on availability</li>
</ul>
<p>Cloud threat delivery and installation is also different. Actors frequently rely on web application or SaaS misconfigurations that enable access to resources that should be restricted.</p>
<p>Examples of this include exposed environment files–a very common occurrence in <a href="https://cheatsheetseries.owasp.org/cheatsheets/Laravel_Cheat_Sheet.html" target="_blank" rel="noopener noreferrer">Laravel</a> implementation–as well as exposed <a href="https://0x1bitcrack3r.medium.com/how-i-found-misconfigured-jenkins-instances-of-different-organizations-using-shodan-9837088f4ec7" target="_blank" rel="noopener noreferrer">Jenkins</a> instances. Exploitation of unpatched security vulnerabilities is perennially popular given the high prevalence of web frameworks running in cloud services.</p>
<p>Credential exposure is a huge problem: organizations often unknowingly upload service credentials to publicly accessible code sharing services like Docker Hub, GitHub, or Pastebin, as outlined in a recent <a href="https://cybenari.com/2024/08/whats-the-worst-place-to-leave-your-secrets/" target="_blank" rel="noopener noreferrer">post</a> by Cybenari, which explores how long it takes for actors to identify and use the credentials.</p>
<p>My colleagues at SentinelOne recently published an excellent <a href="https://www.sentinelone.com/blog/cloud-and-container-the-attack-defend-series/" target="_blank" rel="noopener noreferrer">summary</a> of the most commonly leveraged cloud threat vectors, which complimented this workshop’s focus.</p>
<h2>Cloud Malware Taxonomy &amp; Analysis</h2>
<p>Taxonomy in the cloud can be difficult because many tools are based on full source code and actors often take a feature from one tool and roll it into another one. This makes attribution complicated, if not challenging. Because these tools are not deployed on the victim machine and are run on the attacker’s system, it can be unclear which tool used the code first.</p>
<p>Cloud researchers often obtain samples from sources like VirusTotal, Pastebin, or from cybercriminal forums or Telegram channels. Unlike threats that target endpoints, which typically drop binaries or scripts that run in memory, threats running against cloud services leave only logs showing which APIs were called and in which order. While these can be valuable indicators for detection, they leave much to be desired in the way of seeing how actors implement their tooling.</p>
<p>Analyzing cloud tools can be complex because some scripts are very large. I have analyzed several scripts with more than 10,000 lines of code. To make this task more manageable, researchers can take several approaches.</p>
<p>One of my preferred methods is to perform a word frequency analysis that eliminates terms commonly used by the programming language of the script, revealing terms that are used highly frequently or infrequently. These outliers can provide strategic analytic starting points by highlighting terms that the tool focuses on, such as APIs, technologies, or credential categories.</p>
<p>I use a Python script designed to analyze Python files for the occurrence of each term. The script reads the contents of the target file, filters out common terms used by the Python programming language, and writes output showing how many times each remaining term occurs.</p>
<p>Running this script against a modified version of <a href="https://www.cadosecurity.com/blog/legion-an-aws-credential-harvester-and-smtp-hijacker" target="_blank" rel="noopener noreferrer">Legion Stealer</a> attributed to actor CobraEgy was quite helpful in reducing the volume of noise. The CobraEgy script contains more than 21,000 lines of Python code–a very daunting analysis task. The word frequency analysis script gave 3400 lines of words and the frequency they occurred. While this is still large, it’s easy to scroll through the results and find interesting terms.</p>
<p>In the following output, around line 40 there are many terms that show the tool capabilities likely include spamming (<code>mailuser</code>, <code>mailport</code>, <code>mailfrom</code>, <code>host</code>, <code>get_smtp</code>, <code>smtp_login</code>), web server activity (<code>apache</code>), and cloud service activity (<code>aws_reg</code>, <code>aws_key</code>).</p>
<figure id="attachment_107676" aria-describedby="caption-attachment-107676" style="width: 205px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_6.jpg" alt="Word frequency analysis output from CobraEgy tool" width="205" height="499" class="size-full wp-image-107676" srcset="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_6.jpg 205w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_6-123x300.jpg 123w" sizes="(max-width: 205px) 100vw, 205px" /><figcaption id="caption-attachment-107676" class="wp-caption-text">Word frequency analysis output from CobraEgy tool</figcaption></figure>
<p>Once you identify potentially interesting functionality, you can analyze those features. In the workshop,  participants were able to dive into commonly referenced cloud tool terms, such as <code>aws</code>, <code>azure</code>, <code>profile</code>, <code>admin</code>, <code>password</code>, <code>server</code>, <code>host</code>, <code>username</code>, and <code>port</code>.</p>
<p>Looking at how these terms are used can provide insight into the tool’s capability and even yield valuable indicators of compromise that can be used to categorize the tool or an actor’s campaign. This approach is helpful when looking at many scripts at once, as you can run it as a grep command against an entire directory:</p>
<pre>
grep -RinE --include=\*.{py,sh} '\b(aws|azure|profile|admin|password|server|host|username|port)\b' /path/to/search
</pre>
<p>For simplicity, I asked students to run against only one of the malicious scripts. The following results from a TeamTNT shell script revealed interesting clues to the tool’s capability, such as credential files, cloud service provider capabilities, and hardcoded credentials to connect to an external server.</p>
<figure id="attachment_107679" aria-describedby="caption-attachment-107679" style="width: 988px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_3.jpg" alt="Keyword search against TeamTNT shell script" width="988" height="273" class="size-full wp-image-107679" srcset="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_3.jpg 988w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_3-300x83.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_3-768x212.jpg 768w" sizes="(max-width: 988px) 100vw, 988px" /><figcaption id="caption-attachment-107679" class="wp-caption-text">Keyword search against TeamTNT shell script</figcaption></figure>
<p>Researchers can then cross-reference the search results against the original script, revealing its functionality. In this case, the <code>azure.json</code> hit was part of a larger credential file targeting list. The hardcoded username and password were used to connect to a C2 server to upload the data harvested from the system.</p>
<figure id="attachment_107674" aria-describedby="caption-attachment-107674" style="width: 841px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_8.jpg" alt="Credential files targeted by TeamTNT shell script" width="841" height="116" class="size-full wp-image-107674" srcset="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_8.jpg 841w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_8-300x41.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_8-768x106.jpg 768w" sizes="(max-width: 841px) 100vw, 841px" /><figcaption id="caption-attachment-107674" class="wp-caption-text">Credential files targeted by TeamTNT shell script</figcaption></figure>
<figure id="attachment_107673" aria-describedby="caption-attachment-107673" style="width: 469px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_9.jpg" alt="Function used to send data to the C2 server" width="469" height="94" class="size-full wp-image-107673" srcset="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_9.jpg 469w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_9-300x60.jpg 300w" sizes="(max-width: 469px) 100vw, 469px" /><figcaption id="caption-attachment-107673" class="wp-caption-text">Function used to send data to the C2 server</figcaption></figure>
<p>We also took a high level look at a Docker container that was used in TeamTNT’s 2023 SilentBob <a href="https://www.aquasec.com/blog/teamtnt-reemerged-with-new-aggressive-cloud-campaign/" target="_blank" rel="noopener noreferrer">campaign</a>. Docker containers are composed of layers: the container’s operating system is in the first layer, while subsequent layers are generated by instructions in the Dockerfile.</p>
<p><a href="https://www.docker.com/products/docker-desktop/" target="_blank" rel="noopener noreferrer">Docker Desktop</a> is a free tool that provides a nice interface for high-level analysis of a container’s features. Researchers can select the Docker image on the Images tab, then look at the layers. In the case of this container used by TeamTNT, there are 9 layers. Several layers have a command, which is shown on the Command pane.</p>
<figure id="attachment_107680" aria-describedby="caption-attachment-107680" style="width: 570px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_2.jpg" alt="Docker layer showing tool installation commands" width="570" height="175" class="size-full wp-image-107680" srcset="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_2.jpg 570w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_2-300x92.jpg 300w" sizes="(max-width: 570px) 100vw, 570px" /><figcaption id="caption-attachment-107680" class="wp-caption-text">Docker layer showing tool installation commands</figcaption></figure>
<p>The container used in this attack is initialized, then downloads <code>zgrab</code>, a network scanning utility that TeamTNT uses to identify new systems to infect. Next, the container installs several utilities:</p>
<ul>
<li aria-level="1"><code>tor</code>: a binary that enables routing requests through the Tor anonymization network</li>
<li aria-level="1"><code>curl</code>, <code>wget</code>: utilities for creating HTTP requests</li>
<li aria-level="1"><code>libproxychains3</code>: enables routing connections through proxy servers for anonymity</li>
<li aria-level="1"><code>masscan</code>: network scanning utility used to identify new targets</li>
</ul>
<p>These tools are used for identifying new victims and propagating the actor’s tools. The container also extracts several files from the base image, which are saved locally to the <code>/usr/bin</code> path and given read, write, and execute permissions. Researchers can mount the image–which I recommend doing in an isolated malware analysis environment–and copy the files to the local system for analysis.</p>
<h2>Hunting in the Cloud</h2>
<p>The workshop concluded by summarizing which artifacts from cloud tools can be hunted, as well as two types of hunting approaches: targeted and wide.</p>
<p>A targeted hunting approach searches for specific indicators that are unique to a cloud threat family, such as Androxgh0st, FBot, or TeamTNT tools. For example, the following Androxgh0st strings are from unique variables recycled across many tools, including AlienFox:</p>
<figure id="attachment_107678" aria-describedby="caption-attachment-107678" style="width: 1004px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_4.jpg" alt="Targeted VirusTotal Livehunt rule searching for Androxgh0st strings" width="1004" height="214" class="size-full wp-image-107678" srcset="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_4.jpg 1004w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_4-300x64.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_4-768x164.jpg 768w" sizes="(max-width: 1004px) 100vw, 1004px" /><figcaption id="caption-attachment-107678" class="wp-caption-text">Targeted VirusTotal Livehunt rule searching for Androxgh0st strings</figcaption></figure>
<p>In the following example from FBot, the tool makes requests to a Lithuanian fashion designer’s website–<code>robertkalinkin[.]com</code>–to validate Paypal accounts. Interestingly, this Paypal validator is also used by other cloud attack tools, including <a href="https://permiso.io/blog/s/legion-mass-spam-attacks-in-aws/" target="_blank" rel="noopener noreferrer">Legion Stealer</a>.</p>
<p>Due to the Python code containing special characters that escape the string, I opted to use the hexadecimal equivalent of the variable and its contents, as shown in the comment below.</p>
<figure id="attachment_107677" aria-describedby="caption-attachment-107677" style="width: 1276px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_5.jpg" alt="Targeted VirusTotal Livehunt rule searching for a Paypal validator URL" width="1276" height="250" class="size-full wp-image-107677" srcset="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_5.jpg 1276w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_5-300x59.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_5-1024x201.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_5-768x150.jpg 768w" sizes="(max-width: 1276px) 100vw, 1276px" /><figcaption id="caption-attachment-107677" class="wp-caption-text">Targeted VirusTotal Livehunt rule searching for a Paypal validator URL</figcaption></figure>
<p>The wide hunting approach looks for behavior, so researchers can identify new malware families conducting specific activities. Wide hunting rules that I have written search for scripts on VirusTotal that exhibit sets of behaviors, like references to Kubernetes and binaries associated with downloading additional payloads, such as <code>wget</code>. The rule also filters for script file types, which are more likely to be associated with cloud attack tools.</p>
<figure id="attachment_107681" aria-describedby="caption-attachment-107681" style="width: 1736px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_1.jpg" alt="Wide VirusTotal Livehunt rule searching for terms related to Kubernetes and download activity" width="1736" height="406" class="size-full wp-image-107681" srcset="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_1.jpg 1736w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_1-300x70.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_1-1024x239.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_1-768x180.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_1-1536x359.jpg 1536w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_1-221x51.jpg 221w" sizes="(max-width: 1736px) 100vw, 1736px" /><figcaption id="caption-attachment-107681" class="wp-caption-text">Wide VirusTotal Livehunt rule searching for terms related to Kubernetes and download activity</figcaption></figure>
<p>Another wide hunting rule looks for references to popular cloud service providers (CSP) and URLs for Telegram channels. This combination indicates that the tool is conducting suspicious behavior by nature of using Telegram and that it is cloud focused by referencing a CSP. Wide hunting rules often generate much noise, and the CSP Telegram rule was no exception.</p>
<p>To minimize noise from files referencing the Dawson Creek time zone in British Columbia, I added the <code>$negate1</code> variable, which excludes results when the <code>Dawson</code> string is referenced.</p>
<figure id="attachment_107675" aria-describedby="caption-attachment-107675" style="width: 1836px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_7.jpg" alt="Wide VirusTotal Livehunt rule searching for references to CSPs and Telegram" width="1836" height="582" class="size-full wp-image-107675" srcset="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_7.jpg 1836w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_7-300x95.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_7-1024x325.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_7-768x243.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud_Mw_Analysis_7-1536x487.jpg 1536w" sizes="(max-width: 1836px) 100vw, 1836px" /><figcaption id="caption-attachment-107675" class="wp-caption-text">Wide VirusTotal Livehunt rule searching for references to CSPs and Telegram</figcaption></figure>
<h2>Conclusion</h2>
<p>In this workshop at <a href="https://www.labscon.io/" rel="noopener" target="_blank">LABScon24</a>, I provided aspiring cloud researchers with several approaches that they can use as an entry point into cloud threat research and hunting. Using the Word Frequency Analysis approach is extremely helpful for analyzing huge scripts with thousands of lines of code. Similarly, the targeted keyword approach helps identify areas of a script that perform crucial cloud-centric activities. A similar approach could be used to identify CSP APIs when searching for a specific action. For investigations involving a container that is not running in a live environment, Docker Desktop remains a solid starting point to identify features of the container and to extract details that provide insight into the container’s capabilities.</p>
<p>Threat hunting in the cloud is different from hunting binaries, as many malware researchers primarily do. The workshop outlined my approach to hunting several cloud threat families by using unique strings, such as Telegram handles or variable names, that frequently reoccur across these tools. The broad threat hunting approach can be noisy and time-consuming, but it has yielded many new findings that may have otherwise gone unseen.</p>
<hr>
<p>Interested in attending or presenting at LABScon25? <strong>Learn more <a href="https://labscon.io" rel="noopener" target="_blank">here</a>.</strong></p>
]]></content:encoded>
					
		
		
		<enclosure url="https://www.sentinelone.com/wp-content/uploads/2024/10/Cloud-Workshop-blue-ftr.jpg" length="391115" type="image/jpeg" />	</item>
		<item>
		<title>China’s Influence Ops &#124; Twisting Tales of Volt Typhoon at Home and Abroad</title>
		<link>https://www.sentinelone.com/labs/chinas-influence-ops-twisting-tales-of-volt-typhoon-at-home-and-abroad/</link>
		
		<dc:creator><![CDATA[Dakota Cary]]></dc:creator>
		<pubDate>Wed, 16 Oct 2024 14:23:52 +0000</pubDate>
				<category><![CDATA[China]]></category>
		<guid isPermaLink="false">https://www.sentinelone.com/?post_type=labs&#038;p=107173</guid>

					<description><![CDATA[China's CVERC attempts to attribute Volt Typhoon activities to the U.S., but the fact-free claims reveal much about the PRC's real agenda.]]></description>
										<content:encoded><![CDATA[<h2>Executive Summary</h2>
<ul>
<li aria-level="1">The latest CVERC report reflects China&#8217;s ongoing efforts to undermine support for U.S. surveillance activities by attempting to fuel debate over Section 702.</li>
<li aria-level="1">The CVERC report also draws Microsoft into its crosshairs as part of an ongoing push to remove foreign technology from PRC government systems.</li>
<li aria-level="1">The report highlights previous intelligence from France and Germany regarding U.S spying in an attempt to deflect attention away from recent incidents of Chinese espionage in Europe, likely as a means to shape narratives amid ongoing political debates.</li>
</ul>
<h2>Introduction</h2>
<p>China’s Computer Virus Emergency Response Center has released part three of a running series claiming that the U.S. government is actually behind Volt Typhoon activity, rather than China. <a href="https://www.globaltimes.cn/page/202410/1321156.shtml" target="_blank" rel="noopener noreferrer">The latest CVERC report</a>, whose front page includes an oddly edited photo with the text “Lie to Me,” provides no new evidence of these claims and rehashes old leaked U.S. intelligence documents. However, this CVERC report is not useless.</p>
<p>The CVERC report tells us more about China’s intentions than it does convince readers of the PRC’s claims about Volt Typhoon. <a href="https://www.sentinelone.com/labs/chinas-cyber-revenge-why-the-prc-fails-to-back-its-claims-of-western-espionage/" target="_blank" rel="noopener noreferrer">SentinelLabs has previously covered the CVERC’s behavior</a> and is issuing this report to update readers with specific takeaways based on the content of the third edition.</p>
<p>In our first report, we highlighted a pattern of coordination between China’s cybersecurity companies, state media, the CVERC, and publications about U.S. hacking operations. We find that the pattern is thus: a cybersecurity company publishes a new report analyzing old leaked documents from the U.S. government, the CVERC picks up the piece and adds analysis–or in many cases, co-authors the report with the company–then state media regurgitate the report in English for international audiences.</p>
<p>In some cases, these reports make their way into official PRC government press briefings. In one instance, a PRC embassy abroad re-hosted the report’s content. It is a full court-press to point the finger at U.S. hacking efforts without providing new or substantiated claims.</p>
<p>It is clear that such efforts are state-directed, not merely by association of the organizations involved, but by the steady recurring drumbeat of publications. However, such a directive to produce more when there is nothing to be written is hard for writers and researchers. When writers are forced to fill a page count, they inevitably drift towards their own intentions as evidence of their claims run dry. The CVERC’s latest report falls victim to this trap.</p>
<p>What follows is our distillation of what we believe analysts can learn from the latest CVERC report about China’s posture in geopolitics, cybersecurity, and hacking operations.</p>
<h2>Targeting Section 702</h2>
<p>The authors mention <a href="https://www.intel.gov/foreign-intelligence-surveillance-act/1237-fisa-section-702" target="_blank" rel="noopener noreferrer">Section 702</a> authorities 13 times across 60 pages, and it is a clear focal point. Compromised devices in the U.S. and abroad constitute the botnets that Chinese operations rely on for obfuscation. Section 702 very likely enables U.S. collection of Chinese activities on these devices that are located in the US. Without Section 702, tracking Chinese hacking operations would be very difficult.</p>
<p>However, Section 702 in the United States is controversial. Reviving the 702 debate is clearly in China’s interest and is their intent, as shown by how China highlighted “impacts to ordinary Americans.” No doubt that China hopes a policy move against potent U.S. counterintelligence tools would be in its interest. Will PRC influence ops push such narratives? Already, The Register’s cybersecurity editor <a href="https://www.theregister.com/2024/02/09/fbi_volt_typhoon_section_702/" target="_blank" rel="noopener noreferrer">wrote a piece</a> arguing the line that China clearly hoped to promote–that Volt Typhoon is an excuse to continue Section 702.</p>
<p>The CVERC publication may be motivated by previous potential Russian successes in changing U.S. policy. Following Russian abuse of leaked NSA vulnerabilities and tools that caused massive economic losses (NotPetya), the U.S. policy community debated the curtailing of these tools. Committees held public hearings and the DNI suggested that if the U.S. could not control such capabilities, perhaps they should not be developed.</p>
<p>This period coincides with what Ben Buchanan notes as the <a href="https://www.hoover.org/sites/default/files/research/docs/buchanan_webreadypdf.pdf" target="_blank" rel="noopener noreferrer">end of the NOBUS era</a>. The result of Russia’s operations, which were cemented by DPRK bumbling a global ransom op (WannaCry), was the creation of the Vulnerabilities Equities Process (VEP), a process through which the majority of U.S. vulnerabilities discovered are burned and given to their manufacturer. China may hope to achieve a sunset to 702, just as the Russians—intentionally or not—instigated the VEP.</p>
<h2>Pushing Foreign Tech Out of China</h2>
<p>The CVERC report also draws Microsoft into its crosshairs and tracks the movement of former U.S. government officials to MSFT-related entities. Underpinning CVERC’s concern is <a href="https://www.wsj.com/world/china/china-technology-software-delete-america-2b8ea89f" target="_blank" rel="noopener noreferrer">CCP Document Number 79</a>, which pushes for the removal of all foreign technology from PRC government systems. China’s efforts to create its own tech ecosystem, including a domestic operating system, epitomize the effort. CVERC is in no position to signal intent about stopping MSFT’s operations in China.</p>
<p>Still, the report suggests the organization is emboldened in its stance on the company. More sure of itself than ever, the CCP seems ready to hit foreign firms that have long remained key IT providers in its ecosystem. Eventually, successful implementation of Document 79 will push MSFT almost entirely from the PRC technology ecosystem.</p>
<h2>Shifting the Narrative in Europe</h2>
<p>Finally, the CVERC’s mentions of France and Germany arrived at a time of <a href="https://www.gmfus.org/news/watching-china-europe-september-2024" target="_blank" rel="noopener noreferrer">intense infighting over the future of Europe and its relationship with China</a>. Until recently, German and French firms had been making hay of U.S. firms leaving the PRC. Buying assets on discount and doubling down with its in-country partners. Now, the sands are shifting.</p>
<p><a href="https://www.bbc.com/news/world-europe-68873836" target="_blank" rel="noopener noreferrer">Germany arrested Chinese spies</a> earlier this year. The Dutch <a href="https://www.ncsc.nl/binaries/ncsc/documenten/publicaties/2024/februari/6/mivd-aivd-advisory-coathanger-tlp-clear/TLP-CLEAR+MIVD+AIVD+Advisory+COATHANGER.pdf" target="_blank" rel="noopener noreferrer">publicly attributed hacking campaigns to China</a>. In France, the police stopped <a href="https://www.lemonde.fr/en/france/article/2024/07/03/france-asks-two-chinese-spies-to-leave-after-attempt-to-forcibly-repatriate-man_6676591_7.html" target="_blank" rel="noopener noreferrer">Chinese diplomats from forcibly repatriating a dissident</a> and asked two PRC spies to leave the country. Who knows what happens behind closed doors in Brussels, but suffice to say that the CVERC doesn’t like what it sees in public.</p>
<p>Highlighting what those governments already know about past leaks of USG/FVEY spying is likely aimed at shaping narratives, but says more about CVERC’s intent than anything the report may achieve.</p>
<p>As usual, and as SentinelLabs has <a href="https://www.sentinelone.com/labs/chinas-cyber-revenge-why-the-prc-fails-to-back-its-claims-of-western-espionage/" target="_blank" rel="noopener noreferrer">previously</a> written, the report is paired with propaganda coverage but, for the first time, has also been published in Japanese, French, and German, in addition to English and Chinese.</p>
]]></content:encoded>
					
		
		
		<enclosure url="https://www.sentinelone.com/wp-content/uploads/2024/10/china-influence-feature.jpg" length="326838" type="image/jpeg" />	</item>
		<item>
		<title>Kryptina RaaS &#124; From Unsellable Cast-Off to Enterprise Ransomware</title>
		<link>https://www.sentinelone.com/labs/kryptina-raas-from-unsellable-cast-off-to-enterprise-ransomware/</link>
		
		<dc:creator><![CDATA[Jim Walter]]></dc:creator>
		<pubDate>Mon, 23 Sep 2024 10:00:00 +0000</pubDate>
				<category><![CDATA[Ransomware]]></category>
		<guid isPermaLink="false">https://www.sentinelone.com/?post_type=labs&#038;p=105715</guid>

					<description><![CDATA[Kryptina's adoption by Mallox affiliates complicates malware tracking as ransomware operators blend different codebases into new variants.]]></description>
										<content:encoded><![CDATA[<h2>Executive Summary</h2>
<ul>
<li aria-level="1">Kryptina evolved from a free tool on public forums to being actively used in enterprise attacks, particularly under the Mallox ransomware family.</li>
<li aria-level="1">In May 2024, a Mallox affiliate leaked staging server data, revealing that their Linux ransomware was based on a modified version of Kryptina.</li>
<li aria-level="1">The affiliate made superficial changes to source code and documentation, stripping Kryptina branding but retaining core functionality.</li>
<li aria-level="1">The adoption of Kryptina by Mallox affiliates exemplifies the commoditization of ransomware tools, complicating malware tracking as affiliates blend different codebases into new variants.</li>
<li aria-level="1">This original research was presented by the author at <a href="https://labscon.io" target="_blank" rel="noopener noreferrer">LABScon 2024</a> in Scottsdale, Arizona.</li>
</ul>
<h2>Background</h2>
<p>In February of 2024, SentinelOne posted a <a href="https://www.sentinelone.com/blog/kryptina-raas-from-underground-commodity-to-open-source-threat/" target="_blank" rel="noopener noreferrer">write-up</a> on Kryptina Ransomware-as-a-Service, a free and open-source RaaS platform written for Linux. At the time, Kryptina provided all the components required to host a fully functional RaaS platform. This included the ability to automate payloads, manage multiple groups and campaigns nested within, as well as configure the ransom payment requirements such as the amount and type of payment. Despite such functionality, the offering struggled to attract much interest from dark market customers.</p>
<p>In May 2024, an affiliate of the Mallox RaaS exposed one of their staging servers. As a result of this leak, we identified Kryptina RaaS to be the platform on which the affiliate’s Linux variants were based. The affiliate threat actor referred to this Linux variant as “Mallox v1.0”. This ‘evolution’ of Kryptina is notable in a rags-to-riches sort of way. In the span of a few months, the tool went from an unsellable give-away in public forums to being observed in active SMB/Enterprise attacks.</p>
<p>In this research, we explore the data exposed in the open directory leak, detailing differences between the original Kryptina RaaS (v2.2) and the modified version branded under the Mallox moniker.</p>
<h2>Brief History of Kryptina &amp; Mallox</h2>
<p><a href="https://www.sentinelone.com/anthology/mallox/" target="_blank" rel="noopener noreferrer">Mallox</a> (<i>aka</i> <a href="https://www.sentinelone.com/blog/mallox-resurrected-ransomware-attacks-exploiting-ms-sql-continue-to-burden-enterprises/" target="_blank" rel="noopener noreferrer">TargetCompany</a>) ransomware is a longstanding, Enterprise-focused, RaaS. The family emerged in 2021 and is sometimes referred to as FARGO, XOLLAM, or BOZON, due to the extension appended to encrypted files in some variants. Mallox operators are known to opportunistically target ‘timely’ vulnerabilities (e.g., <a href="https://www.sentinelone.com/blog/mallox-resurrected-ransomware-attacks-exploiting-ms-sql-continue-to-burden-enterprises/" target="_blank" rel="noopener noreferrer">MSSQL Server</a>). Individual affiliate behavior will vary, though this style of exploitation, along with brute force attacks to establish initial access, is common across Mallox campaigns.</p>
<p>Kryptina was first offered for sale by the “Corlys” identity in December 2023. The price for the full suite, at the time, was $500.00, and later raised to $800.00. In February 2024, “Corlys” put a halt to the active sales of Kryptina, and subsequently posted the full source code to <a href="https://www.sentinelone.com/blog/the-good-the-bad-and-the-ugly-in-cybersecurity-week-20-5/" target="_blank" rel="noopener noreferrer">BreachForums</a>.</p>
<p>In May, 2024, an open directory which contained staged payloads along with Mallox builder tools and source was <a href="https://x.com/banthisguy9349/status/1796431710470721600" target="_blank" rel="noopener noreferrer">discovered</a>. This staging server was erected by a Mallox affiliate and hosts a number of attacker-related tools. </p>
<figure id="attachment_105867" aria-describedby="caption-attachment-105867" style="width: 535px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_5.jpg" alt="First discovery of opendir on Mallox affiliate server" width="535" height="434" class="size-full wp-image-105867" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_5.jpg 535w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_5-300x243.jpg 300w" sizes="(max-width: 535px) 100vw, 535px" /><figcaption id="caption-attachment-105867" class="wp-caption-text">First discovery of an open directory on Mallox affiliate server</figcaption></figure>
<p>The staging server, hosted on <code>185[.]73.125[.]6</code>, contained numerous archives and payloads specific to the Windows version of Mallox. </p>
<figure id="attachment_105882" aria-describedby="caption-attachment-105882" style="width: 1090px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_18.jpg" alt="Mallox staging server with web application and source" width="1090" height="942" class="size-full wp-image-105882" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_18.jpg 1090w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_18-300x259.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_18-1024x885.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_18-768x664.jpg 768w" sizes="(max-width: 1090px) 100vw, 1090px" /><figcaption id="caption-attachment-105882" class="wp-caption-text">Mallox staging server with web application and source</figcaption></figure>
<p>However, the affiliate’s server also contained all the (modified) source files for Kryptina, including the accessible web server and interface for building Mallox Linux (Kryptina) payloads, and managing separate infection campaigns. </p>
<figure id="attachment_105881" aria-describedby="caption-attachment-105881" style="width: 974px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_19.jpg" alt="Kryptina source files in Mallox leak" width="974" height="524" class="size-full wp-image-105881" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_19.jpg 974w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_19-300x161.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_19-768x413.jpg 768w" sizes="(max-width: 974px) 100vw, 974px" /><figcaption id="caption-attachment-105881" class="wp-caption-text">Kryptina source files in Mallox leak</figcaption></figure>
<figure id="attachment_105877" aria-describedby="caption-attachment-105877" style="width: 1464px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_22.jpg" alt="Kryptina database in Mallox leak" width="1464" height="676" class="size-full wp-image-105877" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_22.jpg 1464w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_22-300x139.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_22-1024x473.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_22-768x355.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_22-818x378.jpg 818w" sizes="(max-width: 1464px) 100vw, 1464px" /><figcaption id="caption-attachment-105877" class="wp-caption-text">Kryptina database in Mallox leak</figcaption></figure>
<p>The use of Kryptina by this affiliate appears to be singular: <a href="https://www.trendmicro.com/en_us/research/24/f/targetcompany-s-linux-variant-targets-esxi-environments.html" target="_blank" rel="noopener noreferrer">other</a> Linux variants of Mallox are not based on Kryptina, further complicating the the relationship between Kryptina and Mallox.</p>
<h2>Customizing Kryptina</h2>
<p>Encryption and decryption routines in “Mallox Linux 1.0” are identical to original Kryptina. To recap from our <a href="https://www.sentinelone.com/blog/kryptina-raas-from-underground-commodity-to-open-source-threat/" target="_blank" rel="noopener noreferrer">previous write-up</a>:</p>
<div class="inverted-block" style="font-size:80%;">&#8220;Individual file encryption is achieved through use of AES256 in CBC mode. The keys and configuration data are obfuscated via XOR and then base64 encoded (the XOR key depends on the value set in the builder or scripts). The function <code>krptna_process_file()</code> function is responsible for the file encryption. This function is a typical implementation of file encryption/decryption using the AES-256-CBC algorithm in OpenSSL.</p>
<p>This function initializes an OpenSSL cipher context <code>EVP_CIPHER_CTX_new()</code>. This is passed to the appropriate function, depending on what mode was chosen in the builder configuration (demo mode, etc). File input and output streams are processed via <code>EVP_CipherUpdate()</code>, which transforms unencrypted file data to the encrypted data in the output buffer. This is then written to the final output file (as the modified/encrypted file). <code>EVP_CipherFinal</code> finalizes the processes handling any padding (integral to CBC mode).</p>
<p>All the legacy Kryptina code is included in the <code>/src</code> folder of the affiliates server, with the files themselves even retaining the Kryptina naming conventions and references to known functions (e.g., <code>krptna_process_file()</code>).&#8221;</div>
<figure id="attachment_105864" aria-describedby="caption-attachment-105864" style="width: 658px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_8.jpg" alt="Kryptina-specific functions in Mallox Linux 1.0" width="658" height="335" class="size-full wp-image-105864" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_8.jpg 658w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_8-300x153.jpg 300w" sizes="(max-width: 658px) 100vw, 658px" /><figcaption id="caption-attachment-105864" class="wp-caption-text">Kryptina-specific functions in Mallox Linux 1.0</figcaption></figure>
<p>With the exception of the aforementioned Kryptina database, the Kryptina branding has been stripped from most of the source and support files for “Mallox Linux 1.0”.</p>
<figure id="attachment_105874" aria-describedby="caption-attachment-105874" style="width: 759px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_25.jpg" alt="Mallox Linux 1.0 “Documentation”" width="759" height="154" class="size-full wp-image-105874" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_25.jpg 759w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_25-300x61.jpg 300w" sizes="(max-width: 759px) 100vw, 759px" /><figcaption id="caption-attachment-105874" class="wp-caption-text">Mallox Linux 1.0 documentation</figcaption></figure>
<p>Documentation for the Kryptina-derived Mallox variations is included, though it is a distilled version of the original Kryptina documentation. The original Kryptia PDF (SHA1: <code>d46fbc4a57dce813574ee312001eaad0aa4e52de</code>) has been slimmed down and included as <code>docs.md</code>. Included sections have been translated to Russian from the original English version.</p>
<figure id="attachment_105875" aria-describedby="caption-attachment-105875" style="width: 852px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_24.jpg" alt="Original Kryptina RaaS documentation" width="852" height="517" class="size-full wp-image-105875" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_24.jpg 852w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_24-300x182.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_24-768x466.jpg 768w" sizes="(max-width: 852px) 100vw, 852px" /><figcaption id="caption-attachment-105875" class="wp-caption-text">Original Kryptina RaaS documentation</figcaption></figure>
<figure id="attachment_105868" aria-describedby="caption-attachment-105868" style="width: 865px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_4.jpg" alt="Modified Mallox Linux 1.0 documentation" width="865" height="361" class="size-full wp-image-105868" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_4.jpg 865w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_4-300x125.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_4-768x321.jpg 768w" sizes="(max-width: 865px) 100vw, 865px" /><figcaption id="caption-attachment-105868" class="wp-caption-text">Modified Mallox Linux 1.0 documentation</figcaption></figure>
<p>The updated Mallox Linux 1.0 documentation contains sections covering basic features, environmental setup (dependencies and version affinities), along with setup and configuration of phpMyAdmin and the backend DB (MySQL).</p>
<figure id="attachment_105869" aria-describedby="caption-attachment-105869" style="width: 819px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_3.jpg" alt="Mallox Linux 1.0 Dependencies" width="819" height="485" class="size-full wp-image-105869" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_3.jpg 819w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_3-300x178.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_3-768x455.jpg 768w" sizes="(max-width: 819px) 100vw, 819px" /><figcaption id="caption-attachment-105869" class="wp-caption-text">Mallox Linux 1.0 dependencies</figcaption></figure>
<figure id="attachment_105892" aria-describedby="caption-attachment-105892" style="width: 825px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_21b.jpg" alt="Mallox Linux 1.0 DB (MySQL) configuration" width="825" height="361" class="size-full wp-image-105892" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_21b.jpg 825w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_21b-300x131.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_21b-768x336.jpg 768w" sizes="(max-width: 825px) 100vw, 825px" /><figcaption id="caption-attachment-105892" class="wp-caption-text">Mallox Linux 1.0 DB (MySQL) configuration</figcaption></figure>
<p>The affiliate made a few changes to the Kryptina source files and scripts in order to remove references to Kryptina and associate the comments and naming conventions to those of Mallox.</p>
<p>Ransom note templates are structured similarly to the original <a href="https://www.sentinelone.com/blog/kryptina-raas-from-underground-commodity-to-open-source-threat/" target="_blank" rel="noopener noreferrer">Kryptina</a> version. The <code>\note</code> folder on the affiliate server contains the template source, which can be customized directly or via the Kryptina web UI. The template for the ransom note was updated to remove the Kryptina 2.x references, replacing them with Mallox v1.0.</p>
<figure id="attachment_105865" aria-describedby="caption-attachment-105865" style="width: 1360px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_7.jpg" alt="Kryptina original ransom note template" width="1360" height="1030" class="size-full wp-image-105865" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_7.jpg 1360w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_7-300x227.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_7-1024x776.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_7-768x582.jpg 768w" sizes="(max-width: 1360px) 100vw, 1360px" /><figcaption id="caption-attachment-105865" class="wp-caption-text">Kryptina original ransom note template</figcaption></figure>
<figure id="attachment_105863" aria-describedby="caption-attachment-105863" style="width: 1370px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_9.jpg" alt="Mallox 1.0 ransom note template" width="1370" height="1022" class="size-full wp-image-105863" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_9.jpg 1370w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_9-300x224.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_9-1024x764.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_9-768x573.jpg 768w" sizes="(max-width: 1370px) 100vw, 1370px" /><figcaption id="caption-attachment-105863" class="wp-caption-text">Mallox 1.0 ransom note template</figcaption></figure>
<p>The main source files for “Mallox 1.0” were held in the <code>/src</code> folder of the affiliate server. The original names of the encryptor and decryptor source files (<code>kryptina.c</code> and <code>kryptina.h</code>) retain the Kryptina-centric names. The only operational change to the Kryptina encryptor code is the updating of printed output in Debug mode (updated to Mallox). Aside from changing comments in the file to reference Mallox, and removing references to the Kryptina author (“Corlys”), the source is unchanged.</p>
<figure id="attachment_105873" aria-describedby="caption-attachment-105873" style="width: 859px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_26.jpg" alt="Mallox 1.0 src, with KRPTNA_DEBUG printf Mallox" width="859" height="349" class="size-full wp-image-105873" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_26.jpg 859w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_26-300x122.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_26-768x312.jpg 768w" sizes="(max-width: 859px) 100vw, 859px" /><figcaption id="caption-attachment-105873" class="wp-caption-text">Mallox 1.0 src, with <em>KRPTNA_DEBUG printf -&gt;Mallox</em></figcaption></figure>
<figure id="attachment_105871" aria-describedby="caption-attachment-105871" style="width: 1108px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_28.jpg" alt="Original Kryptina 2.2 kryptina.c source file" width="1108" height="766" class="size-full wp-image-105871" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_28.jpg 1108w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_28-300x207.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_28-1024x708.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_28-768x531.jpg 768w" sizes="(max-width: 1108px) 100vw, 1108px" /><figcaption id="caption-attachment-105871" class="wp-caption-text">Original Kryptina 2.2 <em>kryptina.c</em> source file</figcaption></figure>
<figure id="attachment_105876" aria-describedby="caption-attachment-105876" style="width: 1166px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_23.jpg" alt="Mallox 1.0 kryptina.c source file" width="1166" height="860" class="size-full wp-image-105876" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_23.jpg 1166w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_23-300x221.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_23-1024x755.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_23-768x566.jpg 768w" sizes="(max-width: 1166px) 100vw, 1166px" /><figcaption id="caption-attachment-105876" class="wp-caption-text">Mallox 1.0 <em>kryptina.c</em> source file</figcaption></figure>
<p>Kryptina’s original <code>scripting_demo.py</code> file provided threat actors with a way to build Linux payloads via the command line. All the requisite fields are provided in the template. This allows for quick and automated builds. While these scripted builds are not reflected in the web UI, it can be a valuable tool to a threat actor wanting to streamline the automation of new builds over time. The <code>scripting_demo.py</code> file has been minimally updated, again to reflect Mallox branding over Kryptina. References to “Corlys” have been removed as well.</p>
<figure id="attachment_105889" aria-describedby="caption-attachment-105889" style="width: 1244px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_11.jpg" alt="Original Kryptina scripting_demo.py source file" width="1244" height="642" class="size-full wp-image-105889" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_11.jpg 1244w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_11-300x155.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_11-1024x528.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_11-768x396.jpg 768w" sizes="(max-width: 1244px) 100vw, 1244px" /><figcaption id="caption-attachment-105889" class="wp-caption-text">Original Kryptina <em>scripting_demo.py</em> source file</figcaption></figure>
<figure id="attachment_105880" aria-describedby="caption-attachment-105880" style="width: 1232px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_2.jpg" alt="Mallox 1.0 scripting_demo.py source file" width="1232" height="542" class="size-full wp-image-105880" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_2.jpg 1232w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_2-300x132.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_2-1024x450.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_2-768x338.jpg 768w" sizes="(max-width: 1232px) 100vw, 1232px" /><figcaption id="caption-attachment-105880" class="wp-caption-text">Mallox 1.0 <em>scripting_demo.py</em> source file</figcaption></figure>
<h2>Comparing Kryptina and Mallox makefiles</h2>
<p>The makefile is used when building encryptor and decryptor payloads. This can be called directly via script, or via the web UI while building payloads within campaigns.</p>
<p>Kryptina (and subsequently Mallox 1.0) supports multiple modes within the compiled payloads. These are:</p>
<ul>
<li aria-level="1">demo &#8211; builds a demo version of Kryptina, no encryption</li>
<li aria-level="1">debug &#8211; provides customized debug output</li>
<li aria-level="1">symbols &#8211; provides debug build with debug symbols (-ggdb3)</li>
<li aria-level="1">arch32 &#8211; output 32-bit payload</li>
</ul>
<p>Additional parameter values are provided for other conditions present in the builder. This includes the ability to customize the XOR key use for encoding the encrypted configuration data within payloads (<code>xor</code>), thread count to use during the encryption process (<code>jobs</code>), toggling of the self deletion feature (<code>persist</code>), and filesize constraints (<code>maxsize</code>) to enforce during encryption (e.g., maximum size of file to attempt to decrypt). Secure deletion (wiper’esque capability) can be toggled via the <code>secdel</code> parameter. </p>
<p>Example makefiles from the original Kryptina package and the Mallox-modified package appear as follows:</p>
<figure id="attachment_105870" aria-describedby="caption-attachment-105870" style="width: 652px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_29.jpg" alt="Kryptina Mallox makefile" width="652" height="490" class="size-full wp-image-105870" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_29.jpg 652w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_29-300x225.jpg 300w" sizes="(max-width: 652px) 100vw, 652px" /><figcaption id="caption-attachment-105870" class="wp-caption-text">Kryptina makefile</figcaption></figure>
<figure id="attachment_105888" aria-describedby="caption-attachment-105888" style="width: 643px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_12.jpg" alt="Mallox Linux 1.0 makefile" width="643" height="456" class="size-full wp-image-105888" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_12.jpg 643w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_12-300x213.jpg 300w" sizes="(max-width: 643px) 100vw, 643px" /><figcaption id="caption-attachment-105888" class="wp-caption-text">Mallox Linux 1.0 makefile</figcaption></figure>
<h2>Victim Subfolders</h2>
<p>The May 2024 affiliate leak also contained target-specific output folders for 14 targets (potential victims). Some of this information was previously detailed <a href="https://www.uptycs.com/blog/threat-research-report-team/mallox-ransomware-linux-variant-decryptor-discovered" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>In the <code>\output</code> folder, subfolders exist for each target (unique ‘Target Name’ value).</p>
<figure id="attachment_105891" aria-describedby="caption-attachment-105891" style="width: 1367px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_1.jpg" alt="Output folder on affiliate staging server" width="1367" height="812" class="size-full wp-image-105891" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_1.jpg 1367w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_1-300x178.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_1-1024x608.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_1-768x456.jpg 768w" sizes="(max-width: 1367px) 100vw, 1367px" /><figcaption id="caption-attachment-105891" class="wp-caption-text">Output folder on affiliate staging server</figcaption></figure>
<p>Some of these folders contain <code>config.json</code> files (builder configuration) alongside the matching encryptor/decryptor binary pairs. There are empty folders as well, meaning those targets were defined, but payloads have yet to be built.</p>
<figure id="attachment_105890" aria-describedby="caption-attachment-105890" style="width: 748px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_10.jpg" alt="Affiliate output directory with payloads and configs" width="748" height="914" class="size-full wp-image-105890" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_10.jpg 748w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_10-246x300.jpg 246w" sizes="(max-width: 748px) 100vw, 748px" /><figcaption id="caption-attachment-105890" class="wp-caption-text">Affiliate output directory with payloads and configs</figcaption></figure>
<p>Each of the config files contains values for all the fields required in the builder scripts. This includes payment type and addresses. The configuration JSON contains values for the following:</p>
<div style="overflow-x:auto;">
<table style="border-collapse: collapse; width: 100%; height: 120px; font-size:80%">
<tbody>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">about</td>
<td style="width: 20.0%; height: 24px;">amount</td>
<td style="width: 20.0%; height: 24px;">arch32</td>
<td style="width: 20.0%; height: 24px;">bitcoin</td>
<td style="width: 20.0%; height: 24px;">deadline</td>
</tr>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">debug</td>
<td style="width: 20.0%; height: 24px;">demo</td>
<td style="width: 20.0%; height: 24px;">extension</td>
<td style="width: 20.0%; height: 24px;">ignore</td>
<td style="width: 20.0%; height: 24px;">iv</td>
</tr>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">jobs</td>
<td style="width: 20.0%; height: 24px;">key</td>
<td style="width: 20.0%; height: 24px;">maxsize</td>
<td style="width: 20.0%; height: 24px;">monero</td>
<td style="width: 20.0%; height: 24px;">name</td>
</tr>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">nolog</td>
<td style="width: 20.0%; height: 24px;">nonote</td>
<td style="width: 20.0%; height: 24px;">note</td>
<td style="width: 20.0%; height: 24px;">note_name</td>
<td style="width: 20.0%; height: 24px;">persist</td>
</tr>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">recommend</td>
<td style="width: 20.0%; height: 24px;">secdel</td>
<td style="width: 20.0%; height: 24px;">session</td>
<td style="width: 20.0%; height: 24px;">static</td>
<td style="width: 20.0%; height: 24px;">symbols</td>
</tr>
<tr style="height: 24px;">
<td style="width: 20.0%; height: 24px;">target_id</td>
<td style="width: 20.0%; height: 24px;">targets</td>
<td style="width: 20.0%; height: 24px;">tox</td>
<td style="width: 20.0%; height: 24px;">verbose</td>
<td style="width: 20.0%; height: 24px;">xor_key</td>
</tr>
</tbody>
</table>
</div>
<figure id="attachment_105883" aria-describedby="caption-attachment-105883" style="width: 1788px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_17.jpg" alt="Example config.json" width="1788" height="844" class="size-full wp-image-105883" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_17.jpg 1788w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_17-300x142.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_17-1024x483.jpg 1024w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_17-768x363.jpg 768w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_17-1536x725.jpg 1536w" sizes="(max-width: 1788px) 100vw, 1788px" /><figcaption id="caption-attachment-105883" class="wp-caption-text">Example <em>config.json</em></figcaption></figure>
<p>Seven of the victim subfolders contained corresponding <code>config.json</code> files and compiled encryptor &amp; decryptor tools. All of the JSON files have similar values assigned for the requisite field. All of the targets were configured with the same payment address (BTC <code>18CUq89XR81Y7Ju2UBjER14fYWTfVwpGP3</code>). Other requisite values are repeated across campaigns as well. This includes the values for “key”, “bitcoin” and “extension”. The extension on all fully-configured builds (potentially separate attack campaigns) is <code>.lmallox</code>.</p>
<div style="overflow-x:auto;">
<table style="border-collapse: collapse; width: 100%; height: 120px; font-size:60%">
<tbody>
<tr style="height: 24px;">
<td style="width: 25.0%; height: 24px;"><strong>SHA1 Hash</strong></td>
<td style="width: 25.0%; height: 24px;"><strong>Bitcoin</strong></td>
<td style="width: 15.0%; height: 24px;"><strong>Extension</strong></td>
<td style="width: 25.0%; height: 24px;"><strong>Key</strong></td>
<td style="width: 10.0%; height: 24px;"><strong>Amount</strong></td>
</tr>
<tr style="height: 24px;">
<td style="width: 25.0%; height: 24px;">fbb89744bc9f65719bd5415dcf1ec9a74b24254e</td>
<td style="width: 25.0%; height: 24px;">18CUq89XR81Y7Ju2UBjER14fYWTfVwpGP3</td>
<td style="width: 15.0%; height: 24px;">.lmallox</td>
<td style="width: 25.0%; height: 24px;">smHKnqN7S1ehBz4zxya6ddwys39PJHbF7LlqIS1+Fq4=</td>
<td style="width: 10.0%; height: 24px;">500.0</td>
</tr>
<tr style="height: 24px;">
<td style="width: 25.0%; height: 24px;">55dc4541b72a804a7edf324d6a388569a68a2986</td>
<td style="width: 25.0%; height: 24px;">18CUq89XR81Y7Ju2UBjER14fYWTfVwpGP3</td>
<td style="width: 15.0%; height: 24px;">.lmallox</td>
<td style="width: 25.0%; height: 24px;">smHKnqN7S1ehBz4zxya6ddwys39PJHbF7LlqIS1+Fq4=</td>
<td style="width: 10.0%; height: 24px;">500.0</td>
</tr>
<tr style="height: 24px;">
<td style="width: 25.0%; height: 24px;">78c27c7ac1da97dc822b4af7be5f15d68f9c5e4f</td>
<td style="width: 25.0%; height: 24px;">18CUq89XR81Y7Ju2UBjER14fYWTfVwpGP3</td>
<td style="width: 15.0%; height: 24px;">.lmallox</td>
<td style="width: 25.0%; height: 24px;">smHKnqN7S1ehBz4zxya6ddwys39PJHbF7LlqIS1+Fq4=</td>
<td style="width: 10.0%; height: 24px;">500.0</td>
</tr>
<tr style="height: 24px;">
<td style="width: 25.0%; height: 24px;">d94f890a8c92cbce50d89da2792bcfc24894c004</td>
<td style="width: 25.0%; height: 24px;">18CUq89XR81Y7Ju2UBjER14fYWTfVwpGP3</td>
<td style="width: 15.0%; height: 24px;">.lmallox</td>
<td style="width: 25.0%; height: 24px;">smHKnqN7S1ehBz4zxya6ddwys39PJHbF7LlqIS1+Fq4=</td>
<td style="width: 10.0%; height: 24px;">500.0</td>
</tr>
<tr style="height: 24px;">
<td style="width: 25.0%; height: 24px;">16ec82ac2caf0c2e4812a636dbff4bd8ef84d5c3</td>
<td style="width: 25.0%; height: 24px;">18CUq89XR81Y7Ju2UBjER14fYWTfVwpGP3</td>
<td style="width: 15.0%; height: 24px;">.lmallox</td>
<td style="width: 25.0%; height: 24px;">smHKnqN7S1ehBz4zxya6ddwys39PJHbF7LlqIS1+Fq4=</td>
<td style="width: 10.0%; height: 24px;">500.0</td>
</tr>
<tr style="height: 24px;">
<td style="width: 25.0%; height: 24px;">66cab82b64fbb03fecf7ca7f9ed295404a9bfe2b</td>
<td style="width: 25.0%; height: 24px;">18CUq89XR81Y7Ju2UBjER14fYWTfVwpGP3</td>
<td style="width: 15.0%; height: 24px;">.lmallox</td>
<td style="width: 25.0%; height: 24px;">smHKnqN7S1ehBz4zxya6ddwys39PJHbF7LlqIS1+Fq4=</td>
<td style="width: 10.0%; height: 24px;">500.0</td>
</tr>
<tr style="height: 24px;">
<td style="width: 25.0%; height: 24px;">0bbd9a8ddbb68e2658ea4c0a4106c7406a392098</td>
<td style="width: 25.0%; height: 24px;">18CUq89XR81Y7Ju2UBjER14fYWTfVwpGP3</td>
<td style="width: 15.0%; height: 24px;">.lmallox</td>
<td style="width: 25.0%; height: 24px;">smHKnqN7S1ehBz4zxya6ddwys39PJHbF7LlqIS1+Fq4=</td>
<td style="width: 10.0%; height: 24px;">500.0</td>
</tr>
</tbody>
</table>
</div>
<p>The configuration files also contain the full text template for the ransom notes, with associated Client IDs, and additional communication channels. </p>
<pre>
Tox ID: 290E6890D02FBDCD92659056F9A95D80854534A4D76EE5D3A64AFD55E584EA398722EC2D3697)
</pre>
<h2>What Else Was Leaked?</h2>
<p>The tools identified on the affiliate server were not limited to Linux victims. A small cache of tools and exploits which target the Windows platform were also hosted. These are utilized by the threat actor in the early stages of attack, primarily for beachhead establishment and privilege escalation.</p>
<figure id="attachment_105887" aria-describedby="caption-attachment-105887" style="width: 598px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_13.jpg" alt="Windows-focused droppers and tools on affiliate leak site" width="598" height="612" class="size-full wp-image-105887" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_13.jpg 598w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_13-293x300.jpg 293w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_13-50x50.jpg 50w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_13-24x24.jpg 24w" sizes="(max-width: 598px) 100vw, 598px" /><figcaption id="caption-attachment-105887" class="wp-caption-text">Windows-focused droppers and tools on affiliate leak site</figcaption></figure>
<p><code>KLAPR.ZIP</code> extracts to <code>KLAPR.BAT</code> (SHA1:<code>43377911601247920dc15e9b22eda4c57cb9e743</code>). This tool is provided by the affiliate to assist in the neutralization of Kaspersky endpoint products where needed. This binary is a copy of the “Kaspersky Lab AllProducts Password Reset v2.0” tool. This is a legitimate support <a href="https://support.kaspersky.com/common/settings/14674" target="_blank" rel="noopener noreferrer">tool</a> from Kaspersky Labs. Specific security products from Kaspersky require an application-specific password to allow for changing of configuration settings (locally) or other management tasks. This <code>.BAT</code> file resets (nullifies) the stored password values for a multitude of Kaspersky products.</p>
<p>Exploit code for <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-21338" target="_blank" rel="noopener noreferrer">CVE-2024-21338</a> is included as well. CVE-2024-21338 is a local privilege escalation flaw in Windows 10 and 11 where HVCI (Hypervisor-Protected Code Integrity) is enabled. This exploit is based on the proof-of-concept code provided in a <a href="https://hakaisecurity.io/cve-2024-21338-from-admin-to-kernel-through-token-manipulation-and-windows-kernel-exploitation/research-blog/" target="_blank" rel="noopener noreferrer">writeup</a> from Hakai Security. The same code is also hosted on the <a href="https://github.com/hakaioffsec/CVE-2024-21338" target="_blank" rel="noopener noreferrer">hakaioffsec GitHub repository</a>.</p>
<figure id="attachment_105885" aria-describedby="caption-attachment-105885" style="width: 524px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_15.jpg" alt="CVE-2024-21338 Exploit Readme" width="524" height="231" class="size-full wp-image-105885" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_15.jpg 524w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_15-300x132.jpg 300w" sizes="(max-width: 524px) 100vw, 524px" /><figcaption id="caption-attachment-105885" class="wp-caption-text">CVE-2024-21338 Exploit Readme</figcaption></figure>
<p>CVE-2024-21338 has been <a href="https://www.cisa.gov/news-events/alerts/2024/03/04/cisa-adds-one-known-exploited-vulnerability-catalog" target="_blank" rel="noopener noreferrer">associated</a> with other Mallox campaigns, as well <a href="https://www.cisa.gov/news-events/alerts/2024/03/04/cisa-adds-one-known-exploited-vulnerability-catalog" target="_blank" rel="noopener noreferrer">as</a> <a href="https://www.sentinelone.com/labs/comrades-in-arms-north-korea-compromises-sanctioned-russian-missile-engineering-company/" target="_blank" rel="noopener noreferrer">Lazarus</a>.</p>
<p>Multiple droppers for Mallox (Windows) are included, including a commented <code>s.ps1</code> PowerShell script. This script, hosted at the root of the open directory, provides a template for PowerShell privilege escalation and payload execution. Some basic environmental discovery commands are included (e.g., <code>Get-WmiObject -Namespace "root\SecurityCenter2" -Class AntiVirusProduct</code>).</p>
<figure id="attachment_105884" aria-describedby="caption-attachment-105884" style="width: 917px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_16.jpg" alt="s.ps1 script from Mallox affiliate leak" width="917" height="582" class="size-full wp-image-105884" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_16.jpg 917w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_16-300x190.jpg 300w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_16-768x487.jpg 768w" sizes="(max-width: 917px) 100vw, 917px" /><figcaption id="caption-attachment-105884" class="wp-caption-text"><em>s.ps1</em> script from Mallox affiliate leak</figcaption></figure>
<p>A Mallox (Windows) dropper named <code>Application.jar</code> (SHA1: <code>5cf67c0a1fa06101232437bee5111fefcd8e2df4</code>) was also present. This dropper launches a PowerShell script that downloads a copy of Mallox from the same server (as <code>id.exe</code>; SHA1: <code>0f1aea2cf0c9f2de55d2b920618a5948c5e5e119</code>). The PowerShell commands are embedded within the nested <code>MyClass.class</code> as Java bytecode. <code>MyClass.class</code> contains reference to a temporary DNS resolution for the host at <code>grovik71.theweb[.]place</code>.</p>
<figure id="attachment_105886" aria-describedby="caption-attachment-105886" style="width: 676px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_14.jpg" alt="DNS name revealed (grovik71.theweb[.]place)" width="676" height="491" class="size-full wp-image-105886" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_14.jpg 676w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_14-300x218.jpg 300w" sizes="(max-width: 676px) 100vw, 676px" /><figcaption id="caption-attachment-105886" class="wp-caption-text">DNS name revealed (<em>grovik71.theweb[.]place</em>)</figcaption></figure>
<p>A copy of the Java JRE (8.0.4010.10) is hosted on the affiliate server. <code>Jre-8u401-windows-x64.exe</code> is a full offline installer of the JRE (SHA1: <code>dc3f98dded6c1f1e363db6752c512e01ac9433f3</code>).</p>
<p>Finally, multiple additional dropper/payload sets were hosted at the root of the site. These include packages split for 32 and 64 bit use, and a <code>.LNK</code>-based dropper for the payloads.</p>
<figure id="attachment_105903" aria-describedby="caption-attachment-105903" style="width: 463px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_6a.jpg" alt="Droppers separated by architecture" width="463" height="82" class="size-full wp-image-105903" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_6a.jpg 463w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_6a-300x53.jpg 300w" sizes="(max-width: 463px) 100vw, 463px" /><figcaption id="caption-attachment-105903" class="wp-caption-text">Droppers separated by architecture</figcaption></figure>
<p><code>Reader.img</code> and <code>Reader+x86.img</code> are compressed disk image files that contain Mallox (Windows) payloads for 64 and 32 bit systems, respectively. Each of these images contains the same <code>.LNK</code> launcher (SHA1: <code>c20e8d536804cf97584eec93d9a89c09541155bc</code>), which is named <code>Reader.lnk</code>.</p>
<figure id="attachment_105879" aria-describedby="caption-attachment-105879" style="width: 576px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" src="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_20.jpg" alt=".LNK Launcher for Mallox (Windows)" width="576" height="296" class="size-full wp-image-105879" srcset="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_20.jpg 576w, https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina_Mallox_20-300x154.jpg 300w" sizes="(max-width: 576px) 100vw, 576px" /><figcaption id="caption-attachment-105879" class="wp-caption-text"><em>.LNK</em> Launcher for Mallox (Windows)</figcaption></figure>
<p>The payload contained within these compressed images is named <code>red.exe</code>.</p>
<pre>
red.exe (x86) - SHA1: 29936b1aa952a89905bf0f7b7053515fd72d8c5c
red.exe (x64) - SHA1: 0f1aea2cf0c9f2de55d2b920618a5948c5e5e119
</pre>
<p>This instance of the 64-bit payload (SHA1: <code>0f1aea2cf0c9f2de55d2b920618a5948c5e5e119</code>) is identical to the prior referenced <code>id.exe</code> and the hosted <code>MSiedge.exe</code>.</p>
<h2>Conclusion</h2>
<p>The Kryptina-derived variants of Mallox are affiliate-specific and separate from <a href="https://www.trendmicro.com/en_us/research/24/f/targetcompany-s-linux-variant-targets-esxi-environments.html" target="_blank" rel="noopener noreferrer">other Linux variants of Mallox </a> that have since emerged, an indication of how the ransomware landscape has evolved into a complex menagerie of cross-pollinated toolsets and non-linear codebases. </p>
<p>The adoption of Kryptina – a RaaS given away as a free tool after the developer&#8217;s failure to cash-in on it – by an active Mallox affiliate represents a kind of &#8216;levelling-up&#8217; for the malware. More importantly, it demonstrates the broader trend of ransomware commoditization. </p>
<p>The leakage of powerful tools like the LockBit, Yashma, and Babuk builders along with Kryptina RaaS has obscured the lineage and proliferation of related malware families. Individual affiliates introducing different codebases into the mix further muddies the water, ultimately increasing the level of difficulty when tracking these tools and understanding the scope of their use and adoption. Looking forward, we expect to see more outlier platforms like Kryptina being absorbed into the TTPs leveraged by more advanced threat actors.</p>
<h2>IOCs</h2>
<p><b>Files SHA1</b><br />
0b9d2895d29f7d553e5613266c2319e10afdda78<br />
0de92527430dc0794694787678294509964422e6<br />
0e83d023b9f6c34ab029206f1f11b3457171a30a<br />
0f1aea2cf0c9f2de55d2b920618a5948c5e5e119<br />
0f632f8e59b8c8b99241d0fd5ff802f31a3650cd<br />
1379a1b08f938f9a53082150d53efadb2ad37ae5<br />
21bacf8daa45717e87a39842ec33ad61d9d79cfe<br />
262497702d6b7f7d4af73a90cb7d0e930f9ec355<br />
29936b1aa952a89905bf0f7b7053515fd72d8c5c<br />
2b3fc20c4521848f33edcf55ed3d508811c42861<br />
341552a8650d2bdad5f3ec12e333e3153172ee66<br />
43377911601247920dc15e9b22eda4c57cb9e743<br />
58552820ba2271e5c3a76b30bd3a07144232b9b3<br />
5cf67c0a1fa06101232437bee5111fefcd8e2df4<br />
88a039be03abc7305db724079e1a85810088f900<br />
9050419cbecc88be7a06ea823e270db16f47c1ea<br />
93ef3578f9c3db304a979b0d9d36234396ec6ac9<br />
a1a8922702ffa8c74aba9782cca90c939dfb15bf<br />
b07c725edb65a879d392cd961b4cb6a876e40e2d<br />
b27d291596cc890d283e0d3a3e08907c47e3d1cc<br />
b768ba3e6e03a77004539ae999bb2ae7b1f12c62<br />
c20e8d536804cf97584eec93d9a89c09541155bc<br />
c4d988135e960e88e7acfae79a45c20e100984b6<br />
d46fbc4a57dce813574ee312001eaad0aa4e52de<br />
d618a9655985c33e69a4713ebe39d473a4d58cde<br />
dc3f98dded6c1f1e363db6752c512e01ac9433f3<br />
ee3cd3a749f5146cf6d4b36ee87913c51b9bfe93<br />
ef2565c789316612d8103056cec25f77674d78d1<br />
f17d9b3cd2ba1dea125d2e1a4aeafc6d4d8f12dc</p>
<p><b>Network Comms</b><br />
185[.]73.125[.]6<br />
grovik71[.]theweb[.]place</p>
<p><b>Tox ID</b><br />
290E6890D02FBDCD92659056F9A95D80854534A4D76EE5D3A64AFD55E584EA398722EC2D3697</p>
<p><b>BTC Address</b><br />
18CUq89XR81Y7Ju2UBjER14fYWTfVwpGP3</p>
]]></content:encoded>
					
		
		
		<enclosure url="https://www.sentinelone.com/wp-content/uploads/2024/09/Kryptina-Desert-Ftr.jpg" length="802915" type="image/jpeg" />	</item>
		<item>
		<title>LABScon23 Replay &#124; They Spilled Oil in My Health-Boosting Smoothie</title>
		<link>https://www.sentinelone.com/labs/labscon23-replay-they-spilled-oil-in-my-health-boosting-smoothie/</link>
		
		<dc:creator><![CDATA[LABScon]]></dc:creator>
		<pubDate>Thu, 05 Sep 2024 15:25:14 +0000</pubDate>
				<category><![CDATA[LABScon23]]></category>
		<guid isPermaLink="false">https://www.sentinelone.com/?post_type=labs&#038;p=104518</guid>

					<description><![CDATA[Zuzana Hromcová explores how Iran-aligned APT OilRig targets healthcare and local governments with a stream of updated and newly developed tools.]]></description>
										<content:encoded><![CDATA[<p>OilRig is a well-known Iran-aligned cyberespionage group, allegedly under the MOIS (Ministry of Intelligence and Security), that has been targeting Middle Eastern governments and a variety of business verticals since at least 2014. In this presentation, Zuzana Hromcová discusses the group’s persistent attacks on Israeli healthcare and local governments, often with the same organizations targeted multiple times over the course of several years, suggesting that OilRig considers them to be of high espionage value.</p>
<p>Zuzana explores how an Israeli local government organization and a group of healthcare organizations recovered from the Out to Sea compromise in 2021 only to find themselves retargeted by several versions of OilRig’s SC5k downloader, followed by the new OilBooster and Mango backdoors throughout 2022.</p>
<p>In the process, she discloses the previously undocumented 2021 Outer Space and 2022 Juicy Mix campaigns, notable for their new C# backdoors, dubbed Solar and Mango, and a set of custom postcompromise tools used to collect credentials, cookies, and browsing history from major browsers and from the Windows Credential Manager. Although not sophisticated tools, they are tweaked frequently, and the talk inspects their added layers of obfuscation and detection evasion techniques.</p>
<p>This wide-ranging talk also discusses OilRig’s ongoing shift away from traditional C&#038;C infrastructure towards Microsoft APIs and looks at the mechanism behind OilRig&#8217;s use of the OneDrive API (OilBooster) and Microsoft Office 365 API (SC5k downloader) for its C&#038;C communications, and the difficulty this presents for tracking the threat actor.</p>
<p>Zuzana concludes with a breakdown of the group’s characteristic TTPs, noting how they remain unchanged despite the constant stream of updated and newly developed tools – including their frequent coding mistakes, noisy presence on compromised systems, and other characteristics that make it possible for researchers to keep a close eye on the group.</p>
<p><iframe loading="lazy" src="https://www.youtube.com/embed/r7YQleL6_A4" width="700" height="392" frameborder="0" allowfullscreen="allowfullscreen"></iframe></p>
<h2>About the Author</h2>
<p>Zuzana Hromcová is a malware researcher at ESET’s Montréal research team. Her professional journey has been shaped by both her studies – she holds a master’s degree in computer science – as well as her interest in solving logical puzzles and challenges. Three-times a Slovak sudoku champion, with numerous appearances at World Sudoku and World Puzzle Championships, she spent a decade sharpening her analytical skills for a job that was yet to come.</p>
<p>In 2016, she joined ESET and moved on from solving logical puzzles to dissecting malicious binaries and dismantling espionage campaigns. Zuzana focuses on targeted threats and is a frequent speaker at security conferences, having shared her research with the audience at RSAC, Black Hat, BlueHat IL, Virus Bulletin and other events.</p>
<h2>About LABScon</h2>
<p>This presentation was featured live at <a href="https://www.labscon.io" target="_blank" rel="noopener">LABScon</a> 2023, an immersive 3-day conference bringing together the world’s top cybersecurity minds, hosted by SentinelOne’s research arm, SentinelLabs.</p>
<p>Keep up with all the latest on <a href="https://www.labscon.io" target="_blank" rel="noopener">LABScon 2024</a> here.</p>
]]></content:encoded>
					
		
		
		<enclosure url="https://www.sentinelone.com/wp-content/uploads/2024/09/Zuzana_labscon23.jpg" length="679204" type="image/jpeg" />	</item>
	</channel>
</rss>
